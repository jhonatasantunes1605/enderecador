{"data":"InVzZSBjbGllbnQiCgppbXBvcnQgeyB1c2VBY3Rpb25TdGF0ZSB9IGZyb20gInJlYWN0IgppbXBvcnQgeyB1c2VGb3JtU3RhdHVzIH0gZnJvbSAicmVhY3QtZG9tIgppbXBvcnQgeyBhc3NpZ25Qcm9kdWN0VG9QYWxsZXQgfSBmcm9tICJAL2FwcC9hY3Rpb25zIgppbXBvcnQgeyBCdXR0b24gfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvYnV0dG9uIgppbXBvcnQgeyBJbnB1dCB9IGZyb20gIkAvY29tcG9uZW50cy91aS9pbnB1dCIKaW1wb3J0IHsgTGFiZWwgfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvbGFiZWwiCmltcG9ydCB7IHRvYXN0IH0gZnJvbSAiQC9ob29rcy91c2UtdG9hc3QiCmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZUNhbGxiYWNrIH0gZnJvbSAicmVhY3QiCmltcG9ydCB7IExvYWRlcjIsIEFsZXJ0VHJpYW5nbGUsIE1hcFBpbiB9IGZyb20gImx1Y2lkZS1yZWFjdCIKaW1wb3J0IHsgdXNlUm91dGVyLCB1c2VTZWFyY2hQYXJhbXMgfSBmcm9tICJuZXh0L25hdmlnYXRpb24iCmltcG9ydCB7IHVzZUFjdGlvbkZlZWRiYWNrIH0gZnJvbSAiQC9ob29rcy91c2UtYWN0aW9uLWZlZWRiYWNrIgoKZnVuY3Rpb24gdXNlRGVib3VuY2U8VCBleHRlbmRzICguLi5hcmdzOiBhbnlbXSkgPT4gYW55PihjYWxsYmFjazogVCwgZGVsYXk6IG51bWJlcikgewogIGNvbnN0IFtkZWJvdW5jZVRpbWVyLCBzZXREZWJvdW5jZVRpbWVyXSA9IHVzZVN0YXRlPE5vZGVKUy5UaW1lb3V0IHwgbnVsbD4obnVsbCkKCiAgY29uc3QgZGVib3VuY2VkQ2FsbGJhY2sgPSB1c2VDYWxsYmFjaygKICAgICguLi5hcmdzOiBQYXJhbWV0ZXJzPFQ+KSA9PiB7CiAgICAgIGlmIChkZWJvdW5jZVRpbWVyKSB7CiAgICAgICAgY2xlYXJUaW1lb3V0KGRlYm91bmNlVGltZXIpCiAgICAgIH0KCiAgICAgIGNvbnN0IG5ld1RpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgY2FsbGJhY2soLi4uYXJncykKICAgICAgfSwgZGVsYXkpCgogICAgICBzZXREZWJvdW5jZVRpbWVyKG5ld1RpbWVyKQogICAgfSwKICAgIFtjYWxsYmFjaywgZGVsYXksIGRlYm91bmNlVGltZXJdLAogICkKCiAgcmV0dXJuIGRlYm91bmNlZENhbGxiYWNrCn0KCmludGVyZmFjZSBBc3NpZ25Qcm9kdWN0Rm9ybVByb3BzIHsKICBwYWxsZXRJZDogc3RyaW5nCiAgY3VycmVudEVhbj86IHN0cmluZwogIGN1cnJlbnRQcm9kdWN0TmFtZT86IHN0cmluZwogIG9uU3VjY2Vzcz86ICgpID0+IHZvaWQKfQoKaW50ZXJmYWNlIER1cGxpY2F0ZUxvY2F0aW9uIHsKICBhZGRyZXNzOiBzdHJpbmcKICB3YXJlaG91c2VJZDogc3RyaW5nCiAgYWlzbGVJZDogc3RyaW5nCiAgcG9zaXRpb246IG51bWJlcgogIGxldmVsPzogbnVtYmVyCiAgcHJvZHVjdE5hbWU6IHN0cmluZwogIHN0b3JhZ2VUeXBlOiBzdHJpbmcKICBwYWxsZXRJZDogc3RyaW5nCiAgYWlzbGVOYW1lOiBzdHJpbmcKICB3YXJlaG91c2VOYW1lOiBzdHJpbmcKfQoKZnVuY3Rpb24gU3VibWl0QnV0dG9uKCkgewogIGNvbnN0IHsgcGVuZGluZyB9ID0gdXNlRm9ybVN0YXR1cygpCiAgcmV0dXJuICgKICAgIDxCdXR0b24gdHlwZT0ic3VibWl0IiBhcmlhLWRpc2FibGVkPXtwZW5kaW5nfSBjbGFzc05hbWU9InctZnVsbCI+CiAgICAgIHtwZW5kaW5nID8gIkF0cmlidWluZG8uLi4iIDogIkF0cmlidWlyIFByb2R1dG8ifQogICAgPC9CdXR0b24+CiAgKQp9CgpleHBvcnQgZnVuY3Rpb24gQXNzaWduUHJvZHVjdEZvcm0oewogIHBhbGxldElkLAogIGN1cnJlbnRFYW4gPSAiIiwKICBjdXJyZW50UHJvZHVjdE5hbWUgPSAiIiwKICBvblN1Y2Nlc3MsCn06IEFzc2lnblByb2R1Y3RGb3JtUHJvcHMpIHsKICBjb25zdCBbc3RhdGUsIGZvcm1BY3Rpb25dID0gdXNlQWN0aW9uU3RhdGUoYXNzaWduUHJvZHVjdFRvUGFsbGV0LmJpbmQobnVsbCwgcGFsbGV0SWQpLCB7IG1lc3NhZ2U6ICIiIH0pCgogIGNvbnN0IFtlYW4sIHNldEVhbl0gPSB1c2VTdGF0ZShjdXJyZW50RWFuKQogIGNvbnN0IFtwcm9kdWN0TmFtZSwgc2V0UHJvZHVjdE5hbWVdID0gdXNlU3RhdGUoY3VycmVudFByb2R1Y3ROYW1lKQogIGNvbnN0IFtkdXBsaWNhdGVMb2NhdGlvbiwgc2V0RHVwbGljYXRlTG9jYXRpb25dID0gdXNlU3RhdGU8RHVwbGljYXRlTG9jYXRpb24gfCBudWxsPihudWxsKQogIGNvbnN0IFtpc0NoZWNraW5nRHVwbGljYXRlLCBzZXRJc0NoZWNraW5nRHVwbGljYXRlXSA9IHVzZVN0YXRlKGZhbHNlKQogIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpCiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gdXNlU2VhcmNoUGFyYW1zKCkKICBjb25zdCB7IHN1Y2Nlc3MsIGVycm9yIH0gPSB1c2VBY3Rpb25GZWVkYmFjaygpCgogIGNvbnN0IGNoZWNrRm9yRHVwbGljYXRlRUFOID0gdXNlQ2FsbGJhY2soYXN5bmMgKGVhblZhbHVlOiBzdHJpbmcpID0+IHsKICAgIGlmICghZWFuVmFsdWUgfHwgZWFuVmFsdWUubGVuZ3RoIDwgNCkgewogICAgICBzZXREdXBsaWNhdGVMb2NhdGlvbihudWxsKQogICAgICByZXR1cm4KICAgIH0KCiAgICBzZXRJc0NoZWNraW5nRHVwbGljYXRlKHRydWUpCiAgICB0cnkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL3Byb2R1Y3RzL2NoZWNrLWR1cGxpY2F0ZT9lYW49JHtlbmNvZGVVUklDb21wb25lbnQoZWFuVmFsdWUpfWApCiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkKCiAgICAgIGlmIChkYXRhLnN1Y2Nlc3MgJiYgZGF0YS5sb2NhdGlvbikgewogICAgICAgIHNldER1cGxpY2F0ZUxvY2F0aW9uKGRhdGEubG9jYXRpb24pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0RHVwbGljYXRlTG9jYXRpb24obnVsbCkKICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcigiRXJybyBhbyB2ZXJpZmljYXIgRUFOIGR1cGxpY2FkbzoiLCBlcnJvcikKICAgICAgc2V0RHVwbGljYXRlTG9jYXRpb24obnVsbCkKICAgIH0gZmluYWxseSB7CiAgICAgIHNldElzQ2hlY2tpbmdEdXBsaWNhdGUoZmFsc2UpCiAgICB9CiAgfSwgW10pCgogIGNvbnN0IGRlYm91bmNlZENoZWNrRHVwbGljYXRlID0gdXNlRGVib3VuY2UoY2hlY2tGb3JEdXBsaWNhdGVFQU4sIDgwMCkKCiAgY29uc3QgaGFuZGxlRWFuQ2hhbmdlID0gKHZhbHVlOiBzdHJpbmcpID0+IHsKICAgIHNldEVhbih2YWx1ZSkKICAgIGlmICh2YWx1ZS5sZW5ndGggPj0gNCkgewogICAgICBkZWJvdW5jZWRDaGVja0R1cGxpY2F0ZSh2YWx1ZS50cmltKCkpCiAgICB9IGVsc2UgewogICAgICBzZXREdXBsaWNhdGVMb2NhdGlvbihudWxsKQogICAgfQogIH0KCiAgY29uc3QgaGFuZGxlRHVwbGljYXRlTG9jYXRpb25DbGljayA9ICgpID0+IHsKICAgIGlmIChkdXBsaWNhdGVMb2NhdGlvbikgewogICAgICBjb25zdCBjdXJyZW50U2VsZWN0ZWRBaXNsZSA9IHNlYXJjaFBhcmFtcy5nZXQoInNlbGVjdGVkQWlzbGUiKQogICAgICBjb25zdCB3YXJlaG91c2VVcmwgPSBgL3dhcmVob3VzZXMvJHtkdXBsaWNhdGVMb2NhdGlvbi53YXJlaG91c2VJZH0/aGlnaGxpZ2h0PSR7ZHVwbGljYXRlTG9jYXRpb24ucGFsbGV0SWR9JnR5cGU9JHtkdXBsaWNhdGVMb2NhdGlvbi5zdG9yYWdlVHlwZX0ke2N1cnJlbnRTZWxlY3RlZEFpc2xlID8gYCZzZWxlY3RlZEFpc2xlPSR7Y3VycmVudFNlbGVjdGVkQWlzbGV9YCA6ICIifWAKICAgICAgcm91dGVyLnB1c2god2FyZWhvdXNlVXJsKQoKICAgICAgdG9hc3QoewogICAgICAgIHRpdGxlOiAiTmF2ZWdhbmRvIHBhcmEgbG9jYWxpemHDp8OjbyIsCiAgICAgICAgZGVzY3JpcHRpb246IGBJbmRvIHBhcmEgJHtkdXBsaWNhdGVMb2NhdGlvbi5hZGRyZXNzfWAsCiAgICAgIH0pCiAgICB9CiAgfQoKICB1c2VFZmZlY3QoKCkgPT4gewogICAgaWYgKHN0YXRlLm1lc3NhZ2UpIHsKICAgICAgaWYgKHN0YXRlLm1lc3NhZ2UuaW5jbHVkZXMoInN1Y2Vzc28iKSkgewogICAgICAgIHN1Y2Nlc3Moc3RhdGUubWVzc2FnZSwgcGFsbGV0SWQsICJwYWxsZXQiKQogICAgICB9IGVsc2UgewogICAgICAgIGVycm9yKHN0YXRlLm1lc3NhZ2UpCiAgICAgIH0KICAgICAgaWYgKHN0YXRlLm1lc3NhZ2UuaW5jbHVkZXMoInN1Y2Vzc28iKSkgewogICAgICAgIGlmIChvblN1Y2Nlc3MpIHsKICAgICAgICAgIG9uU3VjY2VzcygpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHNlYXJjaFBhcmFtcy50b1N0cmluZygpKQogICAgICAgICAgY3VycmVudFBhcmFtcy5zZXQoImhpZ2hsaWdodCIsIHBhbGxldElkKQogICAgICAgICAgY3VycmVudFBhcmFtcy5zZXQoInR5cGUiLCAicGFsbGV0IikKICAgICAgICAgIGNvbnN0IG5ld1VybCA9IGAke3dpbmRvdy5sb2NhdGlvbi5wYXRobmFtZX0/JHtjdXJyZW50UGFyYW1zLnRvU3RyaW5nKCl9YAogICAgICAgICAgcm91dGVyLnJlcGxhY2UobmV3VXJsLCB7IHNjcm9sbDogZmFsc2UgfSkKICAgICAgICAgIHJvdXRlci5yZWZyZXNoKCkKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCBbc3RhdGUsIG9uU3VjY2Vzcywgcm91dGVyLCBzZWFyY2hQYXJhbXNdKQoKICByZXR1cm4gKAogICAgPGRpdiBjbGFzc05hbWU9InctZnVsbCI+CiAgICAgIDxmb3JtIGFjdGlvbj17Zm9ybUFjdGlvbn0gY2xhc3NOYW1lPSJncmlkIGdhcC00Ij4KICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZ3JpZCBnYXAtMiI+CiAgICAgICAgICA8TGFiZWwgaHRtbEZvcj0iZWFuIj5FQU48L0xhYmVsPgogICAgICAgICAgPGRpdiBjbGFzc05hbWU9InJlbGF0aXZlIj4KICAgICAgICAgICAgPElucHV0CiAgICAgICAgICAgICAgaWQ9ImVhbiIKICAgICAgICAgICAgICBuYW1lPSJlYW4iCiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9IkV4OiA3ODkxMjM0NTY3ODkwIgogICAgICAgICAgICAgIHZhbHVlPXtlYW59CiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVFYW5DaGFuZ2UoZS50YXJnZXQudmFsdWUpfQogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgICAgYXV0b0NvbXBsZXRlPSJvZmYiCiAgICAgICAgICAgIC8+CiAgICAgICAgICAgIHtpc0NoZWNraW5nRHVwbGljYXRlICYmICgKICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iYWJzb2x1dGUgcmlnaHQtMiB0b3AtMS8yIHRyYW5zZm9ybSAtdHJhbnNsYXRlLXktMS8yIj4KICAgICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT0iaC00IHctNCBhbmltYXRlLXNwaW4gdGV4dC1ibHVlLTUwMCIgLz4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgKX0KICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICB7ZHVwbGljYXRlTG9jYXRpb24gJiYgKAogICAgICAgICAgPGRpdgogICAgICAgICAgICBjbGFzc05hbWU9ImJnLWFtYmVyLTUwIGRhcms6YmctYW1iZXItOTAwLzIwIGJvcmRlciBib3JkZXItYW1iZXItMjAwIGRhcms6Ym9yZGVyLWFtYmVyLTcwMCByb3VuZGVkLWxnIHAtMyBjdXJzb3ItcG9pbnRlciBob3ZlcjpiZy1hbWJlci0xMDAgZGFyazpob3ZlcjpiZy1hbWJlci05MDAvMzAgdHJhbnNpdGlvbi1jb2xvcnMiCiAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZUR1cGxpY2F0ZUxvY2F0aW9uQ2xpY2t9CiAgICAgICAgICA+CiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0yIj4KICAgICAgICAgICAgICA8QWxlcnRUcmlhbmdsZSBjbGFzc05hbWU9ImgtNCB3LTQgdGV4dC1hbWJlci02MDAgZGFyazp0ZXh0LWFtYmVyLTQwMCBtdC0wLjUgZmxleC1zaHJpbmstMCIgLz4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0idGV4dC14cyB0ZXh0LWFtYmVyLTgwMCBkYXJrOnRleHQtYW1iZXItMjAwIGZsZXgtMSI+CiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9ImZvbnQtbWVkaXVtIG1iLTEgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEiPgogICAgICAgICAgICAgICAgICA8TWFwUGluIGNsYXNzTmFtZT0iaC0zIHctMyIgLz4KICAgICAgICAgICAgICAgICAgRUFOIGrDoSBwb3NzdWkgZW5kZXJlw6dhbWVudG8KICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ibWItMSI+CiAgICAgICAgICAgICAgICAgIDxzdHJvbmc+TG9jYWxpemHDp8Ojbzo8L3N0cm9uZz4ge1N0cmluZyhkdXBsaWNhdGVMb2NhdGlvbi5hZGRyZXNzIHx8ICIiKX0KICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ibWItMSI+CiAgICAgICAgICAgICAgICAgIDxzdHJvbmc+UHJvZHV0bzo8L3N0cm9uZz4ge1N0cmluZyhkdXBsaWNhdGVMb2NhdGlvbi5wcm9kdWN0TmFtZSB8fCAiIil9CiAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9Im1iLTEgdGV4dC1hbWJlci03MDAgZGFyazp0ZXh0LWFtYmVyLTMwMCI+CiAgICAgICAgICAgICAgICAgIDxzdHJvbmc+R2FscMOjbzo8L3N0cm9uZz4ge1N0cmluZyhkdXBsaWNhdGVMb2NhdGlvbi53YXJlaG91c2VOYW1lIHx8ICIiKX0KICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1hbWJlci03MDAgZGFyazp0ZXh0LWFtYmVyLTMwMCBmb250LW1lZGl1bSI+CiAgICAgICAgICAgICAgICAgIPCfkYYgQ2xpcXVlIGFxdWkgcGFyYSBpciBhdMOpIGEgbG9jYWxpemHDp8OjbyBkbyBwcm9kdXRvCiAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgKX0KCiAgICAgICAgPGRpdiBjbGFzc05hbWU9ImdyaWQgZ2FwLTIiPgogICAgICAgICAgPExhYmVsIGh0bWxGb3I9InByb2R1Y3ROYW1lIj5Ob21lIGRvIFByb2R1dG88L0xhYmVsPgogICAgICAgICAgPElucHV0CiAgICAgICAgICAgIGlkPSJwcm9kdWN0TmFtZSIKICAgICAgICAgICAgbmFtZT0icHJvZHVjdE5hbWUiCiAgICAgICAgICAgIHBsYWNlaG9sZGVyPSJFeDogQ2FpeGEgZGUgUGFyYWZ1c29zIgogICAgICAgICAgICB2YWx1ZT17cHJvZHVjdE5hbWV9CiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0UHJvZHVjdE5hbWUoZS50YXJnZXQudmFsdWUpfQogICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICBhdXRvQ29tcGxldGU9Im9mZiIKICAgICAgICAgIC8+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPFN1Ym1pdEJ1dHRvbiAvPgogICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICApCn0K"}