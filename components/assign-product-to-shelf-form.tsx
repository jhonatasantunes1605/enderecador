{"data":"InVzZSBjbGllbnQiCgppbXBvcnQgeyB1c2VBY3Rpb25TdGF0ZSB9IGZyb20gInJlYWN0IgppbXBvcnQgeyB1c2VGb3JtU3RhdHVzIH0gZnJvbSAicmVhY3QtZG9tIgppbXBvcnQgeyBhc3NpZ25Qcm9kdWN0VG9TaGVsZiB9IGZyb20gIkAvYXBwL2FjdGlvbnMiCmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gIkAvY29tcG9uZW50cy91aS9idXR0b24iCmltcG9ydCB7IElucHV0IH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL2lucHV0IgppbXBvcnQgeyBMYWJlbCB9IGZyb20gIkAvY29tcG9uZW50cy91aS9sYWJlbCIKaW1wb3J0IHsgdG9hc3QgfSBmcm9tICJAL2hvb2tzL3VzZS10b2FzdCIKaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2sgfSBmcm9tICJyZWFjdCIKaW1wb3J0IHsgTG9hZGVyMiwgQWxlcnRUcmlhbmdsZSwgTWFwUGluIH0gZnJvbSAibHVjaWRlLXJlYWN0IgppbXBvcnQgeyB1c2VSb3V0ZXIsIHVzZVNlYXJjaFBhcmFtcyB9IGZyb20gIm5leHQvbmF2aWdhdGlvbiIKaW1wb3J0IHsgdXNlQWN0aW9uRmVlZGJhY2sgfSBmcm9tICJAL2hvb2tzL3VzZS1hY3Rpb24tZmVlZGJhY2siCgpmdW5jdGlvbiB1c2VEZWJvdW5jZTxUIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnk+KGNhbGxiYWNrOiBULCBkZWxheTogbnVtYmVyKSB7CiAgY29uc3QgW2RlYm91bmNlVGltZXIsIHNldERlYm91bmNlVGltZXJdID0gdXNlU3RhdGU8Tm9kZUpTLlRpbWVvdXQgfCBudWxsPihudWxsKQoKICBjb25zdCBkZWJvdW5jZWRDYWxsYmFjayA9IHVzZUNhbGxiYWNrKAogICAgKC4uLmFyZ3M6IFBhcmFtZXRlcnM8VD4pID0+IHsKICAgICAgaWYgKGRlYm91bmNlVGltZXIpIHsKICAgICAgICBjbGVhclRpbWVvdXQoZGVib3VuY2VUaW1lcikKICAgICAgfQoKICAgICAgY29uc3QgbmV3VGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBjYWxsYmFjayguLi5hcmdzKQogICAgICB9LCBkZWxheSkKCiAgICAgIHNldERlYm91bmNlVGltZXIobmV3VGltZXIpCiAgICB9LAogICAgW2NhbGxiYWNrLCBkZWxheSwgZGVib3VuY2VUaW1lcl0sCiAgKQoKICByZXR1cm4gZGVib3VuY2VkQ2FsbGJhY2sKfQoKaW50ZXJmYWNlIEFzc2lnblByb2R1Y3RUb1NoZWxmRm9ybVByb3BzIHsKICBzaGVsZklkOiBzdHJpbmcKICBjdXJyZW50RWFuPzogc3RyaW5nCiAgY3VycmVudFByb2R1Y3ROYW1lPzogc3RyaW5nCiAgY3VycmVudE9jY3VwYW5jeVBlcmNlbnRhZ2U/OiBudW1iZXIKICBvblN1Y2Nlc3M/OiAoKSA9PiB2b2lkCn0KCmludGVyZmFjZSBEdXBsaWNhdGVMb2NhdGlvbiB7CiAgYWRkcmVzczogc3RyaW5nCiAgd2FyZWhvdXNlSWQ6IHN0cmluZwogIGFpc2xlSWQ6IHN0cmluZwogIHBvc2l0aW9uOiBudW1iZXIKICBsZXZlbD86IG51bWJlcgogIHByb2R1Y3ROYW1lOiBzdHJpbmcKICBzdG9yYWdlVHlwZTogc3RyaW5nCiAgcGFsbGV0SWQ6IHN0cmluZwogIGFpc2xlTmFtZTogc3RyaW5nCiAgd2FyZWhvdXNlTmFtZTogc3RyaW5nCn0KCmZ1bmN0aW9uIFN1Ym1pdEJ1dHRvbigpIHsKICBjb25zdCB7IHBlbmRpbmcgfSA9IHVzZUZvcm1TdGF0dXMoKQogIHJldHVybiAoCiAgICA8QnV0dG9uIHR5cGU9InN1Ym1pdCIgYXJpYS1kaXNhYmxlZD17cGVuZGluZ30gY2xhc3NOYW1lPSJ3LWZ1bGwiPgogICAgICB7cGVuZGluZyA/ICJBdHJpYnVpbmRvLi4uIiA6ICJBdHJpYnVpciBQcm9kdXRvIn0KICAgIDwvQnV0dG9uPgogICkKfQoKZXhwb3J0IGZ1bmN0aW9uIEFzc2lnblByb2R1Y3RUb1NoZWxmRm9ybSh7CiAgc2hlbGZJZCwKICBjdXJyZW50RWFuID0gIiIsCiAgY3VycmVudFByb2R1Y3ROYW1lID0gIiIsCiAgY3VycmVudE9jY3VwYW5jeVBlcmNlbnRhZ2UgPSAwLAogIG9uU3VjY2VzcywKfTogQXNzaWduUHJvZHVjdFRvU2hlbGZGb3JtUHJvcHMpIHsKICBjb25zdCBbc3RhdGUsIGZvcm1BY3Rpb25dID0gdXNlQWN0aW9uU3RhdGUoYXNzaWduUHJvZHVjdFRvU2hlbGYuYmluZChudWxsLCBzaGVsZklkKSwgeyBtZXNzYWdlOiAiIiB9KQoKICBjb25zdCBbZWFuLCBzZXRFYW5dID0gdXNlU3RhdGUoY3VycmVudEVhbikKICBjb25zdCBbcHJvZHVjdE5hbWUsIHNldFByb2R1Y3ROYW1lXSA9IHVzZVN0YXRlKGN1cnJlbnRQcm9kdWN0TmFtZSkKICBjb25zdCBbb2NjdXBhbmN5UGVyY2VudGFnZSwgc2V0T2NjdXBhbmN5UGVyY2VudGFnZV0gPSB1c2VTdGF0ZShjdXJyZW50T2NjdXBhbmN5UGVyY2VudGFnZS50b1N0cmluZygpKQogIGNvbnN0IFtkdXBsaWNhdGVMb2NhdGlvbiwgc2V0RHVwbGljYXRlTG9jYXRpb25dID0gdXNlU3RhdGU8RHVwbGljYXRlTG9jYXRpb24gfCBudWxsPihudWxsKQogIGNvbnN0IFtpc0NoZWNraW5nRHVwbGljYXRlLCBzZXRJc0NoZWNraW5nRHVwbGljYXRlXSA9IHVzZVN0YXRlKGZhbHNlKQogIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpCiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gdXNlU2VhcmNoUGFyYW1zKCkKICBjb25zdCB7IHN1Y2Nlc3MsIGVycm9yIH0gPSB1c2VBY3Rpb25GZWVkYmFjaygpCgogIGNvbnN0IGNoZWNrRm9yRHVwbGljYXRlRUFOID0gdXNlQ2FsbGJhY2soYXN5bmMgKGVhblZhbHVlOiBzdHJpbmcpID0+IHsKICAgIGlmICghZWFuVmFsdWUgfHwgZWFuVmFsdWUubGVuZ3RoIDwgNCkgewogICAgICBzZXREdXBsaWNhdGVMb2NhdGlvbihudWxsKQogICAgICByZXR1cm4KICAgIH0KCiAgICBzZXRJc0NoZWNraW5nRHVwbGljYXRlKHRydWUpCiAgICB0cnkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL3Byb2R1Y3RzL2NoZWNrLWR1cGxpY2F0ZT9lYW49JHtlbmNvZGVVUklDb21wb25lbnQoZWFuVmFsdWUpfWApCiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkKCiAgICAgIGlmIChkYXRhLnN1Y2Nlc3MgJiYgZGF0YS5sb2NhdGlvbikgewogICAgICAgIHNldER1cGxpY2F0ZUxvY2F0aW9uKGRhdGEubG9jYXRpb24pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0RHVwbGljYXRlTG9jYXRpb24obnVsbCkKICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcigiRXJybyBhbyB2ZXJpZmljYXIgRUFOIGR1cGxpY2FkbzoiLCBlcnJvcikKICAgICAgc2V0RHVwbGljYXRlTG9jYXRpb24obnVsbCkKICAgIH0gZmluYWxseSB7CiAgICAgIHNldElzQ2hlY2tpbmdEdXBsaWNhdGUoZmFsc2UpCiAgICB9CiAgfSwgW10pCgogIGNvbnN0IGRlYm91bmNlZENoZWNrRHVwbGljYXRlID0gdXNlRGVib3VuY2UoY2hlY2tGb3JEdXBsaWNhdGVFQU4sIDgwMCkKCiAgY29uc3QgaGFuZGxlRWFuQ2hhbmdlID0gKHZhbHVlOiBzdHJpbmcpID0+IHsKICAgIHNldEVhbih2YWx1ZSkKICAgIGlmICh2YWx1ZS5sZW5ndGggPj0gNCkgewogICAgICBkZWJvdW5jZWRDaGVja0R1cGxpY2F0ZSh2YWx1ZS50cmltKCkpCiAgICB9IGVsc2UgewogICAgICBzZXREdXBsaWNhdGVMb2NhdGlvbihudWxsKQogICAgfQogIH0KCiAgY29uc3QgaGFuZGxlRHVwbGljYXRlTG9jYXRpb25DbGljayA9ICgpID0+IHsKICAgIGlmIChkdXBsaWNhdGVMb2NhdGlvbikgewogICAgICBjb25zdCBjdXJyZW50U2VsZWN0ZWRBaXNsZSA9IHNlYXJjaFBhcmFtcy5nZXQoInNlbGVjdGVkQWlzbGUiKQogICAgICBjb25zdCB3YXJlaG91c2VVcmwgPSBgL3dhcmVob3VzZXMvJHtkdXBsaWNhdGVMb2NhdGlvbi53YXJlaG91c2VJZH0/aGlnaGxpZ2h0PSR7ZHVwbGljYXRlTG9jYXRpb24ucGFsbGV0SWR9JnR5cGU9JHtkdXBsaWNhdGVMb2NhdGlvbi5zdG9yYWdlVHlwZX0ke2N1cnJlbnRTZWxlY3RlZEFpc2xlID8gYCZzZWxlY3RlZEFpc2xlPSR7Y3VycmVudFNlbGVjdGVkQWlzbGV9YCA6ICIifWAKICAgICAgcm91dGVyLnB1c2god2FyZWhvdXNlVXJsKQoKICAgICAgdG9hc3QoewogICAgICAgIHRpdGxlOiAiTmF2ZWdhbmRvIHBhcmEgbG9jYWxpemHDp8OjbyIsCiAgICAgICAgZGVzY3JpcHRpb246IGBJbmRvIHBhcmEgJHtkdXBsaWNhdGVMb2NhdGlvbi5hZGRyZXNzfWAsCiAgICAgIH0pCiAgICB9CiAgfQoKICB1c2VFZmZlY3QoKCkgPT4gewogICAgaWYgKHN0YXRlLm1lc3NhZ2UpIHsKICAgICAgaWYgKHN0YXRlLm1lc3NhZ2UuaW5jbHVkZXMoInN1Y2Vzc28iKSkgewogICAgICAgIHN1Y2Nlc3Moc3RhdGUubWVzc2FnZSwgc2hlbGZJZCwgInNoZWxmIikKICAgICAgfSBlbHNlIHsKICAgICAgICBlcnJvcihzdGF0ZS5tZXNzYWdlKQogICAgICB9CiAgICAgIGlmIChzdGF0ZS5tZXNzYWdlLmluY2x1ZGVzKCJzdWNlc3NvIikpIHsKICAgICAgICBpZiAob25TdWNjZXNzKSB7CiAgICAgICAgICBvblN1Y2Nlc3MoKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBjdXJyZW50UGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhzZWFyY2hQYXJhbXMudG9TdHJpbmcoKSkKICAgICAgICAgIGN1cnJlbnRQYXJhbXMuc2V0KCJoaWdobGlnaHQiLCBzaGVsZklkKQogICAgICAgICAgY3VycmVudFBhcmFtcy5zZXQoInR5cGUiLCAic2hlbGYiKQogICAgICAgICAgY29uc3QgbmV3VXJsID0gYCR7d2luZG93LmxvY2F0aW9uLnBhdGhuYW1lfT8ke2N1cnJlbnRQYXJhbXMudG9TdHJpbmcoKX1gCiAgICAgICAgICByb3V0ZXIucmVwbGFjZShuZXdVcmwsIHsgc2Nyb2xsOiBmYWxzZSB9KQogICAgICAgICAgcm91dGVyLnJlZnJlc2goKQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIFtzdGF0ZSwgb25TdWNjZXNzLCByb3V0ZXIsIHNlYXJjaFBhcmFtc10pCgogIHJldHVybiAoCiAgICA8ZGl2IGNsYXNzTmFtZT0idy1mdWxsIj4KICAgICAgPGZvcm0gYWN0aW9uPXtmb3JtQWN0aW9ufSBjbGFzc05hbWU9ImdyaWQgZ2FwLTQiPgogICAgICAgIDxkaXYgY2xhc3NOYW1lPSJncmlkIGdhcC0yIj4KICAgICAgICAgIDxMYWJlbCBodG1sRm9yPSJlYW4iPkVBTjwvTGFiZWw+CiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0icmVsYXRpdmUiPgogICAgICAgICAgICA8SW5wdXQKICAgICAgICAgICAgICBpZD0iZWFuIgogICAgICAgICAgICAgIG5hbWU9ImVhbiIKICAgICAgICAgICAgICBwbGFjZWhvbGRlcj0iRXg6IDc4OTEyMzQ1Njc4OTAiCiAgICAgICAgICAgICAgdmFsdWU9e2Vhbn0KICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUVhbkNoYW5nZShlLnRhcmdldC52YWx1ZSl9CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgICBhdXRvQ29tcGxldGU9Im9mZiIKICAgICAgICAgICAgLz4KICAgICAgICAgICAge2lzQ2hlY2tpbmdEdXBsaWNhdGUgJiYgKAogICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJhYnNvbHV0ZSByaWdodC0yIHRvcC0xLzIgdHJhbnNmb3JtIC10cmFuc2xhdGUteS0xLzIiPgogICAgICAgICAgICAgICAgPExvYWRlcjIgY2xhc3NOYW1lPSJoLTQgdy00IGFuaW1hdGUtc3BpbiB0ZXh0LWJsdWUtNTAwIiAvPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICApfQogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIHtkdXBsaWNhdGVMb2NhdGlvbiAmJiAoCiAgICAgICAgICA8ZGl2CiAgICAgICAgICAgIGNsYXNzTmFtZT0iYmctYW1iZXItNTAgZGFyazpiZy1hbWJlci05MDAvMjAgYm9yZGVyIGJvcmRlci1hbWJlci0yMDAgZGFyazpib3JkZXItYW1iZXItNzAwIHJvdW5kZWQtbGcgcC0zIGN1cnNvci1wb2ludGVyIGhvdmVyOmJnLWFtYmVyLTEwMCBkYXJrOmhvdmVyOmJnLWFtYmVyLTkwMC8zMCB0cmFuc2l0aW9uLWNvbG9ycyIKICAgICAgICAgICAgb25DbGljaz17aGFuZGxlRHVwbGljYXRlTG9jYXRpb25DbGlja30KICAgICAgICAgID4KICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImZsZXggaXRlbXMtc3RhcnQgZ2FwLTIiPgogICAgICAgICAgICAgIDxBbGVydFRyaWFuZ2xlIGNsYXNzTmFtZT0iaC00IHctNCB0ZXh0LWFtYmVyLTYwMCBkYXJrOnRleHQtYW1iZXItNDAwIG10LTAuNSBmbGV4LXNocmluay0wIiAvPgogICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJ0ZXh0LXhzIHRleHQtYW1iZXItODAwIGRhcms6dGV4dC1hbWJlci0yMDAgZmxleC0xIj4KICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0iZm9udC1tZWRpdW0gbWItMSBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSI+CiAgICAgICAgICAgICAgICAgIDxNYXBQaW4gY2xhc3NOYW1lPSJoLTMgdy0zIiAvPgogICAgICAgICAgICAgICAgICBFQU4gasOhIHBvc3N1aSBlbmRlcmXDp2FtZW50bwogICAgICAgICAgICAgICAgPC9wPgogICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJtYi0xIj4KICAgICAgICAgICAgICAgICAgPHN0cm9uZz5Mb2NhbGl6YcOnw6NvOjwvc3Ryb25nPiB7U3RyaW5nKGR1cGxpY2F0ZUxvY2F0aW9uLmFkZHJlc3MgfHwgIiIpfQogICAgICAgICAgICAgICAgPC9wPgogICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJtYi0xIj4KICAgICAgICAgICAgICAgICAgPHN0cm9uZz5Qcm9kdXRvOjwvc3Ryb25nPiB7U3RyaW5nKGR1cGxpY2F0ZUxvY2F0aW9uLnByb2R1Y3ROYW1lIHx8ICIiKX0KICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ibWItMSB0ZXh0LWFtYmVyLTcwMCBkYXJrOnRleHQtYW1iZXItMzAwIj4KICAgICAgICAgICAgICAgICAgPHN0cm9uZz5HYWxww6NvOjwvc3Ryb25nPiB7U3RyaW5nKGR1cGxpY2F0ZUxvY2F0aW9uLndhcmVob3VzZU5hbWUgfHwgIiIpfQogICAgICAgICAgICAgICAgPC9wPgogICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJ0ZXh0LWFtYmVyLTcwMCBkYXJrOnRleHQtYW1iZXItMzAwIGZvbnQtbWVkaXVtIj4KICAgICAgICAgICAgICAgICAg8J+RhiBDbGlxdWUgYXF1aSBwYXJhIGlyIGF0w6kgYSBsb2NhbGl6YcOnw6NvIGRvIHByb2R1dG8KICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICApfQoKICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZ3JpZCBnYXAtMiI+CiAgICAgICAgICA8TGFiZWwgaHRtbEZvcj0icHJvZHVjdE5hbWUiPk5vbWUgZG8gUHJvZHV0bzwvTGFiZWw+CiAgICAgICAgICA8SW5wdXQKICAgICAgICAgICAgaWQ9InByb2R1Y3ROYW1lIgogICAgICAgICAgICBuYW1lPSJwcm9kdWN0TmFtZSIKICAgICAgICAgICAgcGxhY2Vob2xkZXI9IkV4OiBDYWl4YSBkZSBQYXJhZnVzb3MiCiAgICAgICAgICAgIHZhbHVlPXtwcm9kdWN0TmFtZX0KICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRQcm9kdWN0TmFtZShlLnRhcmdldC52YWx1ZSl9CiAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIGF1dG9Db21wbGV0ZT0ib2ZmIgogICAgICAgICAgLz4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZ3JpZCBnYXAtMiI+CiAgICAgICAgICA8TGFiZWwgaHRtbEZvcj0ib2NjdXBhbmN5UGVyY2VudGFnZSI+UG9yY2VudGFnZW0gZGUgT2N1cGHDp8OjbyAoJSk8L0xhYmVsPgogICAgICAgICAgPElucHV0CiAgICAgICAgICAgIGlkPSJvY2N1cGFuY3lQZXJjZW50YWdlIgogICAgICAgICAgICBuYW1lPSJvY2N1cGFuY3lQZXJjZW50YWdlIgogICAgICAgICAgICB0eXBlPSJudW1iZXIiCiAgICAgICAgICAgIHBsYWNlaG9sZGVyPSJFeDogNzUiCiAgICAgICAgICAgIG1pbj0iMCIKICAgICAgICAgICAgbWF4PSIxMDAiCiAgICAgICAgICAgIHZhbHVlPXtvY2N1cGFuY3lQZXJjZW50YWdlfQogICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldE9jY3VwYW5jeVBlcmNlbnRhZ2UoZS50YXJnZXQudmFsdWUpfQogICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICBhdXRvQ29tcGxldGU9Im9mZiIKICAgICAgICAgIC8+CiAgICAgICAgICA8cCBjbGFzc05hbWU9InRleHQteHMgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kIj5JbmRpcXVlIHF1YW50byBkYSBwcmF0ZWxlaXJhIGVzdMOhIG9jdXBhZGEgKDAtMTAwJSk8L3A+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPFN1Ym1pdEJ1dHRvbiAvPgogICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICApCn0K"}