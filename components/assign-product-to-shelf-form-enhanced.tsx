{"data":"InVzZSBjbGllbnQiCgppbXBvcnQgdHlwZSBSZWFjdCBmcm9tICJyZWFjdCIKaW1wb3J0IHsgdXNlU3RhdGUsIHVzZVRyYW5zaXRpb24sIHVzZUNhbGxiYWNrIH0gZnJvbSAicmVhY3QiCmltcG9ydCB7IGFzc2lnblByb2R1Y3RUb1NoZWxmIH0gZnJvbSAiQC9hcHAvYWN0aW9ucyIKaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL2J1dHRvbiIKaW1wb3J0IHsgSW5wdXQgfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvaW5wdXQiCmltcG9ydCB7IExhYmVsIH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL2xhYmVsIgppbXBvcnQgeyB0b2FzdCB9IGZyb20gIkAvaG9va3MvdXNlLXRvYXN0IgppbXBvcnQgeyBMb2FkaW5nT3ZlcmxheSB9IGZyb20gIi4vbG9hZGluZy1vdmVybGF5IgppbXBvcnQgeyBMb2FkZXIyLCBTZWFyY2gsIENoZWNrQ2lyY2xlLCBBbGVydFRyaWFuZ2xlLCBNYXBQaW4gfSBmcm9tICJsdWNpZGUtcmVhY3QiCmltcG9ydCB7IHVzZVJvdXRlciwgdXNlU2VhcmNoUGFyYW1zIH0gZnJvbSAibmV4dC9uYXZpZ2F0aW9uIgppbXBvcnQgeyB1c2VBY3Rpb25GZWVkYmFjayB9IGZyb20gIkAvaG9va3MvdXNlLWFjdGlvbi1mZWVkYmFjayIKCmZ1bmN0aW9uIHVzZURlYm91bmNlPFQgZXh0ZW5kcyAoLi4uYXJnczogYW55W10pID0+IGFueT4oY2FsbGJhY2s6IFQsIGRlbGF5OiBudW1iZXIpIHsKICBjb25zdCBbZGVib3VuY2VUaW1lciwgc2V0RGVib3VuY2VUaW1lcl0gPSB1c2VTdGF0ZTxOb2RlSlMuVGltZW91dCB8IG51bGw+KG51bGwpCgogIGNvbnN0IGRlYm91bmNlZENhbGxiYWNrID0gdXNlQ2FsbGJhY2soCiAgICAoLi4uYXJnczogUGFyYW1ldGVyczxUPikgPT4gewogICAgICBpZiAoZGVib3VuY2VUaW1lcikgewogICAgICAgIGNsZWFyVGltZW91dChkZWJvdW5jZVRpbWVyKQogICAgICB9CgogICAgICBjb25zdCBuZXdUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGNhbGxiYWNrKC4uLmFyZ3MpCiAgICAgIH0sIGRlbGF5KQoKICAgICAgc2V0RGVib3VuY2VUaW1lcihuZXdUaW1lcikKICAgIH0sCiAgICBbY2FsbGJhY2ssIGRlbGF5LCBkZWJvdW5jZVRpbWVyXSwKICApCgogIHJldHVybiBkZWJvdW5jZWRDYWxsYmFjawp9CgppbnRlcmZhY2UgQXNzaWduUHJvZHVjdFRvU2hlbGZGb3JtRW5oYW5jZWRQcm9wcyB7CiAgc2hlbGZJZDogc3RyaW5nCiAgY3VycmVudEVhbj86IHN0cmluZwogIGN1cnJlbnRQcm9kdWN0TmFtZT86IHN0cmluZwogIGN1cnJlbnRPY2N1cGFuY3lQZXJjZW50YWdlPzogbnVtYmVyCiAgb25TdWNjZXNzPzogKCkgPT4gdm9pZAogIGlzQWRkTW9kZT86IGJvb2xlYW4KfQoKaW50ZXJmYWNlIER1cGxpY2F0ZUxvY2F0aW9uIHsKICBhZGRyZXNzOiBzdHJpbmcKICB3YXJlaG91c2VJZDogc3RyaW5nCiAgYWlzbGVJZDogc3RyaW5nCiAgcG9zaXRpb246IG51bWJlcgogIGxldmVsPzogbnVtYmVyCiAgcHJvZHVjdE5hbWU6IHN0cmluZwogIHN0b3JhZ2VUeXBlOiBzdHJpbmcKICBwYWxsZXRJZDogc3RyaW5nCiAgYWlzbGVOYW1lOiBzdHJpbmcKICB3YXJlaG91c2VOYW1lOiBzdHJpbmcKfQoKZXhwb3J0IGZ1bmN0aW9uIEFzc2lnblByb2R1Y3RUb1NoZWxmRm9ybUVuaGFuY2VkKHsKICBzaGVsZklkLAogIGN1cnJlbnRFYW4gPSAiIiwKICBjdXJyZW50UHJvZHVjdE5hbWUgPSAiIiwKICBjdXJyZW50T2NjdXBhbmN5UGVyY2VudGFnZSA9IDAsCiAgb25TdWNjZXNzLAogIGlzQWRkTW9kZSA9IGZhbHNlLAp9OiBBc3NpZ25Qcm9kdWN0VG9TaGVsZkZvcm1FbmhhbmNlZFByb3BzKSB7CiAgLy8gRXN0YWRvcyBkbyBmb3JtdWzDoXJpbwogIGNvbnN0IFtlYW4sIHNldEVhbl0gPSB1c2VTdGF0ZSgiIikgLy8gQ2FtcG8gRUFOIGFnb3JhIHN1cG9ydGEgbcO6bHRpcGxvcyBFQU5zIHNlcGFyYWRvcyBwb3IgdsOtcmd1bGEKICBjb25zdCBbaWQsIHNldElkXSA9IHVzZVN0YXRlKGlzQWRkTW9kZSA/ICIiIDogY3VycmVudEVhbikgLy8gQ2FtcG8gSUQgKGFudGlnbyBFQU4sIGNvbHVuYSBFKQogIGNvbnN0IFtwcm9kdWN0TmFtZSwgc2V0UHJvZHVjdE5hbWVdID0gdXNlU3RhdGUoaXNBZGRNb2RlID8gIiIgOiBjdXJyZW50UHJvZHVjdE5hbWUpCiAgY29uc3QgW2lzU2VhcmNoaW5nLCBzZXRJc1NlYXJjaGluZ10gPSB1c2VTdGF0ZShmYWxzZSkKICBjb25zdCBbcHJvZHVjdEZvdW5kLCBzZXRQcm9kdWN0Rm91bmRdID0gdXNlU3RhdGUoZmFsc2UpCiAgY29uc3QgW2R1cGxpY2F0ZUxvY2F0aW9uLCBzZXREdXBsaWNhdGVMb2NhdGlvbl0gPSB1c2VTdGF0ZTxEdXBsaWNhdGVMb2NhdGlvbiB8IG51bGw+KG51bGwpCiAgY29uc3QgW2lzQ2hlY2tpbmdEdXBsaWNhdGUsIHNldElzQ2hlY2tpbmdEdXBsaWNhdGVdID0gdXNlU3RhdGUoZmFsc2UpCgogIC8vIFVzYXIgdXNlVHJhbnNpdGlvbiBwYXJhIGNvbnRyb2xhciBvIGVzdGFkbyBkZSBzdWJtaXNzw6NvCiAgY29uc3QgW2lzUGVuZGluZywgc3RhcnRUcmFuc2l0aW9uXSA9IHVzZVRyYW5zaXRpb24oKQogIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpCiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gdXNlU2VhcmNoUGFyYW1zKCkKICBjb25zdCB7IHN1Y2Nlc3MsIGVycm9yIH0gPSB1c2VBY3Rpb25GZWVkYmFjaygpCgogIGNvbnNvbGUubG9nKCLwn5SEIEFzc2lnblByb2R1Y3RUb1NoZWxmRm9ybUVuaGFuY2VkIHJlbmRlcml6YWRvOiIsIHsKICAgIHNoZWxmSWQsCiAgICBpc0FkZE1vZGUsCiAgICBjdXJyZW50RWFuLAogICAgY3VycmVudFByb2R1Y3ROYW1lLAogICAgZWFuLAogICAgaWQsCiAgICBwcm9kdWN0TmFtZSwKICB9KQoKICBjb25zdCBjaGVja0ZvckR1cGxpY2F0ZUVBTiA9IHVzZUNhbGxiYWNrKGFzeW5jIChlYW5WYWx1ZTogc3RyaW5nKSA9PiB7CiAgICBpZiAoIWVhblZhbHVlIHx8IGVhblZhbHVlLmxlbmd0aCA8IDQpIHsKICAgICAgc2V0RHVwbGljYXRlTG9jYXRpb24obnVsbCkKICAgICAgcmV0dXJuCiAgICB9CgogICAgc2V0SXNDaGVja2luZ0R1cGxpY2F0ZSh0cnVlKQogICAgdHJ5IHsKICAgICAgY29uc29sZS5sb2coIvCflI0gVmVyaWZpY2FuZG8gRUFOIGR1cGxpY2FkbyAoY29tIGRlYm91bmNlKToiLCBlYW5WYWx1ZSkKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9wcm9kdWN0cy9jaGVjay1kdXBsaWNhdGU/ZWFuPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGVhblZhbHVlKX1gKQogICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpCgogICAgICBpZiAoZGF0YS5zdWNjZXNzICYmIGRhdGEubG9jYXRpb24pIHsKICAgICAgICBjb25zb2xlLmxvZygi4pqg77iPIEVBTiBkdXBsaWNhZG8gZW5jb250cmFkbzoiLCBkYXRhLmxvY2F0aW9uKQogICAgICAgIHNldER1cGxpY2F0ZUxvY2F0aW9uKGRhdGEubG9jYXRpb24pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coIuKchSBFQU4gbsOjbyBkdXBsaWNhZG8iKQogICAgICAgIHNldER1cGxpY2F0ZUxvY2F0aW9uKG51bGwpCiAgICAgIH0KICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIuKdjCBFcnJvIGFvIHZlcmlmaWNhciBFQU4gZHVwbGljYWRvOiIsIGVycm9yKQogICAgICBzZXREdXBsaWNhdGVMb2NhdGlvbihudWxsKQogICAgfSBmaW5hbGx5IHsKICAgICAgc2V0SXNDaGVja2luZ0R1cGxpY2F0ZShmYWxzZSkKICAgIH0KICB9LCBbXSkKCiAgY29uc3Qgc2VhcmNoUHJvZHVjdEJ5RUFOID0gdXNlQ2FsbGJhY2soYXN5bmMgKGVhblZhbHVlOiBzdHJpbmcpID0+IHsKICAgIGlmICghZWFuVmFsdWUgfHwgZWFuVmFsdWUubGVuZ3RoIDwgNCkgewogICAgICBzZXRQcm9kdWN0Rm91bmQoZmFsc2UpCiAgICAgIHNldElkKCIiKQogICAgICBzZXRQcm9kdWN0TmFtZSgiIikKICAgICAgcmV0dXJuCiAgICB9CgogICAgc2V0SXNTZWFyY2hpbmcodHJ1ZSkKICAgIHRyeSB7CiAgICAgIGNvbnNvbGUubG9nKCLwn5SNIEJ1c2NhbmRvIHByb2R1dG8gY29tIEVBTiAoY29tIGRlYm91bmNlKToiLCBlYW5WYWx1ZSkKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9wcm9kdWN0cy9zZWFyY2g/ZWFuPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGVhblZhbHVlKX1gKQogICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpCgogICAgICBpZiAoZGF0YS5zdWNjZXNzICYmIGRhdGEucHJvZHVjdCkgewogICAgICAgIGNvbnNvbGUubG9nKCLinIUgUHJvZHV0byBlbmNvbnRyYWRvOiIsIGRhdGEucHJvZHVjdCkKICAgICAgICBzZXRJZChkYXRhLnByb2R1Y3QuaWQpIC8vIFByZWVuY2hlciBvIGNhbXBvIElEIGNvbSBvIHZhbG9yIGRhIGNvbHVuYSBFCiAgICAgICAgc2V0UHJvZHVjdE5hbWUoZGF0YS5wcm9kdWN0LmRlc2NyaXB0aW9uKQogICAgICAgIHNldFByb2R1Y3RGb3VuZCh0cnVlKQogICAgICAgIHRvYXN0KHsKICAgICAgICAgIHRpdGxlOiAiUHJvZHV0byBlbmNvbnRyYWRvISIsCiAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7ZGF0YS5wcm9kdWN0LmRlc2NyaXB0aW9ufSAtICR7ZGF0YS5wcm9kdWN0LmJyYW5kfWAsCiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygi4p2MIFByb2R1dG8gbsOjbyBlbmNvbnRyYWRvIikKICAgICAgICBzZXRQcm9kdWN0Rm91bmQoZmFsc2UpCiAgICAgICAgc2V0SWQoIiIpCiAgICAgICAgc2V0UHJvZHVjdE5hbWUoIiIpCiAgICAgICAgaWYgKGVhblZhbHVlLmxlbmd0aCA+PSA0KSB7CiAgICAgICAgICB0b2FzdCh7CiAgICAgICAgICAgIHRpdGxlOiAiUHJvZHV0byBuw6NvIGVuY29udHJhZG8iLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogIkVBTiBuw6NvIGVuY29udHJhZG8gbmEgYmFzZSBkZSBkYWRvcy4gVm9jw6ogcG9kZSBpbnNlcmlyIG8gSUQgZSBub21lIG1hbnVhbG1lbnRlLiIsCiAgICAgICAgICAgIHZhcmlhbnQ6ICJkZXN0cnVjdGl2ZSIsCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcigi4p2MIEVycm8gYW8gYnVzY2FyIHByb2R1dG86IiwgZXJyb3IpCiAgICAgIHNldFByb2R1Y3RGb3VuZChmYWxzZSkKICAgICAgc2V0SWQoIiIpCiAgICAgIHNldFByb2R1Y3ROYW1lKCIiKQogICAgICB0b2FzdCh7CiAgICAgICAgdGl0bGU6ICJFcnJvIG5hIGJ1c2NhIiwKICAgICAgICBkZXNjcmlwdGlvbjogIk7Do28gZm9pIHBvc3PDrXZlbCBidXNjYXIgbyBwcm9kdXRvLiBUZW50ZSBub3ZhbWVudGUuIiwKICAgICAgICB2YXJpYW50OiAiZGVzdHJ1Y3RpdmUiLAogICAgICB9KQogICAgfSBmaW5hbGx5IHsKICAgICAgc2V0SXNTZWFyY2hpbmcoZmFsc2UpCiAgICB9CiAgfSwgW10pCgogIGNvbnN0IGRlYm91bmNlZENoZWNrRHVwbGljYXRlID0gdXNlRGVib3VuY2UoY2hlY2tGb3JEdXBsaWNhdGVFQU4sIDgwMCkKICBjb25zdCBkZWJvdW5jZWRTZWFyY2hQcm9kdWN0ID0gdXNlRGVib3VuY2Uoc2VhcmNoUHJvZHVjdEJ5RUFOLCA2MDApCgogIGNvbnN0IGhhbmRsZUVhbkNoYW5nZSA9ICh2YWx1ZTogc3RyaW5nKSA9PiB7CiAgICBzZXRFYW4odmFsdWUpCgogICAgY29uc3QgZmlyc3RFYW4gPSB2YWx1ZS5zcGxpdCgiOyIpWzBdLnRyaW0oKSAvLyBDaGFuZ2VkIHRvIHNwbGl0IGJ5IHNlbWljb2xvbgoKICAgIGlmIChmaXJzdEVhbi5sZW5ndGggPCA0KSB7CiAgICAgIHNldFByb2R1Y3RGb3VuZChmYWxzZSkKICAgICAgc2V0SWQoIiIpCiAgICAgIHNldFByb2R1Y3ROYW1lKCIiKQogICAgICBzZXREdXBsaWNhdGVMb2NhdGlvbihudWxsKQogICAgICByZXR1cm4KICAgIH0KCiAgICBkZWJvdW5jZWRDaGVja0R1cGxpY2F0ZShmaXJzdEVhbikKICAgIGRlYm91bmNlZFNlYXJjaFByb2R1Y3QoZmlyc3RFYW4pCiAgfQoKICBjb25zdCBoYW5kbGVFYW5LZXlEb3duID0gKGU6IFJlYWN0LktleWJvYXJkRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHsKICAgIGlmIChlLmtleSA9PT0gIkVudGVyIikgewogICAgICBlLnByZXZlbnREZWZhdWx0KCkKICAgICAgY29uc3QgZmlyc3RFYW4gPSBlYW4uc3BsaXQoIjsiKVswXS50cmltKCkgLy8gQ2hhbmdlZCB0byBzcGxpdCBieSBzZW1pY29sb24KICAgICAgaWYgKGZpcnN0RWFuLmxlbmd0aCA+PSA0KSB7CiAgICAgICAgY2hlY2tGb3JEdXBsaWNhdGVFQU4oZmlyc3RFYW4pCiAgICAgICAgc2VhcmNoUHJvZHVjdEJ5RUFOKGZpcnN0RWFuKQogICAgICB9IGVsc2UgewogICAgICAgIHRvYXN0KHsKICAgICAgICAgIHRpdGxlOiAiRUFOIG11aXRvIGN1cnRvIiwKICAgICAgICAgIGRlc2NyaXB0aW9uOiAiRGlnaXRlIHBlbG8gbWVub3MgNCBjYXJhY3RlcmVzIHBhcmEgYnVzY2FyIG8gcHJvZHV0by4iLAogICAgICAgICAgdmFyaWFudDogImRlc3RydWN0aXZlIiwKICAgICAgICB9KQogICAgICB9CiAgICB9CiAgfQoKICBjb25zdCBoYW5kbGVEdXBsaWNhdGVMb2NhdGlvbkNsaWNrID0gKCkgPT4gewogICAgaWYgKGR1cGxpY2F0ZUxvY2F0aW9uKSB7CiAgICAgIGNvbnN0IGN1cnJlbnRTZWxlY3RlZEFpc2xlID0gc2VhcmNoUGFyYW1zLmdldCgic2VsZWN0ZWRBaXNsZSIpCiAgICAgIGNvbnN0IHdhcmVob3VzZVVybCA9IGAvd2FyZWhvdXNlcy8ke2R1cGxpY2F0ZUxvY2F0aW9uLndhcmVob3VzZUlkfT9oaWdobGlnaHQ9JHtkdXBsaWNhdGVMb2NhdGlvbi5wYWxsZXRJZH0mdHlwZT0ke2R1cGxpY2F0ZUxvY2F0aW9uLnN0b3JhZ2VUeXBlfSR7Y3VycmVudFNlbGVjdGVkQWlzbGUgPyBgJnNlbGVjdGVkQWlzbGU9JHtjdXJyZW50U2VsZWN0ZWRBaXNsZX1gIDogIiJ9YAogICAgICByb3V0ZXIucHVzaCh3YXJlaG91c2VVcmwpCgogICAgICB0b2FzdCh7CiAgICAgICAgdGl0bGU6ICJOYXZlZ2FuZG8gcGFyYSBsb2NhbGl6YcOnw6NvIiwKICAgICAgICBkZXNjcmlwdGlvbjogYEluZG8gcGFyYSAke2R1cGxpY2F0ZUxvY2F0aW9uLmFkZHJlc3N9YCwKICAgICAgfSkKICAgIH0KICB9CgogIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IGFzeW5jICgpID0+IHsKICAgIGNvbnNvbGUubG9nKCLwn5qAIEluaWNpYW5kbyBzdWJtaXNzw6NvIGRvIGZvcm11bMOhcmlvLi4uIikKICAgIGNvbnNvbGUubG9nKCLwn5OdIERhZG9zIGRvIGZvcm11bMOhcmlvOiIsIHsKICAgICAgc2hlbGZJZCwKICAgICAgZWFuOiBlYW4udHJpbSgpLAogICAgICBpZDogaWQudHJpbSgpLAogICAgICBwcm9kdWN0TmFtZTogcHJvZHVjdE5hbWUudHJpbSgpLAogICAgICBpc0FkZE1vZGUsCiAgICAgIGN1cnJlbnRFYW4sCiAgICAgIGN1cnJlbnRQcm9kdWN0TmFtZSwKICAgIH0pCgogICAgaWYgKCFpZC50cmltKCkgfHwgIXByb2R1Y3ROYW1lLnRyaW0oKSkgewogICAgICBjb25zb2xlLmxvZygi4p2MIFZhbGlkYcOnw6NvIGZhbGhvdSAtIGNhbXBvcyBvYnJpZ2F0w7NyaW9zIHZhemlvcyIpCiAgICAgIHRvYXN0KHsKICAgICAgICB0aXRsZTogIkNhbXBvcyBvYnJpZ2F0w7NyaW9zIiwKICAgICAgICBkZXNjcmlwdGlvbjogIklEIGUgTm9tZSBkbyBQcm9kdXRvIHPDo28gb2JyaWdhdMOzcmlvcy4iLAogICAgICAgIHZhcmlhbnQ6ICJkZXN0cnVjdGl2ZSIsCiAgICAgIH0pCiAgICAgIHJldHVybgogICAgfQoKICAgIHN0YXJ0VHJhbnNpdGlvbihhc3luYyAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgZmluYWxFYW4gPSBlYW4udHJpbSgpCiAgICAgICAgbGV0IGZpbmFsSWQgPSBpZC50cmltKCkKICAgICAgICBsZXQgZmluYWxQcm9kdWN0TmFtZSA9IHByb2R1Y3ROYW1lLnRyaW0oKQogICAgICAgIGxldCBmaW5hbFByb2R1Y3RFYW4gPSBmaW5hbEVhbiAvLyBOb3ZvIGNhbXBvIHBhcmEgc2FsdmFyIG3Dumx0aXBsb3MgRUFOcwoKICAgICAgICBpZiAoaXNBZGRNb2RlICYmIGN1cnJlbnRFYW4gJiYgY3VycmVudEVhbi50cmltKCkgIT09ICIiKSB7CiAgICAgICAgICBmaW5hbElkID0gYCR7Y3VycmVudEVhbi50cmltKCl9OyAke2lkLnRyaW0oKX1gIC8vIENoYW5nZWQgdG8gc2VtaWNvbG9uCiAgICAgICAgICBmaW5hbFByb2R1Y3ROYW1lID0KICAgICAgICAgICAgY3VycmVudFByb2R1Y3ROYW1lICYmIGN1cnJlbnRQcm9kdWN0TmFtZS50cmltKCkgIT09ICIiCiAgICAgICAgICAgICAgPyBgJHtjdXJyZW50UHJvZHVjdE5hbWUudHJpbSgpfTsgJHtwcm9kdWN0TmFtZS50cmltKCl9YCAvLyBDaGFuZ2VkIHRvIHNlbWljb2xvbgogICAgICAgICAgICAgIDogcHJvZHVjdE5hbWUudHJpbSgpCiAgICAgICAgICBjb25zdCBjdXJyZW50UHJvZHVjdEVhbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBzaGVsZi0ke3NoZWxmSWR9LWVhbmApIHx8ICIiCiAgICAgICAgICBmaW5hbFByb2R1Y3RFYW4gPSBjdXJyZW50UHJvZHVjdEVhbiA/IGAke2N1cnJlbnRQcm9kdWN0RWFufTsgJHtmaW5hbEVhbn1gIDogZmluYWxFYW4gLy8gQ2hhbmdlZCB0byBzZW1pY29sb24KICAgICAgICAgIGNvbnNvbGUubG9nKCLwn5SEIE1vZG8gYWRpw6fDo28gLSBFQU5zIGNvbWJpbmFkb3M6IiwgZmluYWxQcm9kdWN0RWFuKQogICAgICAgIH0KCiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKQogICAgICAgIGZvcm1EYXRhLnNldCgiZWFuIiwgZmluYWxJZCkKICAgICAgICBmb3JtRGF0YS5zZXQoInByb2R1Y3ROYW1lIiwgZmluYWxQcm9kdWN0TmFtZSkKICAgICAgICBmb3JtRGF0YS5zZXQoIm9jY3VwYW5jeVBlcmNlbnRhZ2UiLCAiMjUiKQogICAgICAgIGZvcm1EYXRhLnNldCgicHJvZHVjdEVhbiIsIGZpbmFsUHJvZHVjdEVhbikgLy8gU2FsdmFyIG3Dumx0aXBsb3MgRUFOcwoKICAgICAgICBjb25zb2xlLmxvZygi8J+TpCBFbnZpYW5kbyBkYWRvczoiLCBPYmplY3QuZnJvbUVudHJpZXMoZm9ybURhdGEuZW50cmllcygpKSkKCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXNzaWduUHJvZHVjdFRvU2hlbGYoc2hlbGZJZCwgeyBtZXNzYWdlOiAiIiwgc3VjY2VzczogZmFsc2UgfSwgZm9ybURhdGEpCgogICAgICAgIGNvbnNvbGUubG9nKCLwn5OlIFJlc3VsdGFkbyBkYSBhY3Rpb246IiwgcmVzdWx0KQoKICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgUHJvZHV0byBzYWx2byBjb20gc3VjZXNzbyEiKQogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYHNoZWxmLSR7c2hlbGZJZH0tZWFuYCwgZmluYWxQcm9kdWN0RWFuKQoKICAgICAgICAgIHRvYXN0KHsKICAgICAgICAgICAgdGl0bGU6ICJTdWNlc3NvISIsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZXN1bHQubWVzc2FnZSwKICAgICAgICAgIH0pCgogICAgICAgICAgaWYgKG9uU3VjY2VzcykgewogICAgICAgICAgICBjb25zb2xlLmxvZygi8J+UhCBDaGFtYW5kbyBvblN1Y2Nlc3MuLi4iKQogICAgICAgICAgICBvblN1Y2Nlc3MoKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3VjY2VzcyhyZXN1bHQubWVzc2FnZSwgc2hlbGZJZCwgInNoZWxmIikKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coIuKdjCBFcnJvIGFvIHNhbHZhcjoiLCByZXN1bHQubWVzc2FnZSkKICAgICAgICAgIGVycm9yKHJlc3VsdC5tZXNzYWdlKQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJybyBuYSBzdWJtaXNzw6NvOiIsIGVycm9yKQogICAgICAgIHRvYXN0KHsKICAgICAgICAgIHRpdGxlOiAiRXJybyIsCiAgICAgICAgICBkZXNjcmlwdGlvbjogIkVycm8gaW5lc3BlcmFkbyBhbyBzYWx2YXIgcHJvZHV0by4gVGVudGUgbm92YW1lbnRlLiIsCiAgICAgICAgICB2YXJpYW50OiAiZGVzdHJ1Y3RpdmUiLAogICAgICAgIH0pCiAgICAgIH0KICAgIH0pCiAgfQoKICByZXR1cm4gKAogICAgPD4KICAgICAgPGRpdiBjbGFzc05hbWU9InctZnVsbCI+CiAgICAgICAgPGRpdiBjbGFzc05hbWU9ImdyaWQgZ2FwLTQiPgogICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImdyaWQgZ2FwLTIiPgogICAgICAgICAgICA8TGFiZWwgaHRtbEZvcj0iZWFuIiBjbGFzc05hbWU9InRleHQtZ3JheS05MDAgZGFyazp0ZXh0LWdyYXktMTAwIj4KICAgICAgICAgICAgICBFQU4gZG8gUHJvZHV0byB7LyogQXR1YWxpemFkbyBsYWJlbCBwYXJhIGluZGljYXIgc3Vwb3J0ZSBhIG3Dumx0aXBsb3MgRUFOcyAqL30KICAgICAgICAgICAgPC9MYWJlbD4KICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9InJlbGF0aXZlIj4KICAgICAgICAgICAgICA8SW5wdXQKICAgICAgICAgICAgICAgIGlkPSJlYW4iCiAgICAgICAgICAgICAgICBuYW1lPSJlYW4iCiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj0iRXg6IDc4OTEyMzQ1Njc4OTAgb3UgMTIzOzQ1Njs3ODkgKG3Dumx0aXBsb3MgRUFOcyBzZXBhcmFkb3MgcG9yIHBvbnRvIGUgdsOtcmd1bGEpIiAvLyBQbGFjZWhvbGRlciBhdHVhbGl6YWRvCiAgICAgICAgICAgICAgICB2YWx1ZT17ZWFufQogICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVFYW5DaGFuZ2UoZS50YXJnZXQudmFsdWUpfQogICAgICAgICAgICAgICAgb25LZXlEb3duPXtoYW5kbGVFYW5LZXlEb3dufQogICAgICAgICAgICAgICAgYXV0b0NvbXBsZXRlPSJvZmYiCiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2Ake3Byb2R1Y3RGb3VuZCA/ICJib3JkZXItZ3JlZW4tNTAwIGJnLWdyZWVuLTUwIGRhcms6YmctZ3JlZW4tOTAwLzIwIiA6ICIifSBiZy13aGl0ZSBkYXJrOmJnLWdyYXktODAwIGJvcmRlci1ncmF5LTMwMCBkYXJrOmJvcmRlci1ncmF5LTYwMCB0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC1ncmF5LTEwMGB9CiAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iYWJzb2x1dGUgcmlnaHQtMiB0b3AtMS8yIHRyYW5zZm9ybSAtdHJhbnNsYXRlLXktMS8yIj4KICAgICAgICAgICAgICAgIHsoaXNTZWFyY2hpbmcgfHwgaXNDaGVja2luZ0R1cGxpY2F0ZSkgJiYgPExvYWRlcjIgY2xhc3NOYW1lPSJoLTQgdy00IGFuaW1hdGUtc3BpbiB0ZXh0LWJsdWUtNTAwIiAvPn0KICAgICAgICAgICAgICAgIHtwcm9kdWN0Rm91bmQgJiYgPENoZWNrQ2lyY2xlIGNsYXNzTmFtZT0iaC00IHctNCB0ZXh0LWdyZWVuLTUwMCIgLz59CiAgICAgICAgICAgICAgICB7IWlzU2VhcmNoaW5nICYmICFpc0NoZWNraW5nRHVwbGljYXRlICYmICFwcm9kdWN0Rm91bmQgJiYgZWFuLmxlbmd0aCA+PSA0ICYmICgKICAgICAgICAgICAgICAgICAgPFNlYXJjaCBjbGFzc05hbWU9ImgtNCB3LTQgdGV4dC1ncmF5LTQwMCIgLz4KICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8cCBjbGFzc05hbWU9InRleHQteHMgdGV4dC1ncmF5LTUwMCBkYXJrOnRleHQtZ3JheS00MDAiPgogICAgICAgICAgICAgIAogICAgICAgICAgICA8L3A+CiAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZ3JpZCBnYXAtMiI+CiAgICAgICAgICAgIDxMYWJlbCBodG1sRm9yPSJpZCIgY2xhc3NOYW1lPSJ0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC1ncmF5LTEwMCI+CiAgICAgICAgICAgICAgSUQgZG8gUHJvZHV0byAqCiAgICAgICAgICAgIDwvTGFiZWw+CiAgICAgICAgICAgIDxJbnB1dAogICAgICAgICAgICAgIGlkPSJpZCIKICAgICAgICAgICAgICBuYW1lPSJpZCIKICAgICAgICAgICAgICBwbGFjZWhvbGRlcj0iRXg6IDEyMzQ1NiIKICAgICAgICAgICAgICB2YWx1ZT17aWR9CiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRJZChlLnRhcmdldC52YWx1ZSl9CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgICBhdXRvQ29tcGxldGU9Im9mZiIKICAgICAgICAgICAgICBjbGFzc05hbWU9e2Ake3Byb2R1Y3RGb3VuZCA/ICJib3JkZXItZ3JlZW4tNTAwIGJnLWdyZWVuLTUwIGRhcms6YmctZ3JlZW4tOTAwLzIwIiA6ICIifSBiZy13aGl0ZSBkYXJrOmJnLWdyYXktODAwIGJvcmRlci1ncmF5LTMwMCBkYXJrOmJvcmRlci1ncmF5LTYwMCB0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC1ncmF5LTEwMGB9CiAgICAgICAgICAgIC8+CiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC14cyB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMCI+CiAgICAgICAgICAgICAgSUQgaW50ZXJubyBkbyBwcm9kdXRvIChwcmVlbmNoaWRvIGF1dG9tYXRpY2FtZW50ZSBhbyBidXNjYXIgcG9yIEVBTikKICAgICAgICAgICAgPC9wPgogICAgICAgICAgPC9kaXY+CgogICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImdyaWQgZ2FwLTIiPgogICAgICAgICAgICA8TGFiZWwgaHRtbEZvcj0icHJvZHVjdE5hbWUiIGNsYXNzTmFtZT0idGV4dC1ncmF5LTkwMCBkYXJrOnRleHQtZ3JheS0xMDAiPgogICAgICAgICAgICAgIE5vbWUgZG8gUHJvZHV0byAqCiAgICAgICAgICAgIDwvTGFiZWw+CiAgICAgICAgICAgIDxJbnB1dAogICAgICAgICAgICAgIGlkPSJwcm9kdWN0TmFtZSIKICAgICAgICAgICAgICBuYW1lPSJwcm9kdWN0TmFtZSIKICAgICAgICAgICAgICBwbGFjZWhvbGRlcj0iRXg6IEZvbnRlIgogICAgICAgICAgICAgIHZhbHVlPXtwcm9kdWN0TmFtZX0KICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldFByb2R1Y3ROYW1lKGUudGFyZ2V0LnZhbHVlKX0KICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT0ib2ZmIgogICAgICAgICAgICAgIGNsYXNzTmFtZT17YCR7cHJvZHVjdEZvdW5kID8gImJvcmRlci1ncmVlbi01MDAgYmctZ3JlZW4tNTAgZGFyazpiZy1ncmVlbi05MDAvMjAiIDogIiJ9IGJnLXdoaXRlIGRhcms6YmctZ3JheS04MDAgYm9yZGVyLWdyYXktMzAwIGRhcms6Ym9yZGVyLWdyYXktNjAwIHRleHQtZ3JheS05MDAgZGFyazp0ZXh0LWdyYXktMTAwYH0KICAgICAgICAgICAgLz4KICAgICAgICAgICAge3Byb2R1Y3RGb3VuZCAmJiAoCiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJ0ZXh0LXhzIHRleHQtZ3JlZW4tNjAwIGRhcms6dGV4dC1ncmVlbi00MDAiPgogICAgICAgICAgICAgICAg4pyTIFByb2R1dG8gZW5jb250cmFkbyBhdXRvbWF0aWNhbWVudGUgbmEgYmFzZSBkZSBkYWRvcwogICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgKX0KICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgIHtkdXBsaWNhdGVMb2NhdGlvbiAmJiAoCiAgICAgICAgICAgIDxkaXYKICAgICAgICAgICAgICBjbGFzc05hbWU9ImJnLWFtYmVyLTUwIGRhcms6YmctYW1iZXItOTAwLzIwIGJvcmRlciBib3JkZXItYW1iZXItMjAwIGRhcms6Ym9yZGVyLWFtYmVyLTcwMCByb3VuZGVkLWxnIHAtMyBjdXJzb3ItcG9pbnRlciBob3ZlcjpiZy1hbWJlci0xMDAgZGFyazpob3ZlcjpiZy1hbWJlci05MDAvMzAgdHJhbnNpdGlvbi1jb2xvcnMiCiAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlRHVwbGljYXRlTG9jYXRpb25DbGlja30KICAgICAgICAgICAgPgogICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0yIj4KICAgICAgICAgICAgICAgIDxBbGVydFRyaWFuZ2xlIGNsYXNzTmFtZT0iaC00IHctNCB0ZXh0LWFtYmVyLTYwMCBkYXJrOnRleHQtYW1iZXItNDAwIG10LTAuNSBmbGV4LXNocmluay0wIiAvPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9InRleHQteHMgdGV4dC1hbWJlci04MDAgZGFyazp0ZXh0LWFtYmVyLTIwMCBmbGV4LTEiPgogICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9ImZvbnQtbWVkaXVtIG1iLTEgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEiPgogICAgICAgICAgICAgICAgICAgIDxNYXBQaW4gY2xhc3NOYW1lPSJoLTMgdy0zIiAvPgogICAgICAgICAgICAgICAgICAgIEVBTiBqw6EgcG9zc3VpIGVuZGVyZcOnYW1lbnRvCiAgICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJtYi0xIj4KICAgICAgICAgICAgICAgICAgICA8c3Ryb25nPkxvY2FsaXphw6fDo286PC9zdHJvbmc+IHtkdXBsaWNhdGVMb2NhdGlvbi5hZGRyZXNzfQogICAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ibWItMSB0ZXh0LWFtYmVyLTcwMCBkYXJrOnRleHQtYW1iZXItMzAwIj4KICAgICAgICAgICAgICAgICAgICA8c3Ryb25nPkdhbHDDo286PC9zdHJvbmc+IHtkdXBsaWNhdGVMb2NhdGlvbi53YXJlaG91c2VOYW1lfQogICAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1hbWJlci03MDAgZGFyazp0ZXh0LWFtYmVyLTMwMCBmb250LW1lZGl1bSI+CiAgICAgICAgICAgICAgICAgICAg8J+RhiBDbGlxdWUgYXF1aSBwYXJhIGlyIGF0w6kgYSBsb2NhbGl6YcOnw6NvIGRvIHByb2R1dG8KICAgICAgICAgICAgICAgICAgPC9wPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgKX0KCiAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e2hhbmRsZVN1Ym1pdH0gZGlzYWJsZWQ9e2lzUGVuZGluZyB8fCAhaWQudHJpbSgpIHx8ICFwcm9kdWN0TmFtZS50cmltKCl9IGNsYXNzTmFtZT0idy1mdWxsIj4KICAgICAgICAgICAge2lzUGVuZGluZyA/ICgKICAgICAgICAgICAgICA8PgogICAgICAgICAgICAgICAgPExvYWRlcjIgY2xhc3NOYW1lPSJoLTQgdy00IGFuaW1hdGUtc3BpbiBtci0yIiAvPgogICAgICAgICAgICAgICAgU2FsdmFuZG8uLi4KICAgICAgICAgICAgICA8Lz4KICAgICAgICAgICAgKSA6ICgKICAgICAgICAgICAgICAiU2FsdmFyIFByb2R1dG8iCiAgICAgICAgICAgICl9CiAgICAgICAgICA8L0J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CgogICAgICA8TG9hZGluZ092ZXJsYXkgaXNMb2FkaW5nPXtpc1NlYXJjaGluZyB8fCBpc1BlbmRpbmcgfHwgaXNDaGVja2luZ0R1cGxpY2F0ZX0gbWVzc2FnZT0iUHJvY2Vzc2FuZG8uLi4iIC8+CiAgICA8Lz4KICApCn0K"}