{"data":"InVzZSBjbGllbnQiCgppbXBvcnQgdHlwZSBSZWFjdCBmcm9tICJyZWFjdCIKCmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICJyZWFjdCIKaW1wb3J0IHsgdXNlQWN0aW9uU3RhdGUgfSBmcm9tICJyZWFjdCIKaW1wb3J0IHsgdXNlRm9ybVN0YXR1cyB9IGZyb20gInJlYWN0LWRvbSIKaW1wb3J0IHsgQ2FyZCwgQ2FyZENvbnRlbnQgfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvY2FyZCIKaW1wb3J0IHsKICBBbGVydERpYWxvZywKICBBbGVydERpYWxvZ0FjdGlvbiwKICBBbGVydERpYWxvZ0NhbmNlbCwKICBBbGVydERpYWxvZ0NvbnRlbnQsCiAgQWxlcnREaWFsb2dEZXNjcmlwdGlvbiwKICBBbGVydERpYWxvZ0Zvb3RlciwKICBBbGVydERpYWxvZ0hlYWRlciwKICBBbGVydERpYWxvZ1RpdGxlLAogIEFsZXJ0RGlhbG9nVHJpZ2dlciwKfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvYWxlcnQtZGlhbG9nIgppbXBvcnQgeyBEaWFsb2csIERpYWxvZ0NvbnRlbnQsIERpYWxvZ0Rlc2NyaXB0aW9uLCBEaWFsb2dIZWFkZXIsIERpYWxvZ1RpdGxlIH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL2RpYWxvZyIKaW1wb3J0IHsgQXNzaWduUHJvZHVjdFRvU2hlbGZGb3JtRW5oYW5jZWQgfSBmcm9tICIuL2Fzc2lnbi1wcm9kdWN0LXRvLXNoZWxmLWZvcm0tZW5oYW5jZWQiCmltcG9ydCB7IEFkZFByb2R1Y3RUb1NoZWxmQnV0dG9uIH0gZnJvbSAiLi9hZGQtcHJvZHVjdC10by1zaGVsZi1idXR0b24iCmltcG9ydCB7IFByb2R1Y3RMaXN0TW9kYWwgfSBmcm9tICIuL3Byb2R1Y3QtbGlzdC1tb2RhbCIKaW1wb3J0IHsgY24gfSBmcm9tICJAL2xpYi91dGlscyIKaW1wb3J0IHsgWCwgQ2hlY2tDaXJjbGUyLCBBbGVydENpcmNsZSwgTG9hZGVyMiwgUGFja2FnZSB9IGZyb20gImx1Y2lkZS1yZWFjdCIKaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL2J1dHRvbiIKaW1wb3J0IHsgQ2hlY2tib3ggfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvY2hlY2tib3giCmltcG9ydCB7IHZlcmlmeVNoZWxmQWN0aW9uLCB1bmFzc2lnblByb2R1Y3RGcm9tU2hlbGYsIHJlbW92ZUluZGl2aWR1YWxQcm9kdWN0RnJvbVNoZWxmIH0gZnJvbSAiQC9hcHAvYWN0aW9ucyIKaW1wb3J0IHsgdG9hc3QgfSBmcm9tICJAL2hvb2tzL3VzZS10b2FzdCIKaW1wb3J0IHsgdXNlUm91dGVyLCB1c2VTZWFyY2hQYXJhbXMgfSBmcm9tICJuZXh0L25hdmlnYXRpb24iCgppbnRlcmZhY2UgU2hlbGZJdGVtUHJvcHMgewogIGlkOiBzdHJpbmcKICBwb3NpdGlvbjogbnVtYmVyCiAgbGV2ZWw6IG51bWJlcgogIGVhbjogc3RyaW5nIHwgbnVsbAogIHByb2R1Y3ROYW1lOiBzdHJpbmcgfCBudWxsCiAgb2NjdXBhbmN5UGVyY2VudGFnZTogbnVtYmVyCiAgbGFzdFZlcmlmaWVkOiBEYXRlIHwgbnVsbAogIGlzRHVwbGljYXRlZEVBTjogYm9vbGVhbgogIG9uQXNzaWduUHJvZHVjdDogKCkgPT4gdm9pZAogIGlzU2VsZWN0ZWQ/OiBib29sZWFuCiAgb25TZWxlY3Rpb25DaGFuZ2U/OiAoaWQ6IHN0cmluZywgc2VsZWN0ZWQ6IGJvb2xlYW4pID0+IHZvaWQKICBpc0hpZ2hsaWdodGVkPzogYm9vbGVhbgogIHdhcmVob3VzZU5hbWU/OiBzdHJpbmcKICBhaXNsZU5hbWU/OiBzdHJpbmcKfQoKZnVuY3Rpb24gZm9ybWF0RUFOc0ZvckRpc3BsYXkoZWFuU3RyaW5nOiBzdHJpbmcgfCBudWxsKTogc3RyaW5nIHsKICBpZiAoIWVhblN0cmluZyB8fCBlYW5TdHJpbmcudHJpbSgpID09PSAiIikgcmV0dXJuICIiCgogIGNvbnN0IGVhbnMgPSBlYW5TdHJpbmcKICAgIC5zcGxpdCgiOyIpCiAgICAubWFwKChlYW4pID0+IGVhbi50cmltKCkpCiAgICAuZmlsdGVyKChlYW4pID0+IGVhbi5sZW5ndGggPiAwKQoKICBpZiAoZWFucy5sZW5ndGggPT09IDEpIHsKICAgIHJldHVybiBlYW5zWzBdCiAgfSBlbHNlIGlmIChlYW5zLmxlbmd0aCA8PSAyKSB7CiAgICByZXR1cm4gZWFucy5qb2luKCI7ICIpCiAgfSBlbHNlIHsKICAgIHJldHVybiBgJHtlYW5zWzBdfTsgJHtlYW5zWzFdfSArJHtlYW5zLmxlbmd0aCAtIDJ9YAogIH0KfQoKZnVuY3Rpb24gY291bnRFQU5zKGVhblN0cmluZzogc3RyaW5nIHwgbnVsbCk6IG51bWJlciB7CiAgaWYgKCFlYW5TdHJpbmcgfHwgZWFuU3RyaW5nLnRyaW0oKSA9PT0gIiIpIHJldHVybiAwCiAgcmV0dXJuIGVhblN0cmluZwogICAgLnNwbGl0KCI7IikKICAgIC5tYXAoKGVhbikgPT4gZWFuLnRyaW0oKSkKICAgIC5maWx0ZXIoKGVhbikgPT4gZWFuLmxlbmd0aCA+IDApLmxlbmd0aAp9CgpmdW5jdGlvbiBVbmFzc2lnbkJ1dHRvbih7CiAgc2hlbGZJZCwKICBwb3NpdGlvbiwKICBsZXZlbCwKICBoYXNQcm9kdWN0LAogIG9uT3B0aW1pc3RpY1VwZGF0ZSwKfTogewogIHNoZWxmSWQ6IHN0cmluZwogIHBvc2l0aW9uOiBudW1iZXIKICBsZXZlbDogbnVtYmVyCiAgaGFzUHJvZHVjdDogYm9vbGVhbgogIG9uT3B0aW1pc3RpY1VwZGF0ZTogKCkgPT4gdm9pZAp9KSB7CiAgY29uc3QgW2lzT3Blbiwgc2V0SXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKQogIGNvbnN0IFtpc1JlbW92aW5nLCBzZXRJc1JlbW92aW5nXSA9IHVzZVN0YXRlKGZhbHNlKQogIGNvbnN0IFtzdGF0ZSwgZm9ybUFjdGlvbl0gPSB1c2VBY3Rpb25TdGF0ZSh1bmFzc2lnblByb2R1Y3RGcm9tU2hlbGYuYmluZChudWxsLCBzaGVsZklkKSwgewogICAgbWVzc2FnZTogIiIsCiAgICBzdWNjZXNzOiBmYWxzZSwKICB9KQogIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpCiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gdXNlU2VhcmNoUGFyYW1zKCkKCiAgdXNlRWZmZWN0KCgpID0+IHsKICAgIGlmIChzdGF0ZS5tZXNzYWdlKSB7CiAgICAgIHNldElzUmVtb3ZpbmcoZmFsc2UpCiAgICAgIHRvYXN0KHsKICAgICAgICB0aXRsZTogc3RhdGUubWVzc2FnZSwKICAgICAgICB2YXJpYW50OiBzdGF0ZS5zdWNjZXNzID8gImRlZmF1bHQiIDogImRlc3RydWN0aXZlIiwKICAgICAgfSkKICAgICAgaWYgKHN0YXRlLnN1Y2Nlc3MpIHsKICAgICAgICBzZXRJc09wZW4oZmFsc2UpCiAgICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhzZWFyY2hQYXJhbXMudG9TdHJpbmcoKSkKICAgICAgICBwYXJhbXMuc2V0KCJoaWdobGlnaHQiLCBzaGVsZklkKQogICAgICAgIHBhcmFtcy5zZXQoInR5cGUiLCAic2hlbGYiKQogICAgICAgIGNvbnN0IG5ld1VybCA9IGAke3dpbmRvdy5sb2NhdGlvbi5wYXRobmFtZX0/JHtwYXJhbXMudG9TdHJpbmcoKX1gCiAgICAgICAgcm91dGVyLnJlcGxhY2UobmV3VXJsLCB7IHNjcm9sbDogZmFsc2UgfSkKICAgICAgICByb3V0ZXIucmVmcmVzaCgpCiAgICAgIH0KICAgIH0KICB9LCBbc3RhdGVdKQoKICBjb25zdCBoYW5kbGVVbmFzc2lnbkNsaWNrID0gKGU6IFJlYWN0Lk1vdXNlRXZlbnQpID0+IHsKICAgIGUucHJldmVudERlZmF1bHQoKQogICAgZS5zdG9wUHJvcGFnYXRpb24oKQogICAgc2V0SXNPcGVuKHRydWUpCiAgfQoKICBjb25zdCBoYW5kbGVDb25maXJtUmVtb3ZlID0gYXN5bmMgKGU6IFJlYWN0Lk1vdXNlRXZlbnQpID0+IHsKICAgIGUucHJldmVudERlZmF1bHQoKQogICAgZS5zdG9wUHJvcGFnYXRpb24oKQogICAgc2V0SXNSZW1vdmluZyh0cnVlKQogICAgc2V0SXNPcGVuKGZhbHNlKQoKICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCkKICAgIGF3YWl0IGZvcm1BY3Rpb24oZm9ybURhdGEpCiAgfQoKICBpZiAoIWhhc1Byb2R1Y3QpIHsKICAgIHJldHVybiBudWxsCiAgfQoKICByZXR1cm4gKAogICAgPEFsZXJ0RGlhbG9nIG9wZW49e2lzT3Blbn0gb25PcGVuQ2hhbmdlPXtzZXRJc09wZW59PgogICAgICA8QWxlcnREaWFsb2dUcmlnZ2VyIGFzQ2hpbGQ+CiAgICAgICAgPEJ1dHRvbgogICAgICAgICAgdmFyaWFudD0iZ2hvc3QiCiAgICAgICAgICBzaXplPSJpY29uIgogICAgICAgICAgY2xhc3NOYW1lPSJhYnNvbHV0ZSB0b3AtMC41IHJpZ2h0LTAuNSBoLTQgdy00IHAtMCB0ZXh0LWdyYXktNDAwIGhvdmVyOnRleHQtcmVkLTUwMCBkYXJrOnRleHQtZ3JheS01MDAgZGFyazpob3Zlcjp0ZXh0LXJlZC00MDAgei0yMCB0cmFuc2l0aW9uLWNvbG9ycyBkdXJhdGlvbi0yMDAgcm91bmRlZC1tZCIKICAgICAgICAgIGFyaWEtbGFiZWw9IkxpbXBhciBBbmRhciIKICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVVuYXNzaWduQ2xpY2t9CiAgICAgICAgICBkaXNhYmxlZD17aXNSZW1vdmluZ30KICAgICAgICA+CiAgICAgICAgICB7aXNSZW1vdmluZyA/IDxMb2FkZXIyIGNsYXNzTmFtZT0iaC0yLjUgdy0yLjUgYW5pbWF0ZS1zcGluIiAvPiA6IDxYIGNsYXNzTmFtZT0iaC0yLjUgdy0yLjUiIC8+fQogICAgICAgIDwvQnV0dG9uPgogICAgICA8L0FsZXJ0RGlhbG9nVHJpZ2dlcj4KICAgICAgPEFsZXJ0RGlhbG9nQ29udGVudCBjbGFzc05hbWU9ImJnLXdoaXRlIGRhcms6YmctZ3JheS05MDAgYm9yZGVyLWdyYXktMjAwIGRhcms6Ym9yZGVyLWdyYXktNzAwIHJvdW5kZWQteGwiPgogICAgICAgIDxBbGVydERpYWxvZ0hlYWRlcj4KICAgICAgICAgIDxBbGVydERpYWxvZ1RpdGxlIGNsYXNzTmFtZT0idGV4dC1ncmF5LTkwMCBkYXJrOnRleHQtZ3JheS0xMDAiPgogICAgICAgICAgICBMaW1wYXIgQW5kYXIge2xldmVsfSBkYSBQcmF0ZWxlaXJhIHtwb3NpdGlvbn0KICAgICAgICAgIDwvQWxlcnREaWFsb2dUaXRsZT4KICAgICAgICAgIDxBbGVydERpYWxvZ0Rlc2NyaXB0aW9uIGNsYXNzTmFtZT0idGV4dC1ncmF5LTYwMCBkYXJrOnRleHQtZ3JheS0zMDAiPgogICAgICAgICAgICBFc3RhIGHDp8OjbyBpcsOhIHJlbW92ZXIgdG9kb3Mgb3MgcHJvZHV0b3MgZGVzdGUgYW5kYXIgZGEgcHJhdGVsZWlyYSwgZGVpeGFuZG8tbyB2YXppby4gQSBwcmF0ZWxlaXJhCiAgICAgICAgICAgIHBlcm1hbmVjZXLDoSBuYSBydWEuCiAgICAgICAgICA8L0FsZXJ0RGlhbG9nRGVzY3JpcHRpb24+CiAgICAgICAgPC9BbGVydERpYWxvZ0hlYWRlcj4KICAgICAgICA8QWxlcnREaWFsb2dGb290ZXI+CiAgICAgICAgICA8QWxlcnREaWFsb2dDYW5jZWwKICAgICAgICAgICAgZGlzYWJsZWQ9e2lzUmVtb3Zpbmd9CiAgICAgICAgICAgIGNsYXNzTmFtZT0iYmctZ3JheS0xMDAgZGFyazpiZy1ncmF5LTgwMCB0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC1ncmF5LTEwMCBib3JkZXItZ3JheS0zMDAgZGFyazpib3JkZXItZ3JheS02MDAgaG92ZXI6YmctZ3JheS0yMDAgZGFyazpob3ZlcjpiZy1ncmF5LTcwMCByb3VuZGVkLWxnIgogICAgICAgICAgPgogICAgICAgICAgICBDYW5jZWxhcgogICAgICAgICAgPC9BbGVydERpYWxvZ0NhbmNlbD4KICAgICAgICAgIDxBbGVydERpYWxvZ0FjdGlvbiBhc0NoaWxkPgogICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9ImRlc3RydWN0aXZlIiBvbkNsaWNrPXtoYW5kbGVDb25maXJtUmVtb3ZlfSBkaXNhYmxlZD17aXNSZW1vdmluZ30gY2xhc3NOYW1lPSJyb3VuZGVkLWxnIj4KICAgICAgICAgICAgICB7aXNSZW1vdmluZyA/ICgKICAgICAgICAgICAgICAgIDw+CiAgICAgICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT0iaC00IHctNCBhbmltYXRlLXNwaW4gbXItMiIgLz4KICAgICAgICAgICAgICAgICAgTGltcGFuZG8uLi4KICAgICAgICAgICAgICAgIDwvPgogICAgICAgICAgICAgICkgOiAoCiAgICAgICAgICAgICAgICAiTGltcGFyIEFuZGFyIgogICAgICAgICAgICAgICl9CiAgICAgICAgICAgIDwvQnV0dG9uPgogICAgICAgICAgPC9BbGVydERpYWxvZ0FjdGlvbj4KICAgICAgICA8L0FsZXJ0RGlhbG9nRm9vdGVyPgogICAgICA8L0FsZXJ0RGlhbG9nQ29udGVudD4KICAgIDwvQWxlcnREaWFsb2c+CiAgKQp9CgpmdW5jdGlvbiBWZXJpZnlCdXR0b24oeyBzaGVsZklkIH06IHsgc2hlbGZJZDogc3RyaW5nIH0pIHsKICBjb25zdCBbc3RhdGUsIGZvcm1BY3Rpb25dID0gdXNlQWN0aW9uU3RhdGUodmVyaWZ5U2hlbGZBY3Rpb24uYmluZChudWxsLCBzaGVsZklkKSwgeyBtZXNzYWdlOiAiIiwgc3VjY2VzczogZmFsc2UgfSkKICBjb25zdCB7IHBlbmRpbmcgfSA9IHVzZUZvcm1TdGF0dXMoKQogIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpCiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gdXNlU2VhcmNoUGFyYW1zKCkKCiAgdXNlRWZmZWN0KCgpID0+IHsKICAgIGlmIChzdGF0ZS5tZXNzYWdlKSB7CiAgICAgIHRvYXN0KHsKICAgICAgICB0aXRsZTogc3RhdGUubWVzc2FnZSwKICAgICAgICB2YXJpYW50OiBzdGF0ZS5zdWNjZXNzID8gImRlZmF1bHQiIDogImRlc3RydWN0aXZlIiwKICAgICAgfSkKICAgICAgaWYgKHN0YXRlLnN1Y2Nlc3MpIHsKICAgICAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHNlYXJjaFBhcmFtcy50b1N0cmluZygpKQogICAgICAgIHBhcmFtcy5zZXQoImhpZ2hsaWdodCIsIHNoZWxmSWQpCiAgICAgICAgcGFyYW1zLnNldCgidHlwZSIsICJzaGVsZiIpCiAgICAgICAgY29uc3QgbmV3VXJsID0gYCR7d2luZG93LmxvY2F0aW9uLnBhdGhuYW1lfT8ke3BhcmFtcy50b1N0cmluZygpfWAKICAgICAgICByb3V0ZXIucmVwbGFjZShuZXdVcmwsIHsgc2Nyb2xsOiBmYWxzZSB9KQogICAgICAgIHJvdXRlci5yZWZyZXNoKCkKICAgICAgfQogICAgfQogIH0sIFtzdGF0ZV0pCgogIHJldHVybiAoCiAgICA8Zm9ybSBhY3Rpb249e2Zvcm1BY3Rpb259IGNsYXNzTmFtZT0idy1mdWxsIj4KICAgICAgPEJ1dHRvbgogICAgICAgIHR5cGU9InN1Ym1pdCIKICAgICAgICB2YXJpYW50PSJvdXRsaW5lIgogICAgICAgIHNpemU9InNtIgogICAgICAgIGFyaWEtZGlzYWJsZWQ9e3BlbmRpbmd9CiAgICAgICAgY2xhc3NOYW1lPSJ3LWZ1bGwgbXQtMiB0ZXh0LXhzIGgtNyB0cmFuc2l0aW9uLWNvbG9ycyBkdXJhdGlvbi0yMDAgYmctdHJhbnNwYXJlbnQgYm9yZGVyLWdyYXktMzAwIGRhcms6Ym9yZGVyLWdyYXktNjAwIHRleHQtZ3JheS03MDAgZGFyazp0ZXh0LWdyYXktMjAwIGhvdmVyOmJnLWdyYXktMTAwIGRhcms6aG92ZXI6YmctZ3JheS04MDAgcm91bmRlZC1sZyIKICAgICAgPgogICAgICAgIHtwZW5kaW5nID8gKAogICAgICAgICAgPD4KICAgICAgICAgICAgPExvYWRlcjIgY2xhc3NOYW1lPSJoLTMgdy0zIGFuaW1hdGUtc3BpbiBtci0yIiAvPgogICAgICAgICAgICBWZXJpZmljYW5kby4uLgogICAgICAgICAgPC8+CiAgICAgICAgKSA6ICgKICAgICAgICAgICJWZXJpZmljYXIgQWdvcmEiCiAgICAgICAgKX0KICAgICAgPC9CdXR0b24+CiAgICA8L2Zvcm0+CiAgKQp9CgpleHBvcnQgZnVuY3Rpb24gU2hlbGZJdGVtKHsKICBpZCwKICBwb3NpdGlvbiwKICBsZXZlbCwKICBlYW4sCiAgcHJvZHVjdE5hbWUsCiAgb2NjdXBhbmN5UGVyY2VudGFnZSwKICBsYXN0VmVyaWZpZWQsCiAgaXNEdXBsaWNhdGVkRUFOLAogIG9uQXNzaWduUHJvZHVjdCwKICBpc1NlbGVjdGVkID0gZmFsc2UsCiAgb25TZWxlY3Rpb25DaGFuZ2UsCiAgaXNIaWdobGlnaHRlZCA9IGZhbHNlLAogIHdhcmVob3VzZU5hbWUgPSAiR2FscMOjbyIsCiAgYWlzbGVOYW1lID0gIlIxIiwKfTogU2hlbGZJdGVtUHJvcHMpIHsKICBjb25zdCBbaXNQcm9kdWN0TGlzdE9wZW4sIHNldElzUHJvZHVjdExpc3RPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKQogIGNvbnN0IFtpc0Fzc2lnbkRpYWxvZ09wZW4sIHNldElzQXNzaWduRGlhbG9nT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSkKICBjb25zdCBbb3B0aW1pc3RpY1N0YXRlLCBzZXRPcHRpbWlzdGljU3RhdGVdID0gdXNlU3RhdGUoewogICAgZWFuOiBlYW4sCiAgICBwcm9kdWN0TmFtZTogcHJvZHVjdE5hbWUsCiAgICBsYXN0VmVyaWZpZWQ6IGxhc3RWZXJpZmllZCwKICB9KQogIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpCiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gdXNlU2VhcmNoUGFyYW1zKCkKCiAgY29uc3QgaXNIaWdobGlnaHRlZEVycm9yID0gb3B0aW1pc3RpY1N0YXRlLmVhbiAmJiBvcHRpbWlzdGljU3RhdGUuZWFuLnN0YXJ0c1dpdGgoIkVSUk9SIikKCiAgY29uc3QgVEhSRVNIT0xEX0RBWVMgPSAzMAogIGNvbnN0IG5lZWRzVmVyaWZpY2F0aW9uID0gZmFsc2UKCiAgY29uc3QgaGFuZGxlUmVtb3ZlU2VsZWN0ZWRQcm9kdWN0cyA9IGFzeW5jIChzZWxlY3RlZEVhbnM6IHN0cmluZ1tdKSA9PiB7CiAgICBpZiAoIW9wdGltaXN0aWNTdGF0ZS5lYW4gfHwgIW9wdGltaXN0aWNTdGF0ZS5wcm9kdWN0TmFtZSkgcmV0dXJuCgogICAgdHJ5IHsKICAgICAgZm9yIChjb25zdCBlYW5Ub1JlbW92ZSBvZiBzZWxlY3RlZEVhbnMpIHsKICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgICAgY29uc3QgcmVtb3ZlQWN0aW9uID0gcmVtb3ZlSW5kaXZpZHVhbFByb2R1Y3RGcm9tU2hlbGYuYmluZChudWxsLCBpZCwgZWFuVG9SZW1vdmUpCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVtb3ZlQWN0aW9uKHsgbWVzc2FnZTogIiIsIHN1Y2Nlc3M6IGZhbHNlIH0sIGZvcm1EYXRhKQoKICAgICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7CiAgICAgICAgICB0b2FzdCh7CiAgICAgICAgICAgIHRpdGxlOiBgRXJybyBhbyByZW1vdmVyIHByb2R1dG8gJHtlYW5Ub1JlbW92ZX06ICR7cmVzdWx0Lm1lc3NhZ2V9YCwKICAgICAgICAgICAgdmFyaWFudDogImRlc3RydWN0aXZlIiwKICAgICAgICAgIH0pCiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IGN1cnJlbnRFYW5zID0gb3B0aW1pc3RpY1N0YXRlLmVhbi5zcGxpdCgiOyIpLm1hcCgoZWFuKSA9PiBlYW4udHJpbSgpKQogICAgICBjb25zdCBjdXJyZW50TmFtZXMgPSBvcHRpbWlzdGljU3RhdGUucHJvZHVjdE5hbWUuc3BsaXQoIjsiKS5tYXAoKG5hbWUpID0+IG5hbWUudHJpbSgpKQoKICAgICAgY29uc3QgcmVtYWluaW5nRWFuczogc3RyaW5nW10gPSBbXQogICAgICBjb25zdCByZW1haW5pbmdOYW1lczogc3RyaW5nW10gPSBbXQoKICAgICAgY3VycmVudEVhbnMuZm9yRWFjaCgoZWFuLCBpbmRleCkgPT4gewogICAgICAgIGlmICghc2VsZWN0ZWRFYW5zLmluY2x1ZGVzKGVhbikpIHsKICAgICAgICAgIHJlbWFpbmluZ0VhbnMucHVzaChlYW4pCiAgICAgICAgICByZW1haW5pbmdOYW1lcy5wdXNoKGN1cnJlbnROYW1lc1tpbmRleF0gfHwgIiIpCiAgICAgICAgfQogICAgICB9KQoKICAgICAgc2V0T3B0aW1pc3RpY1N0YXRlKHsKICAgICAgICBlYW46IHJlbWFpbmluZ0VhbnMubGVuZ3RoID4gMCA/IHJlbWFpbmluZ0VhbnMuam9pbigiOyAiKSA6IG51bGwsCiAgICAgICAgcHJvZHVjdE5hbWU6IHJlbWFpbmluZ05hbWVzLmxlbmd0aCA+IDAgPyByZW1haW5pbmdOYW1lcy5qb2luKCI7ICIpIDogbnVsbCwKICAgICAgICBsYXN0VmVyaWZpZWQ6IG5ldyBEYXRlKCksCiAgICAgIH0pCgogICAgICBzZXRJc1Byb2R1Y3RMaXN0T3BlbihmYWxzZSkKCiAgICAgIHRvYXN0KHsKICAgICAgICB0aXRsZTogYCR7c2VsZWN0ZWRFYW5zLmxlbmd0aH0gcHJvZHV0byhzKSByZW1vdmlkbyhzKSBkbyBhbmRhciAke2xldmVsfWAsCiAgICAgICAgdmFyaWFudDogImRlZmF1bHQiLAogICAgICB9KQoKICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKQogICAgICBwYXJhbXMuc2V0KCJoaWdobGlnaHQiLCBpZCkKICAgICAgcGFyYW1zLnNldCgidHlwZSIsICJzaGVsZiIpCiAgICAgIGNvbnN0IG5ld1VybCA9IGAke3dpbmRvdy5sb2NhdGlvbi5wYXRobmFtZX0/JHtwYXJhbXMudG9TdHJpbmcoKX1gCiAgICAgIGNvbnN0IHJvdXRlck5hdiA9IHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gdW5kZWZpbmVkIDogdW5kZWZpbmVkCiAgICAgIC8vIE5hdmlnYXRpb24gb24gY2xpZW50CiAgICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCAiIiwgbmV3VXJsKQogICAgICAvLyBUcmlnZ2VyIHJlZnJlc2ggdmlhIHJvdXRlciBpZiBhdmFpbGFibGUKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByb3V0ZXIgPSAocmVxdWlyZSgibmV4dC9uYXZpZ2F0aW9uIikgYXMgYW55KS51c2VSb3V0ZXI/LigpIHx8IG51bGwKICAgICAgICByb3V0ZXI/LnJlcGxhY2UobmV3VXJsLCB7IHNjcm9sbDogZmFsc2UgfSkKICAgICAgICByb3V0ZXI/LnJlZnJlc2goKQogICAgICB9IGNhdGNoIHt9CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjb25zb2xlLmVycm9yKCJFcnJvIGFvIHJlbW92ZXIgcHJvZHV0b3M6IiwgZXJyb3IpCiAgICAgIHRvYXN0KHsKICAgICAgICB0aXRsZTogIkVycm8gYW8gcmVtb3ZlciBwcm9kdXRvcyIsCiAgICAgICAgdmFyaWFudDogImRlc3RydWN0aXZlIiwKICAgICAgfSkKICAgIH0KICB9CgogIGNvbnN0IGhhbmRsZVByaW50U2VsZWN0ZWRQcm9kdWN0cyA9IChzZWxlY3RlZEVhbnM6IHN0cmluZ1tdLCBzZWxlY3RlZFByb2R1Y3RzOiBhbnlbXSkgPT4gewogICAgY29uc3QgZXh0cmFjdFdhcmVob3VzZU51bWJlciA9ICh3YXJlaG91c2VOYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT4gewogICAgICBjb25zdCBwYXR0ZXJucyA9IFsvR2FscMOjb1xzKihcZCspL2ksIC9BKFxkKykvaSwgLyhcZCspL10KCiAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBwYXR0ZXJucykgewogICAgICAgIGNvbnN0IG1hdGNoID0gd2FyZWhvdXNlTmFtZS5tYXRjaChwYXR0ZXJuKQogICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkgewogICAgICAgICAgcmV0dXJuIG1hdGNoWzFdCiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gIjEiCiAgICB9CgogICAgY29uc3QgbGFiZWxzRGF0YSA9IHNlbGVjdGVkUHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4gKHsKICAgICAgaWQ6IGAke2lkfS0ke3Byb2R1Y3QuZWFufWAsCiAgICAgIHR5cGU6ICJzaGVsZiIgYXMgY29uc3QsCiAgICAgIHdhcmVob3VzZU5hbWU6IHdhcmVob3VzZU5hbWUsCiAgICAgIGFpc2xlTmFtZTogYWlzbGVOYW1lLAogICAgICBwb3NpdGlvbjogcG9zaXRpb24sCiAgICAgIGxldmVsOiBsZXZlbCwKICAgICAgZWFuOiBwcm9kdWN0LmVhbiwKICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSwKICAgIH0pKQoKICAgIGNvbnN0IHByaW50Q29udGVudCA9IGAKICAgICAgPCFET0NUWVBFIGh0bWw+CiAgICAgIDxodG1sPgogICAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkV0aXF1ZXRhcyBkZSBQcm9kdXRvcyBTZWxlY2lvbmFkb3M8L3RpdGxlPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICogeyBtYXJnaW46IDA7IHBhZGRpbmc6IDA7IGJveC1zaXppbmc6IGJvcmRlci1ib3g7IH0KICAgICAgICAgIGJvZHkgeyBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IG1hcmdpbjogMDsgcGFkZGluZzogMDsgfQogICAgICAgICAgLmxhYmVsLXBhZ2UgeyAKICAgICAgICAgICAgd2lkdGg6IDEwMG1tOyAKICAgICAgICAgICAgaGVpZ2h0OiA1MG1tOyAKICAgICAgICAgICAgbWFyZ2luOiAwOyAKICAgICAgICAgICAgcGFkZGluZzogMDsgCiAgICAgICAgICAgIHBhZ2UtYnJlYWstYWZ0ZXI6IGFsd2F5czsgCiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IAogICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsgCiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgICAgIH0KICAgICAgICAgIC5sYWJlbC1wYWdlOmxhc3QtY2hpbGQgeyBwYWdlLWJyZWFrLWFmdGVyOiBhdm9pZDsgfQogICAgICAgICAgLmxhYmVsLWxvY2F0aW9uIHsgCiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgdG9wOiAzbW07CiAgICAgICAgICAgIGxlZnQ6IDUwJTsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOwogICAgICAgICAgICBmb250LXNpemU6IDE0cHQ7IAogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsgCiAgICAgICAgICAgIGNvbG9yOiAjMzc0MTUxOyAKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuMjsgCiAgICAgICAgICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsgCiAgICAgICAgICAgIG1heC13aWR0aDogOTUlOyAKICAgICAgICAgIH0KICAgICAgICAgIC5sYWJlbC1lYW4geyAKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICB0b3A6IDUwJTsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsKICAgICAgICAgICAgZm9udC1zaXplOiA4MHB4OyAKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7IAogICAgICAgICAgICBjb2xvcjogIzAwMDsgCiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxOyAKICAgICAgICAgICAgd29yZC13cmFwOiBicmVhay13b3JkOyAKICAgICAgICAgICAgbWF4LXdpZHRoOiA5NSU7IAogICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICB9CiAgICAgICAgICAubGFiZWwtcHJvZHVjdCB7IAogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIGJvdHRvbTogM21tOwogICAgICAgICAgICBsZWZ0OiA1MCU7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgICAgICAgICAgZm9udC1zaXplOiA4cHQ7IAogICAgICAgICAgICBmb250LXdlaWdodDogbm9ybWFsOyAKICAgICAgICAgICAgY29sb3I6ICM2QjcyODA7IAogICAgICAgICAgICBtYXgtd2lkdGg6IDg1bW07IAogICAgICAgICAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7IAogICAgICAgICAgICBsaW5lLWhlaWdodDogMS4yOyAKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsKICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgICAgIH0KICAgICAgICAgIEBtZWRpYSBwcmludCB7IAogICAgICAgICAgICBib2R5IHsgbWFyZ2luOiAwOyB9IAogICAgICAgICAgICAubGFiZWwtcGFnZSB7IG1hcmdpbjogMDsgfSAKICAgICAgICAgIH0KICAgICAgICA8L3N0eWxlPgogICAgICA8L2hlYWQ+CiAgICAgIDxib2R5PgogICAgICAgICR7bGFiZWxzRGF0YQogICAgICAgICAgLm1hcCgobGFiZWwpID0+IHsKICAgICAgICAgICAgY29uc3Qgd2FyZWhvdXNlTnVtYmVyID0gZXh0cmFjdFdhcmVob3VzZU51bWJlcihsYWJlbC53YXJlaG91c2VOYW1lKQogICAgICAgICAgICBjb25zdCBhaXNsZU51bWJlciA9IGxhYmVsLmFpc2xlTmFtZS5yZXBsYWNlKC9cRC9nLCAiIikgfHwgbGFiZWwuYWlzbGVOYW1lCgogICAgICAgICAgICByZXR1cm4gYAogICAgICAgICAgPGRpdiBjbGFzcz0ibGFiZWwtcGFnZSI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxhYmVsLWxvY2F0aW9uIj4KICAgICAgICAgICAgICBBJHt3YXJlaG91c2VOdW1iZXJ9PlIke2Fpc2xlTnVtYmVyfT5QJHtsYWJlbC5wb3NpdGlvbn0+QSR7bGFiZWwubGV2ZWx9CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJsYWJlbC1lYW4iPiR7bGFiZWwuZWFufTwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJsYWJlbC1wcm9kdWN0Ij4ke2xhYmVsLnByb2R1Y3ROYW1lLmxlbmd0aCA+IDUwID8gbGFiZWwucHJvZHVjdE5hbWUuc3Vic3RyaW5nKDAsIDUwKSArICIuLi4iIDogbGFiZWwucHJvZHVjdE5hbWV9PC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICBgCiAgICAgICAgICB9KQogICAgICAgICAgLmpvaW4oIiIpfQogICAgICA8L2JvZHk+CiAgICAgIDwvaHRtbD4KICAgIGAKCiAgICBjb25zdCBwcmludFdpbmRvdyA9IHdpbmRvdy5vcGVuKCIiLCAiX2JsYW5rIiwgIndpZHRoPTgwMCxoZWlnaHQ9NjAwIikKICAgIGlmIChwcmludFdpbmRvdykgewogICAgICBwcmludFdpbmRvdy5kb2N1bWVudC53cml0ZShwcmludENvbnRlbnQpCiAgICAgIHByaW50V2luZG93LmRvY3VtZW50LmNsb3NlKCkKICAgICAgcHJpbnRXaW5kb3cub25sb2FkID0gKCkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcHJpbnRXaW5kb3cucHJpbnQoKQogICAgICAgICAgcHJpbnRXaW5kb3cuY2xvc2UoKQogICAgICAgIH0sIDUwMCkKICAgICAgfQogICAgfQoKICAgIHNldElzUHJvZHVjdExpc3RPcGVuKGZhbHNlKQogIH0KCiAgY29uc3QgaGFuZGxlQ2FyZENsaWNrID0gKGU6IFJlYWN0Lk1vdXNlRXZlbnQpID0+IHsKICAgIGNvbnNvbGUubG9nKGBDYXJkIGNsaWNrZWQgLSBBbmRhciBJRDogJHtpZH0sIFBvc2nDp8OjbzogJHtwb3NpdGlvbn0sIE7DrXZlbDogJHtsZXZlbH1gKQoKICAgIGUucHJldmVudERlZmF1bHQoKQogICAgZS5zdG9wUHJvcGFnYXRpb24oKQoKICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0IGFzIEhUTUxFbGVtZW50CiAgICBpZiAoCiAgICAgIHRhcmdldC5jbG9zZXN0KCdidXR0b25bYXJpYS1sYWJlbD0iTGltcGFyIEFuZGFyIl0nKSB8fAogICAgICB0YXJnZXQuY2xvc2VzdCgnYnV0dG9uW3RpdGxlPSJBZGljaW9uYXIgUHJvZHV0byJdJykgfHwKICAgICAgdGFyZ2V0LmNsb3Nlc3QoJ1tyb2xlPSJjaGVja2JveCJdJykgfHwKICAgICAgdGFyZ2V0LmNsb3Nlc3QoJ1tyb2xlPSJkaWFsb2ciXScpIHx8CiAgICAgIHRhcmdldC5jbG9zZXN0KCIuZGlhbG9nLWNvbnRlbnQiKQogICAgKSB7CiAgICAgIGNvbnNvbGUubG9nKCJDbGlxdWUgZm9pIGVtIGJvdMOjbywgY2hlY2tib3ggb3UgbW9kYWwsIGlnbm9yYW5kby4uLiIpCiAgICAgIHJldHVybgogICAgfQoKICAgIGlmIChvcHRpbWlzdGljU3RhdGUuZWFuKSB7CiAgICAgIGNvbnNvbGUubG9nKCJBYnJpbmRvIG1vZGFsIGRlIGxpc3RhIGRlIHByb2R1dG9zLi4uIikKICAgICAgc2V0SXNQcm9kdWN0TGlzdE9wZW4odHJ1ZSkKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUubG9nKCJBbmRhciB2YXppbywgdXNlIG8gYm90w6NvICsgcGFyYSBhZGljaW9uYXIgcHJvZHV0byIpCiAgICB9CiAgfQoKICBjb25zdCBoYW5kbGVTZWxlY3Rpb25DaGFuZ2UgPSAoY2hlY2tlZDogYm9vbGVhbikgPT4gewogICAgaWYgKG9uU2VsZWN0aW9uQ2hhbmdlKSB7CiAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlKGlkLCBjaGVja2VkKQogICAgfQogIH0KCiAgY29uc3QgaGFuZGxlT3B0aW1pc3RpY1JlbW92ZSA9ICgpID0+IHsKICAgIGNvbnNvbGUubG9nKGBBdHVhbGl6YcOnw6NvIG90aW1pc3RhIC0gcmVtb3ZlbmRvIHByb2R1dG8gZGEgcHJhdGVsZWlyYSAke2lkfWApCiAgICBzZXRPcHRpbWlzdGljU3RhdGUoewogICAgICBlYW46IG51bGwsCiAgICAgIHByb2R1Y3ROYW1lOiBudWxsLAogICAgICBsYXN0VmVyaWZpZWQ6IG5ldyBEYXRlKCksCiAgICB9KQogIH0KCiAgY29uc3QgaGFuZGxlQXNzaWduU3VjY2VzcyA9ICgpID0+IHsKICAgIHNldElzQXNzaWduRGlhbG9nT3BlbihmYWxzZSkKICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoc2VhcmNoUGFyYW1zLnRvU3RyaW5nKCkpCiAgICBwYXJhbXMuc2V0KCJoaWdobGlnaHQiLCBpZCkKICAgIHBhcmFtcy5zZXQoInR5cGUiLCAic2hlbGYiKQogICAgY29uc3QgbmV3VXJsID0gYCR7d2luZG93LmxvY2F0aW9uLnBhdGhuYW1lfT8ke3BhcmFtcy50b1N0cmluZygpfWAKICAgIHJvdXRlci5yZXBsYWNlKG5ld1VybCwgeyBzY3JvbGw6IGZhbHNlIH0pCiAgICByb3V0ZXIucmVmcmVzaCgpCiAgfQoKICBjb25zdCBoYXNQcm9kdWN0ID0gb3B0aW1pc3RpY1N0YXRlLmVhbiAmJiBvcHRpbWlzdGljU3RhdGUuZWFuLnRyaW0oKSAhPT0gIiIKICBjb25zdCBlYW5Db3VudCA9IGNvdW50RUFOcyhvcHRpbWlzdGljU3RhdGUuZWFuKQogIGNvbnN0IGRpc3BsYXlFQU4gPSBmb3JtYXRFQU5zRm9yRGlzcGxheShvcHRpbWlzdGljU3RhdGUuZWFuKQoKICByZXR1cm4gKAogICAgPD4KICAgICAgPENhcmQKICAgICAgICBkYXRhLWhpZ2hsaWdodC1pZD17aWR9CiAgICAgICAgY2xhc3NOYW1lPXtjbigKICAgICAgICAgICJyZWxhdGl2ZSB3LWZ1bGwgaC0xMiBmbGV4IGl0ZW1zLWNlbnRlciBjdXJzb3ItcG9pbnRlciB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0yMDAgYm9yZGVyIHJvdW5kZWQtbGciLAogICAgICAgICAgImJvcmRlci1iLTAgbGFzdDpib3JkZXItYiIsCiAgICAgICAgICAiaG92ZXI6YmctZ3JheS01MCBkYXJrOmhvdmVyOmJnLWdyYXktODAwLzUwIiwKICAgICAgICAgIGlzU2VsZWN0ZWQgJiYgInJpbmctMiByaW5nLWJsdWUtNTAwIGJnLWJsdWUtNTAgZGFyazpiZy1ibHVlLTkwMC8yMCBkYXJrOnJpbmctYmx1ZS00MDAiLAogICAgICAgICAgaXNIaWdobGlnaHRlZCAmJiAiYmctcmVkLTEwMCBib3JkZXItcmVkLTUwMCBib3JkZXItMiBkYXJrOmJnLXJlZC05MDAvMzAgZGFyazpib3JkZXItcmVkLTQwMCIsCiAgICAgICAgICBpc0hpZ2hsaWdodGVkRXJyb3IKICAgICAgICAgICAgPyAiYmctcmVkLTEwMCBib3JkZXItcmVkLTQwMCB0ZXh0LXJlZC04MDAgaG92ZXI6YmctcmVkLTIwMCBkYXJrOmJnLXJlZC05MDAvNDAgZGFyazpib3JkZXItcmVkLTUwMCBkYXJrOnRleHQtcmVkLTMwMCBkYXJrOmhvdmVyOmJnLXJlZC05MDAvNjAiCiAgICAgICAgICAgIDogIiIsCiAgICAgICAgICAiIiwKICAgICAgICApfQogICAgICAgIG9uQ2xpY2s9e2hhbmRsZUNhcmRDbGlja30KICAgICAgPgogICAgICAgIDxkaXYgY2xhc3NOYW1lPSJhYnNvbHV0ZSB0b3AtMC41IGxlZnQtMC41IHotMjAiPgogICAgICAgICAgPENoZWNrYm94CiAgICAgICAgICAgIGNoZWNrZWQ9e2lzU2VsZWN0ZWR9CiAgICAgICAgICAgIG9uQ2hlY2tlZENoYW5nZT17aGFuZGxlU2VsZWN0aW9uQ2hhbmdlfQogICAgICAgICAgICBvbkNsaWNrPXsoZSkgPT4gZS5zdG9wUHJvcGFnYXRpb24oKX0KICAgICAgICAgICAgY2xhc3NOYW1lPSJoLTMgdy0zIHJvdW5kZWQiCiAgICAgICAgICAvPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPSJwLTIgZmxleCBpdGVtcy1jZW50ZXIgaC1mdWxsIHctZnVsbCI+CiAgICAgICAgICB7aGFzUHJvZHVjdCA/ICgKICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiB3LWZ1bGwiPgogICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyBmbGV4LTEgbWluLXctMCI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0idGV4dC1zbSBmb250LWJvbGQgdGV4dC1ncmF5LTgwMCBkYXJrOnRleHQtZ3JheS0xMDAgZmxleC1zaHJpbmstMCI+QXtsZXZlbH08L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBmbGV4LTEgbWluLXctMCI+CiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJ0ZXh0LXhzIGZvbnQtbWVkaXVtIHRleHQtZ3JheS02MDAgZGFyazp0ZXh0LWdyYXktMzAwIHRydW5jYXRlIj57ZGlzcGxheUVBTn08L2Rpdj4KICAgICAgICAgICAgICAgICAge2VhbkNvdW50ID4gMSAmJiAoCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImZsZXggaXRlbXMtY2VudGVyIGdhcC0xIj4KICAgICAgICAgICAgICAgICAgICAgIDxQYWNrYWdlIGNsYXNzTmFtZT0iaC0zIHctMyB0ZXh0LWJsdWUtNjAwIGRhcms6dGV4dC1ibHVlLTQwMCIgLz4KICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0idGV4dC1bMC42cmVtXSBiZy1ibHVlLTEwMCBkYXJrOmJnLWJsdWUtOTAwLzMwIHRleHQtYmx1ZS03MDAgZGFyazp0ZXh0LWJsdWUtMzAwIHB4LTEgcm91bmRlZCI+CiAgICAgICAgICAgICAgICAgICAgICAgIHtlYW5Db3VudH0gaXRlbnMKICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgZmxleC1zaHJpbmstMCI+CiAgICAgICAgICAgICAgICA8QWRkUHJvZHVjdFRvU2hlbGZCdXR0b24KICAgICAgICAgICAgICAgICAgc2hlbGZJZD17aWR9CiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPXtwb3NpdGlvbn0KICAgICAgICAgICAgICAgICAgbGV2ZWw9e2xldmVsfQogICAgICAgICAgICAgICAgICBjdXJyZW50RWFuPXtvcHRpbWlzdGljU3RhdGUuZWFuIHx8ICIifQogICAgICAgICAgICAgICAgICBjdXJyZW50UHJvZHVjdE5hbWU9e29wdGltaXN0aWNTdGF0ZS5wcm9kdWN0TmFtZSB8fCAiIn0KICAgICAgICAgICAgICAgIC8+CgogICAgICAgICAgICAgICAge29wdGltaXN0aWNTdGF0ZS5sYXN0VmVyaWZpZWQgJiYgKAogICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEiPgogICAgICAgICAgICAgICAgICAgIDxDaGVja0NpcmNsZTIKICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y24oCiAgICAgICAgICAgICAgICAgICAgICAgICJoLTMgdy0zIiwKICAgICAgICAgICAgICAgICAgICAgICAgbmVlZHNWZXJpZmljYXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICA/ICJ0ZXh0LXllbGxvdy02MDAgZGFyazp0ZXh0LXllbGxvdy00MDAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgOiAidGV4dC1ncmVlbi02MDAgZGFyazp0ZXh0LWdyZWVuLTQwMCIsCiAgICAgICAgICAgICAgICAgICAgICApfQogICAgICAgICAgICAgICAgICAgIC8+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSJ0ZXh0LVswLjY1cmVtXSB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMCBoaWRkZW4gc206aW5saW5lIj4KICAgICAgICAgICAgICAgICAgICAgIHtvcHRpbWlzdGljU3RhdGUubGFzdFZlcmlmaWVkLnRvTG9jYWxlRGF0ZVN0cmluZygicHQtQlIiLCB7IGRheTogIjItZGlnaXQiLCBtb250aDogIjItZGlnaXQiIH0pfQogICAgICAgICAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICApfQoKICAgICAgICAgICAgICAgIHtpc0R1cGxpY2F0ZWRFQU4gJiYgKAogICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEgdGV4dC1vcmFuZ2UtNTAwIGRhcms6dGV4dC1vcmFuZ2UtNDAwIj4KICAgICAgICAgICAgICAgICAgICA8QWxlcnRDaXJjbGUgY2xhc3NOYW1lPSJoLTMgdy0zIiAvPgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0idGV4dC1bMC42NXJlbV0gZm9udC1tZWRpdW0gaGlkZGVuIHNtOmlubGluZSI+RHVwPC9zcGFuPgogICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgKSA6ICgKICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiB3LWZ1bGwiPgogICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0idGV4dC1zbSBmb250LWJvbGQgdGV4dC1ncmF5LTcwMCBkYXJrOnRleHQtZ3JheS0yMDAiPkF7bGV2ZWx9PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0idGV4dC14cyB0ZXh0LWdyYXktNDAwIGRhcms6dGV4dC1ncmF5LTUwMCI+KFZhemlvKTwvZGl2PgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiI+CiAgICAgICAgICAgICAgICA8QWRkUHJvZHVjdFRvU2hlbGZCdXR0b24gc2hlbGZJZD17aWR9IHBvc2l0aW9uPXtwb3NpdGlvbn0gbGV2ZWw9e2xldmVsfSAvPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9InRleHQtWzAuNjVyZW1dIHRleHQtYmx1ZS01MDAgZGFyazp0ZXh0LWJsdWUtNDAwIGZvbnQtbWVkaXVtIj4KICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSJoaWRkZW4gc206aW5saW5lIj5BZGljaW9uYXIgcHJvZHV0bzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSJzbTpoaWRkZW4iPis8L3NwYW4+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICApfQogICAgICAgIDwvQ2FyZENvbnRlbnQ+CgogICAgICAgIDxVbmFzc2lnbkJ1dHRvbgogICAgICAgICAgc2hlbGZJZD17aWR9CiAgICAgICAgICBwb3NpdGlvbj17cG9zaXRpb259CiAgICAgICAgICBsZXZlbD17bGV2ZWx9CiAgICAgICAgICBoYXNQcm9kdWN0PXtoYXNQcm9kdWN0fQogICAgICAgICAgb25PcHRpbWlzdGljVXBkYXRlPXtoYW5kbGVPcHRpbWlzdGljUmVtb3ZlfQogICAgICAgIC8+CiAgICAgIDwvQ2FyZD4KCiAgICAgIDxQcm9kdWN0TGlzdE1vZGFsCiAgICAgICAgaXNPcGVuPXtpc1Byb2R1Y3RMaXN0T3Blbn0KICAgICAgICBvbkNsb3NlPXsoKSA9PiBzZXRJc1Byb2R1Y3RMaXN0T3BlbihmYWxzZSl9CiAgICAgICAgdGl0bGU9e2BQcm9kdXRvcyAtIEFuZGFyICR7bGV2ZWx9YH0KICAgICAgICBkZXNjcmlwdGlvbj17YEVzdGUgYW5kYXIgY29udMOpbSAke2VhbkNvdW50fSAke2VhbkNvdW50ID09PSAxID8gInByb2R1dG8iIDogInByb2R1dG9zIGRpZmVyZW50ZXMifS5gfQogICAgICAgIGVhbnM9e29wdGltaXN0aWNTdGF0ZS5lYW4gfHwgIiJ9CiAgICAgICAgcHJvZHVjdE5hbWVzPXtvcHRpbWlzdGljU3RhdGUucHJvZHVjdE5hbWUgfHwgIiJ9CiAgICAgICAgc3RvcmFnZVR5cGU9InNoZWxmIgogICAgICAgIG9uUmVtb3ZlU2VsZWN0ZWQ9e2hhbmRsZVJlbW92ZVNlbGVjdGVkUHJvZHVjdHN9CiAgICAgICAgb25QcmludFNlbGVjdGVkPXtoYW5kbGVQcmludFNlbGVjdGVkUHJvZHVjdHN9CiAgICAgIC8+CgogICAgICA8RGlhbG9nIG9wZW49e2lzQXNzaWduRGlhbG9nT3Blbn0gb25PcGVuQ2hhbmdlPXtzZXRJc0Fzc2lnbkRpYWxvZ09wZW59PgogICAgICAgIDxEaWFsb2dDb250ZW50IGNsYXNzTmFtZT0ic206bWF4LXctWzQyNXB4XSB3LVs5NXZ3XSBtYXgtaC1bOTB2aF0gb3ZlcmZsb3cteS1hdXRvIHJvdW5kZWQteGwiPgogICAgICAgICAgPERpYWxvZ0hlYWRlcj4KICAgICAgICAgICAgPERpYWxvZ1RpdGxlPkFkaWNpb25hciBQcm9kdXRvIC0gQW5kYXIge2xldmVsfTwvRGlhbG9nVGl0bGU+CiAgICAgICAgICAgIDxEaWFsb2dEZXNjcmlwdGlvbj5BZGljaW9uZSB1bSBwcm9kdXRvIGEgZXN0ZSBhbmRhciBkYSBwcmF0ZWxlaXJhIHtwb3NpdGlvbn0uPC9EaWFsb2dEZXNjcmlwdGlvbj4KICAgICAgICAgIDwvRGlhbG9nSGVhZGVyPgogICAgICAgICAgPEFzc2lnblByb2R1Y3RUb1NoZWxmRm9ybUVuaGFuY2VkCiAgICAgICAgICAgIHNoZWxmSWQ9e2lkfQogICAgICAgICAgICBjdXJyZW50RWFuPSIiCiAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0TmFtZT0iIgogICAgICAgICAgICBvblN1Y2Nlc3M9e2hhbmRsZUFzc2lnblN1Y2Nlc3N9CiAgICAgICAgICAgIGlzQWRkTW9kZT17ZmFsc2V9CiAgICAgICAgICAvPgogICAgICAgICAge2hhc1Byb2R1Y3QgJiYgPFZlcmlmeUJ1dHRvbiBzaGVsZklkPXtpZH0gLz59CiAgICAgICAgPC9EaWFsb2dDb250ZW50PgogICAgICA8L0RpYWxvZz4KICAgIDwvPgogICkKfQo="}