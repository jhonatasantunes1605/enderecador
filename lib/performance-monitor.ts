{"data":"aW50ZXJmYWNlIFBlcmZvcm1hbmNlTWV0cmljIHsKICBvcGVyYXRpb246IHN0cmluZwogIGR1cmF0aW9uOiBudW1iZXIKICB0aW1lc3RhbXA6IERhdGUKICBjYWNoZUhpdD86IGJvb2xlYW4KICBlcnJvcj86IHN0cmluZwp9CgpjbGFzcyBQZXJmb3JtYW5jZU1vbml0b3IgewogIHByaXZhdGUgbWV0cmljczogUGVyZm9ybWFuY2VNZXRyaWNbXSA9IFtdCiAgcHJpdmF0ZSBtYXhNZXRyaWNzID0gMTAwMCAvLyBNYW50ZXIgYXBlbmFzIGFzIMO6bHRpbWFzIDEwMDAgbcOpdHJpY2FzCgogIGFzeW5jIHRyYWNrT3BlcmF0aW9uPFQ+KG9wZXJhdGlvbjogc3RyaW5nLCBmbjogKCkgPT4gUHJvbWlzZTxUPiwgY2FjaGVLZXk/OiBzdHJpbmcpOiBQcm9taXNlPFQ+IHsKICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCkKICAgIGxldCBlcnJvcjogc3RyaW5nIHwgdW5kZWZpbmVkCiAgICBsZXQgcmVzdWx0OiBUCgogICAgdHJ5IHsKICAgICAgcmVzdWx0ID0gYXdhaXQgZm4oKQogICAgICByZXR1cm4gcmVzdWx0CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgZXJyb3IgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogIlVua25vd24gZXJyb3IiCiAgICAgIHRocm93IGVycgogICAgfSBmaW5hbGx5IHsKICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lCgogICAgICB0aGlzLmFkZE1ldHJpYyh7CiAgICAgICAgb3BlcmF0aW9uLAogICAgICAgIGR1cmF0aW9uLAogICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSwKICAgICAgICBlcnJvciwKICAgICAgfSkKCiAgICAgIC8vIExvZyBwZXJmb3JtYW5jZQogICAgICBpZiAoZHVyYXRpb24gPiAxMDAwKSB7CiAgICAgICAgY29uc29sZS53YXJuKGBbUEVSRl0g8J+QjCBPcGVyYcOnw6NvIGxlbnRhOiAke29wZXJhdGlvbn0gKCR7ZHVyYXRpb259bXMpYCkKICAgICAgfSBlbHNlIGlmIChkdXJhdGlvbiA+IDUwMCkgewogICAgICAgIGNvbnNvbGUubG9nKGBbUEVSRl0g4pqg77iPICR7b3BlcmF0aW9ufSAoJHtkdXJhdGlvbn1tcylgKQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKGBbUEVSRl0g8J+TiiAke29wZXJhdGlvbn0gKCR7ZHVyYXRpb259bXMpYCkKICAgICAgfQogICAgfQogIH0KCiAgcHJpdmF0ZSBhZGRNZXRyaWMobWV0cmljOiBQZXJmb3JtYW5jZU1ldHJpYykgewogICAgdGhpcy5tZXRyaWNzLnB1c2gobWV0cmljKQoKICAgIC8vIE1hbnRlciBhcGVuYXMgYXMgbcOpdHJpY2FzIG1haXMgcmVjZW50ZXMKICAgIGlmICh0aGlzLm1ldHJpY3MubGVuZ3RoID4gdGhpcy5tYXhNZXRyaWNzKSB7CiAgICAgIHRoaXMubWV0cmljcyA9IHRoaXMubWV0cmljcy5zbGljZSgtdGhpcy5tYXhNZXRyaWNzKQogICAgfQogIH0KCiAgcmVjb3JkQ2FjaGVIaXQoKSB7CiAgICAvLyBSZWdpc3RyYXIgaGl0IGRlIGNhY2hlIHNlIG5lY2Vzc8OhcmlvCiAgfQoKICByZWNvcmRDYWNoZU1pc3MoKSB7CiAgICAvLyBSZWdpc3RyYXIgbWlzcyBkZSBjYWNoZSBzZSBuZWNlc3PDoXJpbwogIH0KCiAgZ2V0U3RhdHMoKSB7CiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpCiAgICBjb25zdCBsYXN0NU1pbnV0ZXMgPSB0aGlzLm1ldHJpY3MuZmlsdGVyKChtKSA9PiBub3cgLSBtLnRpbWVzdGFtcC5nZXRUaW1lKCkgPCA1ICogNjAgKiAxMDAwKQogICAgY29uc3QgbGFzdDFIb3VyID0gdGhpcy5tZXRyaWNzLmZpbHRlcigobSkgPT4gbm93IC0gbS50aW1lc3RhbXAuZ2V0VGltZSgpIDwgNjAgKiA2MCAqIDEwMDApCgogICAgcmV0dXJuIHsKICAgICAgdG90YWw6IHRoaXMubWV0cmljcy5sZW5ndGgsCiAgICAgIGxhc3Q1TWludXRlczogbGFzdDVNaW51dGVzLmxlbmd0aCwKICAgICAgbGFzdDFIb3VyOiBsYXN0MUhvdXIubGVuZ3RoLAogICAgICBhdmVyYWdlRHVyYXRpb246IHRoaXMubWV0cmljcy5yZWR1Y2UoKHN1bSwgbSkgPT4gc3VtICsgbS5kdXJhdGlvbiwgMCkgLyB0aGlzLm1ldHJpY3MubGVuZ3RoIHx8IDAsCiAgICAgIHNsb3dPcGVyYXRpb25zOiB0aGlzLm1ldHJpY3MuZmlsdGVyKChtKSA9PiBtLmR1cmF0aW9uID4gMTAwMCkubGVuZ3RoLAogICAgICBlcnJvcnM6IHRoaXMubWV0cmljcy5maWx0ZXIoKG0pID0+IG0uZXJyb3IpLmxlbmd0aCwKICAgICAgb3BlcmF0aW9uczogdGhpcy5nZXRPcGVyYXRpb25TdGF0cygpLAogICAgfQogIH0KCiAgcHJpdmF0ZSBnZXRPcGVyYXRpb25TdGF0cygpIHsKICAgIGNvbnN0IG9wZXJhdGlvbkNvdW50czogUmVjb3JkPHN0cmluZywgeyBjb3VudDogbnVtYmVyOyBhdmdEdXJhdGlvbjogbnVtYmVyOyBlcnJvcnM6IG51bWJlciB9PiA9IHt9CgogICAgdGhpcy5tZXRyaWNzLmZvckVhY2goKG1ldHJpYykgPT4gewogICAgICBpZiAoIW9wZXJhdGlvbkNvdW50c1ttZXRyaWMub3BlcmF0aW9uXSkgewogICAgICAgIG9wZXJhdGlvbkNvdW50c1ttZXRyaWMub3BlcmF0aW9uXSA9IHsgY291bnQ6IDAsIGF2Z0R1cmF0aW9uOiAwLCBlcnJvcnM6IDAgfQogICAgICB9CgogICAgICBjb25zdCBzdGF0cyA9IG9wZXJhdGlvbkNvdW50c1ttZXRyaWMub3BlcmF0aW9uXQogICAgICBzdGF0cy5jb3VudCsrCiAgICAgIHN0YXRzLmF2Z0R1cmF0aW9uID0gKHN0YXRzLmF2Z0R1cmF0aW9uICogKHN0YXRzLmNvdW50IC0gMSkgKyBtZXRyaWMuZHVyYXRpb24pIC8gc3RhdHMuY291bnQKICAgICAgaWYgKG1ldHJpYy5lcnJvcikgc3RhdHMuZXJyb3JzKysKICAgIH0pCgogICAgcmV0dXJuIG9wZXJhdGlvbkNvdW50cwogIH0KCiAgY2xlYXJNZXRyaWNzKCkgewogICAgdGhpcy5tZXRyaWNzID0gW10KICB9Cn0KCmV4cG9ydCBjb25zdCBwZXJmb3JtYW5jZU1vbml0b3IgPSBuZXcgUGVyZm9ybWFuY2VNb25pdG9yKCkK"}