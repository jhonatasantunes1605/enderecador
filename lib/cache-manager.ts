{"data":"InVzZSBjbGllbnQiCgovLyBDYWNoZSBtYW5hZ2VyIHBhcmEgb3RpbWl6YXIgcGVyZm9ybWFuY2UKY2xhc3MgQ2FjaGVNYW5hZ2VyIHsKICBwcml2YXRlIGNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHsgZGF0YTogYW55OyB0aW1lc3RhbXA6IG51bWJlcjsgdHRsOiBudW1iZXIgfT4oKQogIHByaXZhdGUgcmVhZG9ubHkgREVGQVVMVF9UVEwgPSA1ICogNjAgKiAxMDAwIC8vIDUgbWludXRvcwoKICBzZXQoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSwgdHRsOiBudW1iZXIgPSB0aGlzLkRFRkFVTFRfVFRMKSB7CiAgICB0aGlzLmNhY2hlLnNldChrZXksIHsKICAgICAgZGF0YSwKICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLAogICAgICB0dGwsCiAgICB9KQogIH0KCiAgZ2V0KGtleTogc3RyaW5nKSB7CiAgICBjb25zdCBpdGVtID0gdGhpcy5jYWNoZS5nZXQoa2V5KQoKICAgIGlmICghaXRlbSkgewogICAgICByZXR1cm4gbnVsbAogICAgfQoKICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCkKICAgIGlmIChub3cgLSBpdGVtLnRpbWVzdGFtcCA+IGl0ZW0udHRsKSB7CiAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSkKICAgICAgcmV0dXJuIG51bGwKICAgIH0KCiAgICByZXR1cm4gaXRlbS5kYXRhCiAgfQoKICBpbnZhbGlkYXRlKGtleTogc3RyaW5nKSB7CiAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpCiAgfQoKICBpbnZhbGlkYXRlUGF0dGVybihwYXR0ZXJuOiBzdHJpbmcpIHsKICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChwYXR0ZXJuKQogICAgZm9yIChjb25zdCBrZXkgb2YgdGhpcy5jYWNoZS5rZXlzKCkpIHsKICAgICAgaWYgKHJlZ2V4LnRlc3Qoa2V5KSkgewogICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSkKICAgICAgfQogICAgfQogIH0KCiAgY2xlYXIoKSB7CiAgICB0aGlzLmNhY2hlLmNsZWFyKCkKICB9CgogIC8vIExpbXBhciBjYWNoZSBleHBpcmFkbyBhdXRvbWF0aWNhbWVudGUKICBjbGVhbnVwKCkgewogICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKQogICAgZm9yIChjb25zdCBba2V5LCBpdGVtXSBvZiB0aGlzLmNhY2hlLmVudHJpZXMoKSkgewogICAgICBpZiAobm93IC0gaXRlbS50aW1lc3RhbXAgPiBpdGVtLnR0bCkgewogICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSkKICAgICAgfQogICAgfQogIH0KfQoKZXhwb3J0IGNvbnN0IGNhY2hlTWFuYWdlciA9IG5ldyBDYWNoZU1hbmFnZXIoKQoKLy8gTGltcGFyIGNhY2hlIGV4cGlyYWRvIGEgY2FkYSAxMCBtaW51dG9zCmlmICh0eXBlb2Ygd2luZG93ICE9PSAidW5kZWZpbmVkIikgewogIHNldEludGVydmFsKAogICAgKCkgPT4gewogICAgICBjYWNoZU1hbmFnZXIuY2xlYW51cCgpCiAgICB9LAogICAgMTAgKiA2MCAqIDEwMDAsCiAgKQp9Cg=="}