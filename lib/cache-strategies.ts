{"data":"aW1wb3J0IHsgcmVkaXNDYWNoZSwgQ0FDSEVfVFRMLCBDQUNIRV9LRVlTIH0gZnJvbSAiLi9yZWRpcy1jYWNoZS1pbXByb3ZlZCIKCi8vIEVzdHJhdMOpZ2lhcyBlc3BlY8OtZmljYXMgZGUgY2FjaGUgcGFyYSBkaWZlcmVudGVzIHRpcG9zIGRlIGRhZG9zCmV4cG9ydCBjbGFzcyBDYWNoZVN0cmF0ZWdpZXMgewogIC8vIENhY2hlIHBhcmEgZGFkb3MgZGUgd2FyZWhvdXNlIGNvbSBpbnZhbGlkYcOnw6NvIGludGVsaWdlbnRlCiAgc3RhdGljIGFzeW5jIGNhY2hlV2FyZWhvdXNlKHdhcmVob3VzZUlkOiBzdHJpbmcsIGZldGNoRm46ICgpID0+IFByb21pc2U8YW55PikgewogICAgY29uc3Qga2V5ID0gQ0FDSEVfS0VZUy5XQVJFSE9VU0Uod2FyZWhvdXNlSWQpCgogICAgcmV0dXJuICgKICAgICAgKGF3YWl0IHJlZGlzQ2FjaGUuZ2V0KGtleSkpIHx8CiAgICAgIChhd2FpdCAoYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmZXRjaEZuKCkKICAgICAgICBhd2FpdCByZWRpc0NhY2hlLnNldChrZXksIGRhdGEsIHsgdHRsOiBDQUNIRV9UVEwuTE9ORyB9KQogICAgICAgIHJldHVybiBkYXRhCiAgICAgIH0pKCkpCiAgICApCiAgfQoKICAvLyBDYWNoZSBwYXJhIGJ1c2NhcyBjb20gVFRMIG1haXMgY3VydG8KICBzdGF0aWMgYXN5bmMgY2FjaGVTZWFyY2gocXVlcnk6IHN0cmluZywgZmV0Y2hGbjogKCkgPT4gUHJvbWlzZTxhbnk+KSB7CiAgICBjb25zdCBrZXkgPSBDQUNIRV9LRVlTLlNFQVJDSF9SRVNVTFRTKHF1ZXJ5KQoKICAgIHJldHVybiAoCiAgICAgIChhd2FpdCByZWRpc0NhY2hlLmdldChrZXkpKSB8fAogICAgICAoYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgZmV0Y2hGbigpCiAgICAgICAgYXdhaXQgcmVkaXNDYWNoZS5zZXQoa2V5LCBkYXRhLCB7IHR0bDogQ0FDSEVfVFRMLlNIT1JUIH0pCiAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgfSkoKSkKICAgICkKICB9CgogIC8vIENhY2hlIHBhcmEgcHJvZHV0b3MgY29tIGNvbXByZXNzw6NvIGF1dG9tw6F0aWNhCiAgc3RhdGljIGFzeW5jIGNhY2hlUHJvZHVjdChlYW46IHN0cmluZywgZmV0Y2hGbjogKCkgPT4gUHJvbWlzZTxhbnk+KSB7CiAgICBjb25zdCBrZXkgPSBDQUNIRV9LRVlTLlBST0RVQ1RfQllfRUFOKGVhbikKCiAgICByZXR1cm4gKAogICAgICAoYXdhaXQgcmVkaXNDYWNoZS5nZXQoa2V5LCB7IGNvbXByZXNzOiB0cnVlIH0pKSB8fAogICAgICAoYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgZmV0Y2hGbigpCiAgICAgICAgYXdhaXQgcmVkaXNDYWNoZS5zZXQoa2V5LCBkYXRhLCB7IHR0bDogQ0FDSEVfVFRMLlZFUllfTE9ORywgY29tcHJlc3M6IHRydWUgfSkKICAgICAgICByZXR1cm4gZGF0YQogICAgICB9KSgpKQogICAgKQogIH0KCiAgLy8gQ2FjaGUgcGFyYSBlc3RhdMOtc3RpY2FzIGRpw6FyaWFzCiAgc3RhdGljIGFzeW5jIGNhY2hlRGFpbHlTdGF0cyhkYXRlOiBzdHJpbmcsIGZldGNoRm46ICgpID0+IFByb21pc2U8YW55PikgewogICAgY29uc3Qga2V5ID0gQ0FDSEVfS0VZUy5BTkFMWVRJQ1NfREFJTFkoZGF0ZSkKCiAgICByZXR1cm4gKAogICAgICAoYXdhaXQgcmVkaXNDYWNoZS5nZXQoa2V5KSkgfHwKICAgICAgKGF3YWl0IChhc3luYyAoKSA9PiB7CiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGZldGNoRm4oKQogICAgICAgIC8vIEVzdGF0w61zdGljYXMgZG8gZGlhIGF0dWFsIHTDqm0gVFRMIG1lbm9yCiAgICAgICAgY29uc3QgaXNUb2RheSA9IGRhdGUgPT09IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgiVCIpWzBdCiAgICAgICAgY29uc3QgdHRsID0gaXNUb2RheSA/IENBQ0hFX1RUTC5TSE9SVCA6IENBQ0hFX1RUTC5EQUlMWQoKICAgICAgICBhd2FpdCByZWRpc0NhY2hlLnNldChrZXksIGRhdGEsIHsgdHRsIH0pCiAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgfSkoKSkKICAgICkKICB9Cn0K"}