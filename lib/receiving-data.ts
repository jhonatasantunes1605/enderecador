{"data":"aW1wb3J0IHsgZ29vZ2xlU2hlZXRzU2VydmljZSwgdHlwZSBSZWNlaXZpbmdSb3cgfSBmcm9tICIuL2dvb2dsZS1zaGVldHMiDQppbXBvcnQgdHlwZSB7IFJlY2VpdmluZ1JlY29yZCB9IGZyb20gIi4vcmVjZWl2aW5nLXR5cGVzIg0KaW1wb3J0IHsgcGVyZm9ybWFuY2VNb25pdG9yIH0gZnJvbSAiLi9wZXJmb3JtYW5jZS1tb25pdG9yIg0KDQovLyBGdW7Dp8OjbyBwYXJhIGFkaWNpb25hciBub3ZvIHJlY2ViaW1lbnRvDQpleHBvcnQgY29uc3QgYWRkUmVjZWl2aW5nUmVjb3JkID0gYXN5bmMgKA0KICByZWNvcmQ6IE9taXQ8UmVjZWl2aW5nUmVjb3JkLCAiaWQiIHwgImNyZWF0ZWRBdCIgfCAicmVjZWl2ZWRBdCI+LA0KKTogUHJvbWlzZTxSZWNlaXZpbmdSZWNvcmQ+ID0+IHsNCiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKQ0KDQogIGNvbnN0IHJlY2VpdmluZ1JvdzogT21pdDxSZWNlaXZpbmdSb3csICJpZCIgfCAiY3JlYXRlZEF0Ij4gPSB7DQogICAgbmY6IHJlY29yZC5uZiwNCiAgICBzdXBwbGllcjogcmVjb3JkLnN1cHBsaWVyLA0KICAgIHBhbGxldENvdW50OiByZWNvcmQucGFsbGV0Q291bnQudG9TdHJpbmcoKSwNCiAgICBhZGRyZXNzOiByZWNvcmQuYWRkcmVzcywNCiAgICBzY2hlZHVsZWREYXRlOiByZWNvcmQuc2NoZWR1bGVkRGF0ZSwNCiAgICBzdGF0dXM6IHJlY29yZC5zdGF0dXMsDQogICAgcmVjZWl2ZWRBdDogIiIsDQogIH0NCg0KICBjb25zdCBzYXZlZFJvdyA9IGF3YWl0IGdvb2dsZVNoZWV0c1NlcnZpY2UuYWRkUmVjZWl2aW5nUmVjb3JkKHJlY2VpdmluZ1JvdykNCg0KICByZXR1cm4gew0KICAgIGlkOiBzYXZlZFJvdy5pZCwNCiAgICBuZjogc2F2ZWRSb3cubmYsDQogICAgc3VwcGxpZXI6IHNhdmVkUm93LnN1cHBsaWVyLA0KICAgIHBhbGxldENvdW50OiBOdW1iZXIucGFyc2VJbnQoc2F2ZWRSb3cucGFsbGV0Q291bnQpLA0KICAgIGFkZHJlc3M6IHNhdmVkUm93LmFkZHJlc3MsDQogICAgc2NoZWR1bGVkRGF0ZTogc2F2ZWRSb3cuc2NoZWR1bGVkRGF0ZSwNCiAgICBzdGF0dXM6IHNhdmVkUm93LnN0YXR1cyBhcyBSZWNlaXZpbmdSZWNvcmRbInN0YXR1cyJdLA0KICAgIHJlY2VpdmVkQXQ6IHNhdmVkUm93LnJlY2VpdmVkQXQgfHwgdW5kZWZpbmVkLA0KICAgIGNyZWF0ZWRBdDogc2F2ZWRSb3cuY3JlYXRlZEF0LA0KICB9DQp9DQoNCi8vIEZ1bsOnw6NvIHBhcmEgYXR1YWxpemFyIHN0YXR1cyBkZSByZWNlYmltZW50bw0KZXhwb3J0IGNvbnN0IHVwZGF0ZVJlY2VpdmluZ1N0YXR1cyA9IGFzeW5jIChyZWNvcmRJZDogc3RyaW5nLCBzdGF0dXM6IFJlY2VpdmluZ1JlY29yZFsic3RhdHVzIl0pOiBQcm9taXNlPGJvb2xlYW4+ID0+IHsNCiAgY29uc3QgdXBkYXRlczogUGFydGlhbDxSZWNlaXZpbmdSb3c+ID0gew0KICAgIHN0YXR1cywNCiAgfQ0KDQogIGlmIChzdGF0dXMgPT09ICJyZWNlaXZlZCIpIHsNCiAgICB1cGRhdGVzLnJlY2VpdmVkQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkNCiAgfSBlbHNlIHsNCiAgICB1cGRhdGVzLnJlY2VpdmVkQXQgPSAiIg0KICB9DQoNCiAgcmV0dXJuIGF3YWl0IGdvb2dsZVNoZWV0c1NlcnZpY2UudXBkYXRlUmVjZWl2aW5nUmVjb3JkKHJlY29yZElkLCB1cGRhdGVzKQ0KfQ0KDQovLyBGdW7Dp8OjbyBwYXJhIG9idGVyIGhpc3TDs3JpY28gZGUgcmVjZWJpbWVudG9zDQpleHBvcnQgY29uc3QgZ2V0UmVjZWl2aW5nSGlzdG9yeSA9IGFzeW5jICgpOiBQcm9taXNlPFJlY2VpdmluZ1JlY29yZFtdPiA9PiB7DQogIHJldHVybiBwZXJmb3JtYW5jZU1vbml0b3IudHJhY2tPcGVyYXRpb24oImdldFJlY2VpdmluZ0hpc3RvcnkiLCBhc3luYyAoKSA9PiB7DQogICAgdHJ5IHsNCiAgICAgIGNvbnNvbGUubG9nKCJbUkVDRUlWSU5HXSBCdXNjYW5kbyBoaXN0w7NyaWNvIGRlIHJlY2ViaW1lbnRvcy4uLiIpDQoNCiAgICAgIGNvbnN0IHJvd3MgPSBhd2FpdCBnb29nbGVTaGVldHNTZXJ2aWNlLmdldFJlY2VpdmluZ1JlY29yZHMoKQ0KDQogICAgICBjb25zdCByZWNvcmRzID0gcm93cw0KICAgICAgICAubWFwKChyb3cpID0+ICh7DQogICAgICAgICAgaWQ6IHJvdy5pZCwNCiAgICAgICAgICBuZjogcm93Lm5mLA0KICAgICAgICAgIHN1cHBsaWVyOiByb3cuc3VwcGxpZXIsDQogICAgICAgICAgcGFsbGV0Q291bnQ6IE51bWJlci5wYXJzZUludChyb3cucGFsbGV0Q291bnQpIHx8IDAsDQogICAgICAgICAgYWRkcmVzczogcm93LmFkZHJlc3MsDQogICAgICAgICAgc2NoZWR1bGVkRGF0ZTogcm93LnNjaGVkdWxlZERhdGUsDQogICAgICAgICAgc3RhdHVzOiByb3cuc3RhdHVzIGFzIFJlY2VpdmluZ1JlY29yZFsic3RhdHVzIl0sDQogICAgICAgICAgcmVjZWl2ZWRBdDogcm93LnJlY2VpdmVkQXQgfHwgdW5kZWZpbmVkLA0KICAgICAgICAgIGNyZWF0ZWRBdDogcm93LmNyZWF0ZWRBdCwNCiAgICAgICAgfSkpDQogICAgICAgIC5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLmNyZWF0ZWRBdCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5jcmVhdGVkQXQpLmdldFRpbWUoKSkNCg0KICAgICAgY29uc29sZS5sb2coYFtSRUNFSVZJTkddIEVuY29udHJhZG9zICR7cmVjb3Jkcy5sZW5ndGh9IHJlZ2lzdHJvcyBkZSByZWNlYmltZW50b2ApDQogICAgICByZXR1cm4gcmVjb3Jkcw0KICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICBjb25zb2xlLmVycm9yKCJFcnJvIGFvIGJ1c2NhciBoaXN0w7NyaWNvIGRlIHJlY2ViaW1lbnRvczoiLCBlcnJvcikNCiAgICAgIHJldHVybiBbXQ0KICAgIH0NCiAgfSkNCn0K"}