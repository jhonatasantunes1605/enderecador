{"data":"aW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50LCB0eXBlIENvb2tpZU9wdGlvbnMgfSBmcm9tICJAc3VwYWJhc2Uvc3NyIgppbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAibmV4dC9zZXJ2ZXIiCgpleHBvcnQgZnVuY3Rpb24gY3JlYXRlU2VydmVyU3VwYWJhc2UocmVxdWVzdDogTmV4dFJlcXVlc3QsIHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UpIHsKICBjb25zdCB1cmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwKICBjb25zdCBrZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9QVUJMSVNIQUJMRV9LRVkgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkKICBpZiAoIXVybCB8fCAha2V5KSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIlN1cGFiYXNlIG7Do28gY29uZmlndXJhZG86IGRlZmluYSBORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgZSBhIGNoYXZlIHDDumJsaWNhIChQVUJMSVNIQUJMRSBvdSBBTk9OKSIpCiAgfQogIHJldHVybiBjcmVhdGVTZXJ2ZXJDbGllbnQodXJsLCBrZXksIHsKICAgICAgY29va2llczogewogICAgICAgIGdldChuYW1lOiBzdHJpbmcpIHsKICAgICAgICAgIHJldHVybiByZXF1ZXN0LmNvb2tpZXMuZ2V0KG5hbWUpPy52YWx1ZQogICAgICAgIH0sCiAgICAgICAgc2V0KG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgb3B0aW9uczogQ29va2llT3B0aW9ucykgewogICAgICAgICAgcmVzcG9uc2UuY29va2llcy5zZXQoeyBuYW1lLCB2YWx1ZSwgLi4ub3B0aW9ucyB9KQogICAgICAgIH0sCiAgICAgICAgcmVtb3ZlKG5hbWU6IHN0cmluZywgb3B0aW9uczogQ29va2llT3B0aW9ucykgewogICAgICAgICAgcmVzcG9uc2UuY29va2llcy5zZXQoeyBuYW1lLCB2YWx1ZTogIiIsIC4uLm9wdGlvbnMgfSkKICAgICAgICB9LAogICAgICB9LAogICAgfSwKICApCn0KCmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVTZXNzaW9uKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7CiAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UubmV4dCgpCiAgY29uc3QgdXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMCiAgY29uc3Qga2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfUFVCTElTSEFCTEVfS0VZIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZCiAgaWYgKHVybCAmJiBrZXkpIHsKICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyU3VwYWJhc2UocmVxdWVzdCwgcmVzcG9uc2UpCiAgICBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKQogIH0KICByZXR1cm4gcmVzcG9uc2UKfQoKZXhwb3J0IGZ1bmN0aW9uIGhhc1N1cGFiYXNlRW52KCkgewogIHJldHVybiAoCiAgICAhIXByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCAmJgogICAgISEocHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfUFVCTElTSEFCTEVfS0VZIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZKQogICkKfQo="}