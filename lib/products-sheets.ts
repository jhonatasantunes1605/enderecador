{"data":"aW1wb3J0IHsgR29vZ2xlU3ByZWFkc2hlZXQgfSBmcm9tICJnb29nbGUtc3ByZWFkc2hlZXQiCmltcG9ydCB7IEpXVCB9IGZyb20gImdvb2dsZS1hdXRoLWxpYnJhcnkiCmltcG9ydCB7IHJlZGlzQ2FjaGUsIENBQ0hFX0tFWVMsIENBQ0hFX1RUTCB9IGZyb20gIi4vcmVkaXMtY2FjaGUiCmltcG9ydCB7IHBlcmZvcm1hbmNlTW9uaXRvciB9IGZyb20gIi4vcGVyZm9ybWFuY2UtbW9uaXRvciIKCi8vIEZ1bsOnw6NvIHBhcmEgcHJvY2Vzc2FyIGEgY2hhdmUgcHJpdmFkYSAocmV1dGlsaXphZGEgZG8gc2VydmnDp28gcHJpbmNpcGFsKQpmdW5jdGlvbiBwcm9jZXNzUHJpdmF0ZUtleShrZXk6IHN0cmluZyk6IHN0cmluZyB7CiAgaWYgKCFrZXkpIHsKICAgIHRocm93IG5ldyBFcnJvcigiR09PR0xFX1BSSVZBVEVfS0VZIG7Do28gZXN0w6EgZGVmaW5pZGEiKQogIH0KCiAgbGV0IHByb2Nlc3NlZEtleSA9IGtleS50cmltKCkKICBpZiAocHJvY2Vzc2VkS2V5LnN0YXJ0c1dpdGgoJyInKSAmJiBwcm9jZXNzZWRLZXkuZW5kc1dpdGgoJyInKSkgewogICAgcHJvY2Vzc2VkS2V5ID0gcHJvY2Vzc2VkS2V5LnNsaWNlKDEsIC0xKQogIH0KCiAgaWYgKCFwcm9jZXNzZWRLZXkuaW5jbHVkZXMoIlxuIikgJiYgIXByb2Nlc3NlZEtleS5pbmNsdWRlcygiXFxuIikpIHsKICAgIGNvbnN0IGJlZ2luTWFya2VyID0gIi0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLSIKICAgIGNvbnN0IGVuZE1hcmtlciA9ICItLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tIgoKICAgIGlmIChwcm9jZXNzZWRLZXkuaW5jbHVkZXMoYmVnaW5NYXJrZXIpICYmIHByb2Nlc3NlZEtleS5pbmNsdWRlcyhlbmRNYXJrZXIpKSB7CiAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBwcm9jZXNzZWRLZXkuaW5kZXhPZihiZWdpbk1hcmtlcikgKyBiZWdpbk1hcmtlci5sZW5ndGgKICAgICAgY29uc3QgZW5kSW5kZXggPSBwcm9jZXNzZWRLZXkuaW5kZXhPZihlbmRNYXJrZXIpCiAgICAgIGNvbnN0IGNvbnRlbnQgPSBwcm9jZXNzZWRLZXkuc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIGVuZEluZGV4KQoKICAgICAgY29uc3QgbGluZXMgPSBbXQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRlbnQubGVuZ3RoOyBpICs9IDY0KSB7CiAgICAgICAgbGluZXMucHVzaChjb250ZW50LnN1YnN0cmluZyhpLCBpICsgNjQpKQogICAgICB9CgogICAgICBwcm9jZXNzZWRLZXkgPSBiZWdpbk1hcmtlciArICJcbiIgKyBsaW5lcy5qb2luKCJcbiIpICsgIlxuIiArIGVuZE1hcmtlcgogICAgfQogIH0gZWxzZSB7CiAgICBwcm9jZXNzZWRLZXkgPSBwcm9jZXNzZWRLZXkucmVwbGFjZSgvXFxuL2csICJcbiIpCiAgfQoKICBpZiAoIXByb2Nlc3NlZEtleS5pbmNsdWRlcygiLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tIikpIHsKICAgIHRocm93IG5ldyBFcnJvcigiRm9ybWF0byBkYSBjaGF2ZSBwcml2YWRhIGludsOhbGlkbzogbWFyY2Fkb3IgQkVHSU4gbsOjbyBlbmNvbnRyYWRvIikKICB9CgogIGlmICghcHJvY2Vzc2VkS2V5LmluY2x1ZGVzKCItLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tIikpIHsKICAgIHRocm93IG5ldyBFcnJvcigiRm9ybWF0byBkYSBjaGF2ZSBwcml2YWRhIGludsOhbGlkbzogbWFyY2Fkb3IgRU5EIG7Do28gZW5jb250cmFkbyIpCiAgfQoKICByZXR1cm4gcHJvY2Vzc2VkS2V5Cn0KCi8vIENvbmZpZ3VyYcOnw6NvIGRvIGNsaWVudGUgSldUIHBhcmEgYSBwbGFuaWxoYSBkZSBwcm9kdXRvcwpsZXQgcHJvZHVjdHNTZXJ2aWNlQWNjb3VudEF1dGg6IEpXVAoKdHJ5IHsKICBjb25zdCBwcml2YXRlS2V5ID0gcHJvY2Vzc1ByaXZhdGVLZXkocHJvY2Vzcy5lbnYuR09PR0xFX1BSSVZBVEVfS0VZIHx8ICIiKQoKICBwcm9kdWN0c1NlcnZpY2VBY2NvdW50QXV0aCA9IG5ldyBKV1QoewogICAgZW1haWw6IHByb2Nlc3MuZW52LkdPT0dMRV9TRVJWSUNFX0FDQ09VTlRfRU1BSUwsCiAgICBrZXk6IHByaXZhdGVLZXksCiAgICBzY29wZXM6IFsiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9zcHJlYWRzaGVldHMiLCAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9kcml2ZS5maWxlIl0sCiAgfSkKfSBjYXRjaCAoZXJyb3IpIHsKICBjb25zb2xlLmVycm9yKCJFcnJvIGFvIGNvbmZpZ3VyYXIgYXV0ZW50aWNhw6fDo28gR29vZ2xlIHBhcmEgcHJvZHV0b3M6IiwgZXJyb3IpCiAgdGhyb3cgZXJyb3IKfQoKLy8gSW5zdMOibmNpYSBkbyBkb2N1bWVudG8gR29vZ2xlIFNoZWV0cyBwYXJhIHByb2R1dG9zCmNvbnN0IHByb2R1Y3RzRG9jID0gbmV3IEdvb2dsZVNwcmVhZHNoZWV0KHByb2Nlc3MuZW52LkdPT0dMRV9QUk9EVUNUU19TSEVFVF9JRCEsIHByb2R1Y3RzU2VydmljZUFjY291bnRBdXRoKQoKZXhwb3J0IGludGVyZmFjZSBQcm9kdWN0Um93IHsKICBlYW46IHN0cmluZyAvLyBDb2x1bmEgQSAtIEVBTiByZWFsCiAgZGVzY3JpcHRpb246IHN0cmluZyAvLyBDb2x1bmEgQiAtIERlc2NyacOnw6NvCiAgYnJhbmQ6IHN0cmluZyAvLyBDb2x1bmEgQyAtIE1hcmNhCiAgY2F0ZWdvcnk6IHN0cmluZyAvLyBDb2x1bmEgRCAtIENhdGVnb3JpYQogIGlkOiBzdHJpbmcgLy8gQ29sdW5hIEUgLSBJRCAoYW50aWdvIEVBTikKICBjbGFzc2lmaWNhdGlvbjogc3RyaW5nIC8vIENvbHVuYSBGIC0gVGlwaWZpY2HDp8Ojbwp9CgpjbGFzcyBQcm9kdWN0c1NoZWV0c1NlcnZpY2UgewogIHByaXZhdGUgaW5pdGlhbGl6ZWQgPSBmYWxzZQogIHByaXZhdGUgaW5pdFByb21pc2U6IFByb21pc2U8dm9pZD4gfCBudWxsID0gbnVsbAoKICBnZXQgZG9jKCkgewogICAgcmV0dXJuIHByb2R1Y3RzRG9jCiAgfQoKICBhc3luYyBpbml0KCkgewogICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHJldHVybgogICAgaWYgKHRoaXMuaW5pdFByb21pc2UpIHJldHVybiB0aGlzLmluaXRQcm9taXNlCgogICAgdGhpcy5pbml0UHJvbWlzZSA9IHRoaXMuX2luaXQoKQogICAgcmV0dXJuIHRoaXMuaW5pdFByb21pc2UKICB9CgogIHByaXZhdGUgYXN5bmMgX2luaXQoKSB7CiAgICB0cnkgewogICAgICBjb25zb2xlLmxvZygiW1BST0RVQ1RTXSBJbmljaWFsaXphbmRvIGNvbmV4w6NvIGNvbSBHb29nbGUgU2hlZXRzLi4uIikKICAgICAgYXdhaXQgcHJvZHVjdHNEb2MubG9hZEluZm8oKQogICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDinIUgUGxhbmlsaGEgY2FycmVnYWRhOiAke3Byb2R1Y3RzRG9jLnRpdGxlfWApCiAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIE7Dum1lcm8gZGUgYWJhczogJHtwcm9kdWN0c0RvYy5zaGVldENvdW50fWApCgogICAgICAvLyBMaXN0YXIgdG9kYXMgYXMgYWJhcyBkaXNwb27DrXZlaXMKICAgICAgcHJvZHVjdHNEb2Muc2hlZXRzQnlJbmRleC5mb3JFYWNoKChzaGVldCwgaW5kZXgpID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSBBYmEgJHtpbmRleH06ICR7c2hlZXQudGl0bGV9ICgke3NoZWV0LnJvd0NvdW50fSBsaW5oYXMsICR7c2hlZXQuY29sdW1uQ291bnR9IGNvbHVuYXMpYCkKICAgICAgfSkKCiAgICAgIC8vIFZlcmlmaWNhciBzZSBhIGFiYSAiRUFOIiBleGlzdGUKICAgICAgY29uc3QgZWFuU2hlZXQgPSBwcm9kdWN0c0RvYy5zaGVldHNCeVRpdGxlWyJFQU4iXQogICAgICBpZiAoIWVhblNoZWV0KSB7CiAgICAgICAgY29uc29sZS5lcnJvcignW1BST0RVQ1RTXSDinYwgQWJhICJFQU4iIG7Do28gZW5jb250cmFkYSEnKQogICAgICAgIHRocm93IG5ldyBFcnJvcignQWJhICJFQU4iIG7Do28gZW5jb250cmFkYSBuYSBwbGFuaWxoYSBkZSBwcm9kdXRvcycpCiAgICAgIH0KCiAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIOKchSBBYmEgIkVBTiIgZW5jb250cmFkYSBjb20gJHtlYW5TaGVldC5yb3dDb3VudH0gbGluaGFzYCkKICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWUKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm8gYW8gaW5pY2lhbGl6YXIgcGxhbmlsaGEgZGUgcHJvZHV0b3M6IiwgZXJyb3IpCiAgICAgIHRoaXMuaW5pdFByb21pc2UgPSBudWxsCiAgICAgIHRocm93IGVycm9yCiAgICB9CiAgfQoKICBwcml2YXRlIG5vcm1hbGl6ZVNlYXJjaFRlcm0odGVybTogc3RyaW5nKTogc3RyaW5nIHsKICAgIHJldHVybiB0ZXJtLnRvU3RyaW5nKCkudHJpbSgpLnRvTG93ZXJDYXNlKCkKICB9CgogIHByaXZhdGUgY3JlYXRlUHJvZHVjdEZyb21Sb3cocm93OiBhbnkpOiBQcm9kdWN0Um93IHsKICAgIC8vIFZlcmlmaWNhciBzZSByb3cuX3Jhd0RhdGEgZXhpc3RlIGUgdGVtIGRhZG9zCiAgICBpZiAoIXJvdy5fcmF3RGF0YSB8fCByb3cuX3Jhd0RhdGEubGVuZ3RoID09PSAwKSB7CiAgICAgIGNvbnNvbGUud2FybigiW1BST0RVQ1RTXSBSb3cgc2VtIF9yYXdEYXRhOiIsIHJvdykKICAgICAgcmV0dXJuIHsKICAgICAgICBlYW46ICIiLAogICAgICAgIGRlc2NyaXB0aW9uOiAiIiwKICAgICAgICBicmFuZDogIiIsCiAgICAgICAgY2F0ZWdvcnk6ICIiLAogICAgICAgIGlkOiAiIiwKICAgICAgICBjbGFzc2lmaWNhdGlvbjogIiIsCiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICBlYW46IChyb3cuX3Jhd0RhdGFbMF0gfHwgIiIpLnRvU3RyaW5nKCkudHJpbSgpLAogICAgICBkZXNjcmlwdGlvbjogKHJvdy5fcmF3RGF0YVsxXSB8fCAiIikudG9TdHJpbmcoKS50cmltKCksCiAgICAgIGJyYW5kOiAocm93Ll9yYXdEYXRhWzJdIHx8ICIiKS50b1N0cmluZygpLnRyaW0oKSwKICAgICAgY2F0ZWdvcnk6IChyb3cuX3Jhd0RhdGFbM10gfHwgIiIpLnRvU3RyaW5nKCkudHJpbSgpLAogICAgICBpZDogKHJvdy5fcmF3RGF0YVs0XSB8fCAiIikudG9TdHJpbmcoKS50cmltKCksCiAgICAgIGNsYXNzaWZpY2F0aW9uOiAocm93Ll9yYXdEYXRhWzVdIHx8ICIiKS50b1N0cmluZygpLnRyaW0oKSwKICAgIH0KICB9CgogIGFzeW5jIGZpbmRBbGxQcm9kdWN0c0J5RUFOKGVhbjogc3RyaW5nKTogUHJvbWlzZTxQcm9kdWN0Um93W10+IHsKICAgIHJldHVybiBwZXJmb3JtYW5jZU1vbml0b3IudHJhY2tPcGVyYXRpb24oImZpbmRBbGxQcm9kdWN0c0J5RUFOIiwgYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWVhbiB8fCBlYW4udHJpbSgpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGNvbnNvbGUubG9nKCJbUFJPRFVDVFNdIOKdjCBFQU4gdmF6aW8gZm9ybmVjaWRvIikKICAgICAgICByZXR1cm4gW10KICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFsaXplZEVBTiA9IHRoaXMubm9ybWFsaXplU2VhcmNoVGVybShlYW4pCiAgICAgIGNvbnN0IGNhY2hlS2V5ID0gQ0FDSEVfS0VZUy5QUk9EVUNUX0JZX0VBTihgJHtub3JtYWxpemVkRUFOfTphbGxgKQoKICAgICAgLy8gVGVudGFyIGJ1c2NhciBkbyBjYWNoZSBwcmltZWlybwogICAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCByZWRpc0NhY2hlLmdldDxQcm9kdWN0Um93W10+KGNhY2hlS2V5KQogICAgICBpZiAoY2FjaGVkKSB7CiAgICAgICAgcGVyZm9ybWFuY2VNb25pdG9yLnJlY29yZENhY2hlSGl0KCkKICAgICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDinIUgQ2FjaGUgaGl0IHBhcmEgRUFOOiAiJHtub3JtYWxpemVkRUFOfSIgLSAke2NhY2hlZC5sZW5ndGh9IHByb2R1dG9zYCkKICAgICAgICByZXR1cm4gY2FjaGVkCiAgICAgIH0KCiAgICAgIHBlcmZvcm1hbmNlTW9uaXRvci5yZWNvcmRDYWNoZU1pc3MoKQogICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDwn5K+IENhY2hlIG1pc3MgLSBCdXNjYW5kbyBUT0RPUyBvcyBwcm9kdXRvcyBwb3IgRUFOOiAiJHtub3JtYWxpemVkRUFOfSJgKQoKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCB0aGlzLmluaXQoKQoKICAgICAgICBjb25zdCBzaGVldCA9IHByb2R1Y3RzRG9jLnNoZWV0c0J5VGl0bGVbIkVBTiJdCiAgICAgICAgaWYgKCFzaGVldCkgewogICAgICAgICAgY29uc29sZS5lcnJvcignW1BST0RVQ1RTXSDinYwgQWJhICJFQU4iIG7Do28gZW5jb250cmFkYSBuYSBwbGFuaWxoYSBkZSBwcm9kdXRvcycpCiAgICAgICAgICByZXR1cm4gW10KICAgICAgICB9CgogICAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIPCfk4ogQ2FycmVnYW5kbyBsaW5oYXMgZGEgcGxhbmlsaGEuLi5gKQogICAgICAgIGNvbnN0IHJvd3MgPSBhd2FpdCBzaGVldC5nZXRSb3dzKCkKICAgICAgICBjb25zdCBwcm9kdWN0czogUHJvZHVjdFJvd1tdID0gW10KCiAgICAgICAgY29uc29sZS5sb2coYFtQUk9EVUNUU10g8J+UjSBCdXNjYW5kbyBFQU46ICIke25vcm1hbGl6ZWRFQU59IiBlbSAke3Jvd3MubGVuZ3RofSBsaW5oYXNgKQoKICAgICAgICAvLyBCdXNjYXIgVE9ET1Mgb3MgcHJvZHV0b3MgY29tIG8gbWVzbW8gRUFOIG5hIGNvbHVuYSBBCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBjb25zdCByb3cgPSByb3dzW2ldCgogICAgICAgICAgLy8gVmVyaWZpY2FyIHNlIGEgbGluaGEgdGVtIGRhZG9zCiAgICAgICAgICBpZiAoIXJvdy5fcmF3RGF0YSB8fCByb3cuX3Jhd0RhdGEubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgZWFuSW5Db2x1bW5BID0gdGhpcy5ub3JtYWxpemVTZWFyY2hUZXJtKHJvdy5fcmF3RGF0YVswXSB8fCAiIikKCiAgICAgICAgICAvLyBEZWJ1ZzogbG9nIGRhcyBwcmltZWlyYXMgNSBsaW5oYXMgcGFyYSB2ZXJpZmljYXIgZm9ybWF0bwogICAgICAgICAgaWYgKGkgPCA1KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKAogICAgICAgICAgICAgIGBbUFJPRFVDVFNdIPCflI0gTGluaGEgJHtpICsgMX06IEVBTj0iJHtlYW5JbkNvbHVtbkF9IiAob3JpZ2luYWw6ICIke3Jvdy5fcmF3RGF0YVswXX0iKSwgY29tcGFyYW5kbyBjb20gIiR7bm9ybWFsaXplZEVBTn0iYCwKICAgICAgICAgICAgKQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChlYW5JbkNvbHVtbkEgPT09IG5vcm1hbGl6ZWRFQU4pIHsKICAgICAgICAgICAgY29uc3QgcHJvZHVjdCA9IHRoaXMuY3JlYXRlUHJvZHVjdEZyb21Sb3cocm93KQoKICAgICAgICAgICAgLy8gVmVyaWZpY2FyIHNlIG8gcHJvZHV0byB0ZW0gZGFkb3MgdsOhbGlkb3MKICAgICAgICAgICAgaWYgKHByb2R1Y3QuZWFuIHx8IHByb2R1Y3QuaWQgfHwgcHJvZHVjdC5kZXNjcmlwdGlvbikgewogICAgICAgICAgICAgIHByb2R1Y3RzLnB1c2gocHJvZHVjdCkKCiAgICAgICAgICAgICAgaWYgKHByb2R1Y3RzLmxlbmd0aCA8PSAzKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDinIUgUHJvZHV0byAke3Byb2R1Y3RzLmxlbmd0aH0gZW5jb250cmFkbyBuYSBsaW5oYSAke2kgKyAxfTpgLCB7CiAgICAgICAgICAgICAgICAgIGVhbjogcHJvZHVjdC5lYW4sCiAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLAogICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogcHJvZHVjdC5kZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgNTApICsgIi4uLiIsCiAgICAgICAgICAgICAgICAgIGJyYW5kOiBwcm9kdWN0LmJyYW5kLAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIOKchSBUb3RhbCBkZSAke3Byb2R1Y3RzLmxlbmd0aH0gcHJvZHV0b3MgZW5jb250cmFkb3MgcGFyYSBFQU46ICIke2Vhbn0iYCkKCiAgICAgICAgLy8gU2FsdmFyIG5vIGNhY2hlCiAgICAgICAgYXdhaXQgcmVkaXNDYWNoZS5zZXQoY2FjaGVLZXksIHByb2R1Y3RzLCBDQUNIRV9UVEwuTE9ORykKCiAgICAgICAgLy8gQ2FjaGUgdGFtYsOpbSBvIHByaW1laXJvIHByb2R1dG8gaW5kaXZpZHVhbG1lbnRlIHBhcmEgY29tcGF0aWJpbGlkYWRlCiAgICAgICAgaWYgKHByb2R1Y3RzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGF3YWl0IHJlZGlzQ2FjaGUuc2V0KENBQ0hFX0tFWVMuUFJPRFVDVF9CWV9FQU4obm9ybWFsaXplZEVBTiksIHByb2R1Y3RzWzBdLCBDQUNIRV9UVEwuTE9ORykKICAgICAgICB9CgogICAgICAgIHJldHVybiBwcm9kdWN0cwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm8gYW8gYnVzY2FyIHRvZG9zIG9zIHByb2R1dG9zIHBvciBFQU46IiwgZXJyb3IpCiAgICAgICAgcmV0dXJuIFtdCiAgICAgIH0KICAgIH0pCiAgfQoKICBhc3luYyBmaW5kUHJvZHVjdEJ5RUFOKGVhbjogc3RyaW5nKTogUHJvbWlzZTxQcm9kdWN0Um93IHwgbnVsbD4gewogICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCB0aGlzLmZpbmRBbGxQcm9kdWN0c0J5RUFOKGVhbikKICAgIHJldHVybiBwcm9kdWN0cy5sZW5ndGggPiAwID8gcHJvZHVjdHNbMF0gOiBudWxsCiAgfQoKICBhc3luYyBmaW5kUHJvZHVjdEJ5SUQoaWQ6IHN0cmluZyk6IFByb21pc2U8UHJvZHVjdFJvdyB8IG51bGw+IHsKICAgIHJldHVybiBwZXJmb3JtYW5jZU1vbml0b3IudHJhY2tPcGVyYXRpb24oImZpbmRQcm9kdWN0QnlJRCIsIGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFpZCB8fCBpZC50cmltKCkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY29uc29sZS5sb2coIltQUk9EVUNUU10g4p2MIElEIHZhemlvIGZvcm5lY2lkbyIpCiAgICAgICAgcmV0dXJuIG51bGwKICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFsaXplZElEID0gaWQudG9TdHJpbmcoKS50cmltKCkKICAgICAgY29uc3QgY2FjaGVLZXkgPSBDQUNIRV9LRVlTLlBST0RVQ1RfQllfSUQobm9ybWFsaXplZElEKQoKICAgICAgLy8gVGVudGFyIGJ1c2NhciBkbyBjYWNoZSBwcmltZWlybwogICAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCByZWRpc0NhY2hlLmdldDxQcm9kdWN0Um93PihjYWNoZUtleSkKICAgICAgaWYgKGNhY2hlZCkgewogICAgICAgIHBlcmZvcm1hbmNlTW9uaXRvci5yZWNvcmRDYWNoZUhpdCgpCiAgICAgICAgY29uc29sZS5sb2coYFtQUk9EVUNUU10g4pyFIENhY2hlIGhpdCBwYXJhIElEOiAiJHtub3JtYWxpemVkSUR9ImApCiAgICAgICAgcmV0dXJuIGNhY2hlZAogICAgICB9CgogICAgICBwZXJmb3JtYW5jZU1vbml0b3IucmVjb3JkQ2FjaGVNaXNzKCkKICAgICAgY29uc29sZS5sb2coYFtQUk9EVUNUU10g8J+SviBDYWNoZSBtaXNzIC0gQnVzY2FuZG8gcHJvZHV0byBwb3IgSUQ6ICIke25vcm1hbGl6ZWRJRH0iYCkKCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgdGhpcy5pbml0KCkKCiAgICAgICAgY29uc3Qgc2hlZXQgPSBwcm9kdWN0c0RvYy5zaGVldHNCeVRpdGxlWyJFQU4iXQogICAgICAgIGlmICghc2hlZXQpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tQUk9EVUNUU10g4p2MIEFiYSAiRUFOIiBuw6NvIGVuY29udHJhZGEgbmEgcGxhbmlsaGEgZGUgcHJvZHV0b3MnKQogICAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICB9CgogICAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIPCfk4ogQ2FycmVnYW5kbyBsaW5oYXMgZGEgcGxhbmlsaGEgcGFyYSBidXNjYSBwb3IgSUQuLi5gKQogICAgICAgIGNvbnN0IHJvd3MgPSBhd2FpdCBzaGVldC5nZXRSb3dzKCkKICAgICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSBUb3RhbCBkZSBsaW5oYXMgY2FycmVnYWRhczogJHtyb3dzLmxlbmd0aH1gKQoKICAgICAgICAvLyBCdXNjYXIgbmEgY29sdW5hIEUgKElEKSAtIHF1ZSDDqSBvIMOtbmRpY2UgNAogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3Qgcm93ID0gcm93c1tpXQoKICAgICAgICAgIC8vIFZlcmlmaWNhciBzZSBhIGxpbmhhIHRlbSBkYWRvcwogICAgICAgICAgaWYgKCFyb3cuX3Jhd0RhdGEgfHwgcm93Ll9yYXdEYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGlkSW5Db2x1bW5FID0gKHJvdy5fcmF3RGF0YVs0XSB8fCAiIikudG9TdHJpbmcoKS50cmltKCkKCiAgICAgICAgICAvLyBEZWJ1ZzogbG9nIGRhcyBwcmltZWlyYXMgNSBsaW5oYXMgcGFyYSB2ZXJpZmljYXIgZm9ybWF0bwogICAgICAgICAgaWYgKGkgPCA1KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKAogICAgICAgICAgICAgIGBbUFJPRFVDVFNdIPCflI0gTGluaGEgJHtpICsgMX06IElEPSIke2lkSW5Db2x1bW5FfSIgKGNvbHVuYSBFKSwgY29tcGFyYW5kbyBjb20gIiR7bm9ybWFsaXplZElEfSJgLAogICAgICAgICAgICApCiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGlkSW5Db2x1bW5FID09PSBub3JtYWxpemVkSUQpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYFtQUk9EVUNUU10g4pyFIFByb2R1dG8gZW5jb250cmFkbyBwb3IgSUQgbmEgbGluaGEgJHtpICsgMX0hYCkKCiAgICAgICAgICAgIGNvbnN0IHByb2R1Y3QgPSB0aGlzLmNyZWF0ZVByb2R1Y3RGcm9tUm93KHJvdykKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIFByb2R1dG8gcmV0b3JuYWRvIHBvciBJRDpgLCB7CiAgICAgICAgICAgICAgZWFuOiBwcm9kdWN0LmVhbiwKICAgICAgICAgICAgICBpZDogcHJvZHVjdC5pZCwKICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogcHJvZHVjdC5kZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgNTApICsgIi4uLiIsCiAgICAgICAgICAgICAgYnJhbmQ6IHByb2R1Y3QuYnJhbmQsCiAgICAgICAgICAgIH0pCgogICAgICAgICAgICAvLyBTYWx2YXIgbm8gY2FjaGUKICAgICAgICAgICAgYXdhaXQgcmVkaXNDYWNoZS5zZXQoY2FjaGVLZXksIHByb2R1Y3QsIENBQ0hFX1RUTC5MT05HKQoKICAgICAgICAgICAgLy8gQ2FjaGUgdGFtYsOpbSBwb3IgRUFOIHNlIGRpc3BvbsOtdmVsCiAgICAgICAgICAgIGlmIChwcm9kdWN0LmVhbikgewogICAgICAgICAgICAgIGF3YWl0IHJlZGlzQ2FjaGUuc2V0KENBQ0hFX0tFWVMuUFJPRFVDVF9CWV9FQU4ocHJvZHVjdC5lYW4pLCBwcm9kdWN0LCBDQUNIRV9UVEwuTE9ORykKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHByb2R1Y3QKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIOKdjCBQcm9kdXRvIG7Do28gZW5jb250cmFkbyBwYXJhIElEOiAiJHtub3JtYWxpemVkSUR9ImApCiAgICAgICAgLy8gQ2FjaGUgbmVnYXRpdmUgcmVzdWx0IGZvciBzaG9ydCB0aW1lCiAgICAgICAgYXdhaXQgcmVkaXNDYWNoZS5zZXQoY2FjaGVLZXksIG51bGwsIENBQ0hFX1RUTC5TSE9SVCkKICAgICAgICByZXR1cm4gbnVsbAogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm8gYW8gYnVzY2FyIHByb2R1dG8gcG9yIElEOiIsIGVycm9yKQogICAgICAgIHJldHVybiBudWxsCiAgICAgIH0KICAgIH0pCiAgfQoKICBhc3luYyBzZWFyY2hQcm9kdWN0cyhxdWVyeTogc3RyaW5nLCBsaW1pdCA9IDEwKTogUHJvbWlzZTxQcm9kdWN0Um93W10+IHsKICAgIHJldHVybiBwZXJmb3JtYW5jZU1vbml0b3IudHJhY2tPcGVyYXRpb24oInNlYXJjaFByb2R1Y3RzIiwgYXN5bmMgKCkgPT4gewogICAgICBpZiAoIXF1ZXJ5IHx8IHF1ZXJ5LnRyaW0oKS5sZW5ndGggPCAyKSB7CiAgICAgICAgY29uc29sZS5sb2coIltQUk9EVUNUU10g4p2MIFF1ZXJ5IG11aXRvIGN1cnRhIG91IHZhemlhIikKICAgICAgICByZXR1cm4gW10KICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFsaXplZFF1ZXJ5ID0gdGhpcy5ub3JtYWxpemVTZWFyY2hUZXJtKHF1ZXJ5KQogICAgICBjb25zdCBjYWNoZUtleSA9IENBQ0hFX0tFWVMuUFJPRFVDVF9TRUFSQ0goYCR7bm9ybWFsaXplZFF1ZXJ5fToke2xpbWl0fWApCgogICAgICAvLyBUZW50YXIgYnVzY2FyIGRvIGNhY2hlIHByaW1laXJvCiAgICAgIGNvbnN0IGNhY2hlZCA9IGF3YWl0IHJlZGlzQ2FjaGUuZ2V0PFByb2R1Y3RSb3dbXT4oY2FjaGVLZXkpCiAgICAgIGlmIChjYWNoZWQpIHsKICAgICAgICBwZXJmb3JtYW5jZU1vbml0b3IucmVjb3JkQ2FjaGVIaXQoKQogICAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIOKchSBDYWNoZSBoaXQgcGFyYSBxdWVyeTogIiR7bm9ybWFsaXplZFF1ZXJ5fSIgLSAke2NhY2hlZC5sZW5ndGh9IHByb2R1dG9zYCkKICAgICAgICByZXR1cm4gY2FjaGVkCiAgICAgIH0KCiAgICAgIHBlcmZvcm1hbmNlTW9uaXRvci5yZWNvcmRDYWNoZU1pc3MoKQogICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDwn5K+IENhY2hlIG1pc3MgLSBCdXNjYW5kbyBwcm9kdXRvcyBwb3IgcXVlcnk6ICIke25vcm1hbGl6ZWRRdWVyeX0iIChsaW1pdDogJHtsaW1pdH0pYCkKCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgdGhpcy5pbml0KCkKCiAgICAgICAgY29uc3Qgc2hlZXQgPSBwcm9kdWN0c0RvYy5zaGVldHNCeVRpdGxlWyJFQU4iXQogICAgICAgIGlmICghc2hlZXQpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tQUk9EVUNUU10g4p2MIEFiYSAiRUFOIiBuw6NvIGVuY29udHJhZGEgbmEgcGxhbmlsaGEgZGUgcHJvZHV0b3MnKQogICAgICAgICAgcmV0dXJuIFtdCiAgICAgICAgfQoKICAgICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDwn5OKIENhcnJlZ2FuZG8gbGluaGFzIGRhIHBsYW5pbGhhIHBhcmEgYnVzY2EuLi5gKQogICAgICAgIGNvbnN0IHJvd3MgPSBhd2FpdCBzaGVldC5nZXRSb3dzKCkKICAgICAgICBjb25zdCByZXN1bHRzOiBQcm9kdWN0Um93W10gPSBbXQoKICAgICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDwn5SNIEJ1c2NhbmRvIHF1ZXJ5OiAiJHtub3JtYWxpemVkUXVlcnl9IiBlbSAke3Jvd3MubGVuZ3RofSBsaW5oYXNgKQoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA+PSBsaW1pdCkgYnJlYWsKCiAgICAgICAgICBjb25zdCByb3cgPSByb3dzW2ldCgogICAgICAgICAgLy8gVmVyaWZpY2FyIHNlIGEgbGluaGEgdGVtIGRhZG9zCiAgICAgICAgICBpZiAoIXJvdy5fcmF3RGF0YSB8fCByb3cuX3Jhd0RhdGEubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgcHJvZHVjdCA9IHRoaXMuY3JlYXRlUHJvZHVjdEZyb21Sb3cocm93KQoKICAgICAgICAgIC8vIFB1bGFyIHByb2R1dG9zIHNlbSBkYWRvcyB2w6FsaWRvcwogICAgICAgICAgaWYgKCFwcm9kdWN0LmVhbiAmJiAhcHJvZHVjdC5pZCAmJiAhcHJvZHVjdC5kZXNjcmlwdGlvbikgewogICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgfQoKICAgICAgICAgIC8vIEJ1c2NhciBwb3IgRUFOLCBJRCwgZGVzY3Jpw6fDo28gb3UgbWFyY2EgKGNhc2UgaW5zZW5zaXRpdmUpCiAgICAgICAgICBjb25zdCBzZWFyY2hGaWVsZHMgPSBbCiAgICAgICAgICAgIHByb2R1Y3QuZWFuLnRvTG93ZXJDYXNlKCksCiAgICAgICAgICAgIHByb2R1Y3QuaWQudG9Mb3dlckNhc2UoKSwKICAgICAgICAgICAgcHJvZHVjdC5kZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLAogICAgICAgICAgICBwcm9kdWN0LmJyYW5kLnRvTG93ZXJDYXNlKCksCiAgICAgICAgICBdCgogICAgICAgICAgY29uc3QgbWF0Y2hGb3VuZCA9IHNlYXJjaEZpZWxkcy5zb21lKChmaWVsZCkgPT4gZmllbGQuaW5jbHVkZXMobm9ybWFsaXplZFF1ZXJ5KSkKCiAgICAgICAgICBpZiAobWF0Y2hGb3VuZCkgewogICAgICAgICAgICByZXN1bHRzLnB1c2gocHJvZHVjdCkKCiAgICAgICAgICAgIC8vIERlYnVnOiBsb2cgZG9zIHByaW1laXJvcyAzIHJlc3VsdGFkb3MKICAgICAgICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoIDw9IDMpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDinIUgUmVzdWx0YWRvICR7cmVzdWx0cy5sZW5ndGh9IGVuY29udHJhZG86YCwgewogICAgICAgICAgICAgICAgZWFuOiBwcm9kdWN0LmVhbiwKICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHByb2R1Y3QuZGVzY3JpcHRpb24uc3Vic3RyaW5nKDAsIDMwKSArICIuLi4iLAogICAgICAgICAgICAgICAgbWF0Y2hlZEZpZWxkczogc2VhcmNoRmllbGRzLmZpbHRlcigoZmllbGQpID0+IGZpZWxkLmluY2x1ZGVzKG5vcm1hbGl6ZWRRdWVyeSkpLAogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIOKchSAke3Jlc3VsdHMubGVuZ3RofSBwcm9kdXRvcyBlbmNvbnRyYWRvcyBwYXJhIHF1ZXJ5OiAiJHtxdWVyeX0iYCkKCiAgICAgICAgLy8gU2FsdmFyIG5vIGNhY2hlCiAgICAgICAgYXdhaXQgcmVkaXNDYWNoZS5zZXQoY2FjaGVLZXksIHJlc3VsdHMsIENBQ0hFX1RUTC5NRURJVU0pCgogICAgICAgIHJldHVybiByZXN1bHRzCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiRXJybyBhbyBidXNjYXIgcHJvZHV0b3M6IiwgZXJyb3IpCiAgICAgICAgcmV0dXJuIFtdCiAgICAgIH0KICAgIH0pCiAgfQoKICAvLyBNw6l0b2RvIHBhcmEgaW52YWxpZGFyIGNhY2hlIGRlIHByb2R1dG9zICjDunRpbCBzZSBob3V2ZXIgYXR1YWxpemHDp8O1ZXMpCiAgYXN5bmMgaW52YWxpZGF0ZUNhY2hlKCk6IFByb21pc2U8dm9pZD4gewogICAgY29uc29sZS5sb2coIltQUk9EVUNUU10gSW52YWxpZGFuZG8gY2FjaGUgZGUgcHJvZHV0b3MuLi4iKQogICAgYXdhaXQgcmVkaXNDYWNoZS5kZWxQYXR0ZXJuKENBQ0hFX0tFWVMuUEFUVEVSTlMuUFJPRFVDVFMpCiAgICBjb25zb2xlLmxvZygiW1BST0RVQ1RTXSDinIUgQ2FjaGUgZGUgcHJvZHV0b3MgaW52YWxpZGFkbyIpCiAgfQoKICAvLyBNw6l0b2RvIHBhcmEgdmVyaWZpY2FyIGEgc2HDumRlIGRhIGNvbmV4w6NvCiAgYXN5bmMgaGVhbHRoQ2hlY2soKTogUHJvbWlzZTx7IHN0YXR1czogc3RyaW5nOyBkZXRhaWxzOiBhbnkgfT4gewogICAgdHJ5IHsKICAgICAgYXdhaXQgdGhpcy5pbml0KCkKICAgICAgY29uc3Qgc2hlZXQgPSBwcm9kdWN0c0RvYy5zaGVldHNCeVRpdGxlWyJFQU4iXQoKICAgICAgaWYgKCFzaGVldCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBzdGF0dXM6ICJlcnJvciIsCiAgICAgICAgICBkZXRhaWxzOiB7IG1lc3NhZ2U6ICdBYmEgIkVBTiIgbsOjbyBlbmNvbnRyYWRhJyB9LAogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBzdGF0dXM6ICJvayIsCiAgICAgICAgZGV0YWlsczogewogICAgICAgICAgc2hlZXRUaXRsZTogcHJvZHVjdHNEb2MudGl0bGUsCiAgICAgICAgICByb3dDb3VudDogc2hlZXQucm93Q291bnQsCiAgICAgICAgICBjb2x1bW5Db3VudDogc2hlZXQuY29sdW1uQ291bnQsCiAgICAgICAgICBpbml0aWFsaXplZDogdGhpcy5pbml0aWFsaXplZCwKICAgICAgICB9LAogICAgICB9CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICByZXR1cm4gewogICAgICAgIHN0YXR1czogImVycm9yIiwKICAgICAgICBkZXRhaWxzOiB7CiAgICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICJFcnJvIGRlc2NvbmhlY2lkbyIsCiAgICAgICAgICBpbml0aWFsaXplZDogdGhpcy5pbml0aWFsaXplZCwKICAgICAgICB9LAogICAgICB9CiAgICB9CiAgfQoKICAvLyBNw6l0b2RvIHBhcmEgZGVidWcgLSB2ZXJpZmljYXIgZXN0cnV0dXJhIGRhIHBsYW5pbGhhCiAgYXN5bmMgZGVidWdTaGVldFN0cnVjdHVyZSgpOiBQcm9taXNlPHZvaWQ+IHsKICAgIHRyeSB7CiAgICAgIGF3YWl0IHRoaXMuaW5pdCgpCiAgICAgIGNvbnN0IHNoZWV0ID0gcHJvZHVjdHNEb2Muc2hlZXRzQnlUaXRsZVsiRUFOIl0KCiAgICAgIGlmICghc2hlZXQpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdbUFJPRFVDVFNdIOKdjCBBYmEgIkVBTiIgbsOjbyBlbmNvbnRyYWRhIHBhcmEgZGVidWcnKQogICAgICAgIHJldHVybgogICAgICB9CgogICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSDwn5SNIERFQlVHOiBFc3RydXR1cmEgZGEgcGxhbmlsaGFgKQogICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSBUw610dWxvOiAke3NoZWV0LnRpdGxlfWApCiAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIExpbmhhczogJHtzaGVldC5yb3dDb3VudH1gKQogICAgICBjb25zb2xlLmxvZyhgW1BST0RVQ1RTXSBDb2x1bmFzOiAke3NoZWV0LmNvbHVtbkNvdW50fWApCgogICAgICAvLyBDYXJyZWdhciBhbGd1bWFzIGxpbmhhcyBwYXJhIHZlcmlmaWNhciBlc3RydXR1cmEKICAgICAgY29uc3Qgcm93cyA9IGF3YWl0IHNoZWV0LmdldFJvd3MoeyBsaW1pdDogNSB9KQoKICAgICAgY29uc29sZS5sb2coYFtQUk9EVUNUU10g8J+UjSBERUJVRzogUHJpbWVpcmFzIDUgbGluaGFzOmApCiAgICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGBbUFJPRFVDVFNdIExpbmhhICR7aW5kZXggKyAxfTpgLCB7CiAgICAgICAgICByYXdEYXRhOiByb3cuX3Jhd0RhdGEsCiAgICAgICAgICBjb2x1bW5BOiByb3cuX3Jhd0RhdGE/LlswXSwKICAgICAgICAgIGNvbHVtbkI6IHJvdy5fcmF3RGF0YT8uWzFdLAogICAgICAgICAgY29sdW1uQzogcm93Ll9yYXdEYXRhPy5bMl0sCiAgICAgICAgICBjb2x1bW5EOiByb3cuX3Jhd0RhdGE/LlszXSwKICAgICAgICAgIGNvbHVtbkU6IHJvdy5fcmF3RGF0YT8uWzRdLAogICAgICAgICAgY29sdW1uRjogcm93Ll9yYXdEYXRhPy5bNV0sCiAgICAgICAgfSkKICAgICAgfSkKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIltQUk9EVUNUU10gRXJybyBubyBkZWJ1ZyBkYSBlc3RydXR1cmE6IiwgZXJyb3IpCiAgICB9CiAgfQp9CgpleHBvcnQgY29uc3QgcHJvZHVjdHNTaGVldHNTZXJ2aWNlID0gbmV3IFByb2R1Y3RzU2hlZXRzU2VydmljZSgpCg=="}