{"data":"aW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAibmV4dC9zZXJ2ZXIiDQppbXBvcnQgeyBmaW5kUHJvZHVjdEJ5RUFOIH0gZnJvbSAiQC9saWIvZGF0YSINCmltcG9ydCB7IHJlZGlzQ2FjaGUsIENBQ0hFX0tFWVMsIENBQ0hFX1RUTCB9IGZyb20gIkAvbGliL3JlZGlzLWNhY2hlIg0KDQpleHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7DQogIHRyeSB7DQogICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpDQogICAgY29uc3QgZWFuID0gc2VhcmNoUGFyYW1zLmdldCgiZWFuIikNCg0KICAgIGlmICghZWFuKSB7DQogICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICJFQU4gw6kgb2JyaWdhdMOzcmlvIiB9LCB7IHN0YXR1czogNDAwIH0pDQogICAgfQ0KDQogICAgY29uc29sZS5sb2coIvCflI0gVmVyaWZpY2FuZG8gRUFOIGR1cGxpY2FkbyAob3RpbWl6YWRvKToiLCBlYW4pDQoNCiAgICBjb25zdCBjYWNoZUtleSA9IENBQ0hFX0tFWVMuU0VBUkNIX0JZX0VBTihlYW4pDQogICAgY29uc3QgY2FjaGVkUmVzdWx0ID0gYXdhaXQgcmVkaXNDYWNoZS5nZXQoY2FjaGVLZXkpDQoNCiAgICBpZiAoY2FjaGVkUmVzdWx0ICE9PSBudWxsKSB7DQogICAgICBjb25zb2xlLmxvZygi4pyFIFJlc3VsdGFkbyBkbyBjYWNoZToiLCBjYWNoZWRSZXN1bHQpDQogICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oY2FjaGVkUmVzdWx0KQ0KICAgIH0NCg0KICAgIGNvbnN0IHNlYXJjaFJlc3VsdHMgPSBhd2FpdCBmaW5kUHJvZHVjdEJ5RUFOKGVhbikNCg0KICAgIGlmIChzZWFyY2hSZXN1bHRzLmxlbmd0aCA+IDApIHsNCiAgICAgIGNvbnN0IGxvY2F0aW9ucyA9IHNlYXJjaFJlc3VsdHMubWFwKChyZXN1bHQpID0+IHsNCiAgICAgICAgLy8gRXh0cmFpciBuw7ptZXJvIGRvIGdhbHDDo28NCiAgICAgICAgY29uc3Qgd2FyZWhvdXNlTWF0Y2ggPSByZXN1bHQud2FyZWhvdXNlTmFtZS5tYXRjaCgvKFxkKykvKQ0KICAgICAgICBjb25zdCB3YXJlaG91c2VOdW1iZXIgPSB3YXJlaG91c2VNYXRjaCA/IHdhcmVob3VzZU1hdGNoWzFdIDogIj8iDQoNCiAgICAgICAgLy8gRXh0cmFpciBuw7ptZXJvIGRhIHJ1YQ0KICAgICAgICBjb25zdCBhaXNsZU1hdGNoID0gcmVzdWx0LmFpc2xlTmFtZS5tYXRjaCgvKFxkKykvKQ0KICAgICAgICBjb25zdCBhaXNsZU51bWJlciA9IGFpc2xlTWF0Y2ggPyBhaXNsZU1hdGNoWzFdIDogIj8iDQoNCiAgICAgICAgLy8gRm9ybWFyIGVuZGVyZcOnbyBjb3JyZXRvIGJhc2VhZG8gbm8gdGlwbyBkZSBhcm1hemVuYW1lbnRvDQogICAgICAgIGxldCBmb3JtYXR0ZWRBZGRyZXNzID0gYEEke3dhcmVob3VzZU51bWJlcn1SJHthaXNsZU51bWJlcn1QJHtyZXN1bHQucG9zaXRpb259YA0KDQogICAgICAgIGlmIChyZXN1bHQuc3RvcmFnZVR5cGUgPT09ICJzaGVsZiIgJiYgcmVzdWx0LmxldmVsKSB7DQogICAgICAgICAgZm9ybWF0dGVkQWRkcmVzcyArPSBgQSR7cmVzdWx0LmxldmVsfWANCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgYWRkcmVzczogZm9ybWF0dGVkQWRkcmVzcywNCiAgICAgICAgICB3YXJlaG91c2VJZDogcmVzdWx0LndhcmVob3VzZUlkLA0KICAgICAgICAgIGFpc2xlSWQ6IHJlc3VsdC5haXNsZUlkLA0KICAgICAgICAgIHBvc2l0aW9uOiByZXN1bHQucG9zaXRpb24sDQogICAgICAgICAgbGV2ZWw6IHJlc3VsdC5sZXZlbCwNCiAgICAgICAgICBwcm9kdWN0TmFtZTogcmVzdWx0LnByb2R1Y3ROYW1lLA0KICAgICAgICAgIHN0b3JhZ2VUeXBlOiByZXN1bHQuc3RvcmFnZVR5cGUsDQogICAgICAgICAgcGFsbGV0SWQ6IHJlc3VsdC5wYWxsZXRJZCwNCiAgICAgICAgICBhaXNsZU5hbWU6IHJlc3VsdC5haXNsZU5hbWUsDQogICAgICAgICAgd2FyZWhvdXNlTmFtZTogcmVzdWx0LndhcmVob3VzZU5hbWUsDQogICAgICAgIH0NCiAgICAgIH0pDQoNCiAgICAgIGNvbnN0IHJlc3BvbnNlID0gew0KICAgICAgICBzdWNjZXNzOiB0cnVlLA0KICAgICAgICBsb2NhdGlvbnMsDQogICAgICAgIGNvdW50OiBsb2NhdGlvbnMubGVuZ3RoLA0KICAgICAgICAvLyBNYW50ZXIgY29tcGF0aWJpbGlkYWRlIGNvbSBjw7NkaWdvIGV4aXN0ZW50ZQ0KICAgICAgICBsb2NhdGlvbjogbG9jYXRpb25zWzBdLA0KICAgICAgfQ0KDQogICAgICBhd2FpdCByZWRpc0NhY2hlLnNldChjYWNoZUtleSwgcmVzcG9uc2UsIENBQ0hFX1RUTC5NRURJVU0pDQoNCiAgICAgIGNvbnNvbGUubG9nKGDimqDvuI8gRUFOIGR1cGxpY2FkbyBlbmNvbnRyYWRvIGVtICR7bG9jYXRpb25zLmxlbmd0aH0gbG9jYWxpemHDp8OjbyjDtWVzKTpgLCBsb2NhdGlvbnMpDQogICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzcG9uc2UpDQogICAgfQ0KDQogICAgLy8gRUFOIG7Do28gZW5jb250cmFkbw0KICAgIGNvbnN0IHJlc3BvbnNlID0geyBzdWNjZXNzOiB0cnVlLCBsb2NhdGlvbjogbnVsbCwgbG9jYXRpb25zOiBbXSwgY291bnQ6IDAgfQ0KDQogICAgYXdhaXQgcmVkaXNDYWNoZS5zZXQoY2FjaGVLZXksIHJlc3BvbnNlLCBDQUNIRV9UVEwuU0hPUlQpDQoNCiAgICBjb25zb2xlLmxvZygi4pyFIEVBTiBuw6NvIGR1cGxpY2FkbyIpDQogICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlKQ0KICB9IGNhdGNoIChlcnJvcikgew0KICAgIGNvbnNvbGUuZXJyb3IoIuKdjCBFcnJvIGFvIHZlcmlmaWNhciBFQU4gZHVwbGljYWRvOiIsIGVycm9yKQ0KICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogIkVycm8gaW50ZXJubyBkbyBzZXJ2aWRvciIgfSwgeyBzdGF0dXM6IDUwMCB9KQ0KICB9DQp9Cg=="}