{"data":"InVzZSBjbGllbnQiDQoNCmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gIm5leHQvbmF2aWdhdGlvbiINCmltcG9ydCB7IHVzZUNhbGxiYWNrLCB1c2VSZWYgfSBmcm9tICJyZWFjdCINCmltcG9ydCB7IHRvYXN0IH0gZnJvbSAiQC9ob29rcy91c2UtdG9hc3QiDQoNCmludGVyZmFjZSBVcGRhdGVPcHRpb25zIHsNCiAgc2hvd1RvYXN0PzogYm9vbGVhbg0KICB0b2FzdE1lc3NhZ2U/OiBzdHJpbmcNCiAgcmV2YWxpZGF0ZVBhdGhzPzogc3RyaW5nW10NCiAgb3B0aW1pc3RpY1VwZGF0ZT86ICgpID0+IHZvaWQNCiAgb25TdWNjZXNzPzogKCkgPT4gdm9pZA0KICBvbkVycm9yPzogKGVycm9yOiBFcnJvcikgPT4gdm9pZA0KfQ0KDQpleHBvcnQgZnVuY3Rpb24gdXNlSW1tZWRpYXRlVXBkYXRlKCkgew0KICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKQ0KICBjb25zdCBwZW5kaW5nVXBkYXRlcyA9IHVzZVJlZihuZXcgU2V0PHN0cmluZz4oKSkNCg0KICBjb25zdCBleGVjdXRlVXBkYXRlID0gdXNlQ2FsbGJhY2soDQogICAgYXN5bmMgKHVwZGF0ZUlkOiBzdHJpbmcsIHVwZGF0ZUZ1bmN0aW9uOiAoKSA9PiBQcm9taXNlPGFueT4sIG9wdGlvbnM6IFVwZGF0ZU9wdGlvbnMgPSB7fSkgPT4gew0KICAgICAgY29uc3QgeyBzaG93VG9hc3QgPSB0cnVlLCB0b2FzdE1lc3NhZ2UsIHJldmFsaWRhdGVQYXRocyA9IFsiLyJdLCBvcHRpbWlzdGljVXBkYXRlLCBvblN1Y2Nlc3MsIG9uRXJyb3IgfSA9IG9wdGlvbnMNCg0KICAgICAgaWYgKHBlbmRpbmdVcGRhdGVzLmN1cnJlbnQuaGFzKHVwZGF0ZUlkKSkgew0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCg0KICAgICAgcGVuZGluZ1VwZGF0ZXMuY3VycmVudC5hZGQodXBkYXRlSWQpDQoNCiAgICAgIHRyeSB7DQogICAgICAgIGlmIChvcHRpbWlzdGljVXBkYXRlKSB7DQogICAgICAgICAgb3B0aW1pc3RpY1VwZGF0ZSgpDQogICAgICAgIH0NCg0KICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cGRhdGVGdW5jdGlvbigpDQoNCiAgICAgICAgaWYgKHJlc3VsdD8uc3VjY2VzcyAhPT0gZmFsc2UpIHsNCiAgICAgICAgICBpZiAoc2hvd1RvYXN0ICYmIHRvYXN0TWVzc2FnZSkgew0KICAgICAgICAgICAgdG9hc3Qoew0KICAgICAgICAgICAgICB0aXRsZTogdG9hc3RNZXNzYWdlLA0KICAgICAgICAgICAgICB2YXJpYW50OiAiZGVmYXVsdCIsDQogICAgICAgICAgICB9KQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHJvdXRlci5yZWZyZXNoKCkNCg0KICAgICAgICAgIGlmIChvblN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIG9uU3VjY2VzcygpDQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXN1bHQ/Lm1lc3NhZ2UgfHwgIk9wZXJhw6fDo28gZmFsaG91IikNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiByZXN1bHQNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoYFtJTU1FRElBVEVfVVBEQVRFXSBFcnJvIGVtICR7dXBkYXRlSWR9OmAsIGVycm9yKQ0KDQogICAgICAgIGlmIChzaG93VG9hc3QpIHsNCiAgICAgICAgICB0b2FzdCh7DQogICAgICAgICAgICB0aXRsZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAiRXJybyBuYSBvcGVyYcOnw6NvIiwNCiAgICAgICAgICAgIHZhcmlhbnQ6ICJkZXN0cnVjdGl2ZSIsDQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChvbkVycm9yKSB7DQogICAgICAgICAgb25FcnJvcihlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoIkVycm8gZGVzY29uaGVjaWRvIikpDQogICAgICAgIH0NCg0KICAgICAgICByb3V0ZXIucmVmcmVzaCgpDQogICAgICB9IGZpbmFsbHkgew0KICAgICAgICBwZW5kaW5nVXBkYXRlcy5jdXJyZW50LmRlbGV0ZSh1cGRhdGVJZCkNCiAgICAgIH0NCiAgICB9LA0KICAgIFtyb3V0ZXJdLA0KICApDQoNCiAgY29uc3QgaXNVcGRhdGluZyA9IHVzZUNhbGxiYWNrKCh1cGRhdGVJZDogc3RyaW5nKSA9PiB7DQogICAgcmV0dXJuIHBlbmRpbmdVcGRhdGVzLmN1cnJlbnQuaGFzKHVwZGF0ZUlkKQ0KICB9LCBbXSkNCg0KICByZXR1cm4gew0KICAgIGV4ZWN1dGVVcGRhdGUsDQogICAgaXNVcGRhdGluZywNCiAgfQ0KfQo="}